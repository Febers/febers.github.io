<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ReBE</title>
  
  <subtitle>Febersçš„åšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-04-22T12:01:14.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Febers</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Dart åŸºç¡€å…¥é—¨</title>
    <link href="http://yoursite.com/Dart%20%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
    <id>http://yoursite.com/Dart åŸºç¡€å…¥é—¨/</id>
    <published>2019-04-22T06:27:18.000Z</published>
    <updated>2019-04-22T12:01:14.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>ç»ˆäºå¼€å§‹ Flutter çš„å…·ä½“å­¦ä¹ ï¼Œä¸€åˆ‡ä» Dart è¯­è¨€å¼€å§‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">void main() &#123;</span><br><span class="line">    print(&apos;hello world&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p>Dart çš„ SDK ä¸‹è½½å¯èƒ½éœ€è¦æ¢¯å­ã€‚ä½œè€…ä½¿ç”¨çš„å¼€å‘ç¯å¢ƒæ˜¯ Intellij IDEAï¼Œé¦–å…ˆä¸‹è½½ Dart çš„ Pluginï¼Œé‡å¯ IDEA ä¹‹ååˆ›å»ºä¸€ä¸ª Dart Projectï¼Œå½“ç„¶é¦–å…ˆéœ€è¦ç¡®è®¤ SDK çš„è·¯å¾„ã€‚</p><p><img src="/Dart åŸºç¡€å…¥é—¨/idea_create.png" alt=""></p><p>åˆ›å»ºä¹‹åçš„æ–‡ä»¶çª—å£å¦‚ä¸‹ï¼Œå³é”® DartDemo æ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ª dart æ–‡ä»¶ï¼Œå’Œ C/C++ ç±»ä¼¼ï¼ŒDart è¯­è¨€ä»¥æ–‡ä»¶ä¸­çš„<code>main</code>å‡½æ•°ä½œä¸ºè¿è¡Œçš„å…¥å£ã€‚åœ¨<code>run</code>ä¹‹å‰éœ€è¦<code>edit configuration</code>ï¼Œå¾ˆç®€å•ï¼Œåªè¦æŒ‡å®šå¯¹åº”çš„æ–‡ä»¶å³å¯ã€‚</p><p><img src="/Dart åŸºç¡€å…¥é—¨/idea_category.png" alt=""></p><h2 id="å£°æ˜å˜é‡"><a href="#å£°æ˜å˜é‡" class="headerlink" title="å£°æ˜å˜é‡"></a>å£°æ˜å˜é‡</h2><p>Dart æ˜¯ä¸€é—¨å®Œå…¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹ã€å‡½æ•°éƒ½æ˜¯å¯¹è±¡ï¼Œç»§æ‰¿è‡ª Objectã€‚å£°æ˜ä¸€ä¸ªå¯¹è±¡å¯ä»¥åˆå§‹åŒ–ï¼Œå¦åˆ™å…¶å€¼ä¸º<code>null</code>ã€‚å¯ä»¥ä½¿ç”¨å…·ä½“çš„ç±»å‹å£°æ˜ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>var</code>ã€<code>dynamic</code>ã€<code>const</code>ã€<code>final</code>ç­‰å…³é”®å­—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">void main() &#123;</span><br><span class="line">  var i = 0;</span><br><span class="line">  var d = 2.0;</span><br><span class="line">  var s = &apos;hello&apos;;</span><br><span class="line">  var b = true;</span><br><span class="line">  var l = [1, 2, 3];</span><br><span class="line">  var m = &#123;0: &apos;a&apos;, 1: &apos;b&apos;&#125;;</span><br><span class="line">  </span><br><span class="line">  print(main is Function);  //true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹å®˜æ–¹åº“çš„<code>core</code>åŒ…ï¼Œå¯ä»¥å¤§æ¦‚çœ‹å‡ºå…¶ç»“æ„</p><p><img src="/Dart åŸºç¡€å…¥é—¨/dart_core.png" alt="dart_core"></p><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><h3 id="Numbers"><a href="#Numbers" class="headerlink" title="Numbers"></a>Numbers</h3><p>åŒ…æ‹¬ int å’Œ doubleï¼Œåˆ†åˆ«ä»£è¡¨æ•´å½¢å’Œæµ®ç‚¹å‹ã€‚</p><p>int çš„æ•°å€¼èŒƒå›´ä¸è¶…è¿‡2çš„64ä½ï¼Œå…·ä½“ä¸å¹³å°æœ‰å…³ï¼Œä¸€èˆ¬ä¸º -2^53 to 2^53ã€‚double åˆ™å±äº64ä½çš„åŒç²¾åº¦æµ®ç‚¹å‹æ•°æ®ã€‚</p><h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>åœ¨ Dart ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ï¼Œæˆ–è€…ä½¿ç”¨ä¸‰å¼•å·å®šä¹‰æ ¼å¼å­—ç¬¦ä¸²ã€‚Dart çš„å­—ç¬¦ä¸²ä½¿ç”¨ UTF-16 ç¼–ç </p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="string">"hello"</span>;</span><br><span class="line"><span class="keyword">var</span> s2 = <span class="string">'world'</span>;</span><br><span class="line"><span class="keyword">var</span> s3 = <span class="string">'hello'</span> + <span class="string">'world'</span>;</span><br><span class="line"><span class="keyword">var</span> s4 = <span class="string">'hello'</span> <span class="string">'world'</span>;</span><br><span class="line"><span class="keyword">var</span> s5 = <span class="string">"""hello </span></span><br><span class="line"><span class="string">              world"""</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦ä½¿ç”¨ UTF-32 ç¼–ç ï¼Œåˆ™è¦é€šè¿‡ Runesï¼ˆç¬¦å·æ–‡å­—ï¼‰ï¼Œå®ƒå¯ä»¥æŠŠæ–‡å­—è½¬æ¢æˆç¬¦å·è¡¨æƒ…æˆ–è€…ç‰¹å®šæ–‡å­—ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> clapping = <span class="string">'\u&#123;1f44f&#125;'</span>;</span><br><span class="line"><span class="built_in">print</span>(clapping);</span><br><span class="line"></span><br><span class="line">Runes runes = <span class="keyword">new</span> Runes(<span class="string">'\u&#123;1f44d&#125;'</span>);</span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">new</span> <span class="built_in">String</span>.fromCharCode(runes.first));</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„è¾“å‡ºä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ğŸ‘</span><br><span class="line">ğŸ‘</span><br></pre></td></tr></table></figure><h3 id="Boolean"><a href="#Boolean" class="headerlink" title="Boolean"></a>Boolean</h3><p>æä¾› bool ç”¨æ¥å£°æ˜å¸ƒå°”å‹å˜é‡ï¼Œé»˜è®¤ä¸º falseã€‚</p><h3 id="List-å’Œ-Map"><a href="#List-å’Œ-Map" class="headerlink" title="List å’Œ Map"></a>List å’Œ Map</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">int</span>&gt; l = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">l.forEach((x) =&gt; <span class="built_in">print</span>(x)); <span class="comment">//forEachçš„å‚æ•°ä¸º Function</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> x <span class="keyword">in</span> l) &#123; <span class="comment">//ä½¿ç”¨for-in</span></span><br><span class="line">  <span class="built_in">print</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">int</span>, <span class="built_in">String</span>&gt; map = &#123;<span class="number">0</span>: <span class="string">"a"</span>, <span class="number">1</span>: <span class="string">"b"</span>&#125;;</span><br><span class="line">map[<span class="number">0</span>] = <span class="string">"c"</span>;</span><br></pre></td></tr></table></figure><h2 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h2><h3 id="æ™®é€šFunction"><a href="#æ™®é€šFunction" class="headerlink" title="æ™®é€šFunction"></a>æ™®é€šFunction</h3><p>å‡½æ•°æˆ–è€…æ–¹æ³•ã€‚å’ŒJava ä¸åŒï¼ŒDart ä¸­æ–¹æ³•æ˜¯æœ‰ç±»å‹çš„ï¼Œå±äº Functionã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  single1(<span class="string">'Tom'</span>, <span class="number">20</span>);</span><br><span class="line">  single2(<span class="string">'Tom'</span>, <span class="number">20</span>);</span><br><span class="line">  single3(<span class="string">'Tom'</span>, <span class="number">20</span>, weight: <span class="number">30</span>); <span class="comment">//ç”±äºæ²¡æœ‰ä½ç½®çº¦æŸï¼Œå¿…é¡»æŒ‡å®šå½¢å‚åç§°</span></span><br><span class="line">  single4(<span class="string">'Tom'</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> single1(<span class="built_in">String</span> name, <span class="built_in">int</span> age) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿”å›ç±»å‹å’Œå‚æ•°ç±»å‹å¯çœç•¥ï¼Œæ”¯æŒè¿”å›è¡¨è¾¾å¼</span></span><br><span class="line">single2(name, age) =&gt; <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯é€‰å‘½åå‚æ•°ï¼Œè°ƒç”¨æ—¶æ²¡æœ‰é¡ºåºè¦æ±‚ï¼ŒåŒæ—¶å¯é€‰å‚æ•°å¯ä»¥æŒ‡å®šé»˜è®¤å€¼</span></span><br><span class="line"><span class="built_in">bool</span> single3(<span class="built_in">String</span> name, <span class="built_in">int</span> age, &#123;<span class="built_in">int</span> weight = <span class="number">60</span>, <span class="built_in">int</span> height&#125;) =&gt; <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯é€‰ä½ç½®å‚æ•°ï¼Œé€šè¿‡ä½ç½®æ¥ç¡®å®šå‚æ•°å€¼ï¼Œè¦æƒ³æŒ‡å®š height å¿…é¡»å…ˆæŒ‡å®š weight</span></span><br><span class="line"><span class="built_in">bool</span> single4(<span class="built_in">String</span> name, <span class="built_in">int</span> age, [<span class="built_in">int</span> weight, <span class="built_in">int</span> height]) =&gt; <span class="keyword">true</span>;</span><br></pre></td></tr></table></figure><p>å¯¹äº<code>main</code>æ–¹æ³•æ¥è¯´ï¼Œå¯ä»¥å®šä¹‰å…¶ä¸ºä¸€ä¸ªæœ‰å‚çš„æ–¹æ³•ï¼ŒåŒæ ·å¯ä»¥ä½œä¸ºå…¥å£æ–¹æ³•ã€‚åœ¨ Flutter é¡¹ç›®ä¸­çš„å…¥å£æ–¹æ³•ä¸ºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() =&gt; runApp(MyApp());</span><br></pre></td></tr></table></figure><h3 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h3><p>åœ¨ Lambda è¡¨è¾¾å¼ä¸­ï¼Œå‡½æ•°å¯ä»¥â€œæ²¡æœ‰åå­—â€ï¼ŒåŒæ ·ï¼Œä¹Ÿå¯ä»¥åƒ kotlin ä¸€æ ·ï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°å˜é‡</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = (c) &#123;</span><br><span class="line">  <span class="built_in">print</span>(c);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">f(<span class="string">'hello'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">printElement(x) &#123;<span class="comment">//æ–¹æ³•ç­¾åå†™æˆ void printElement(int x) æ›´ç›´è§‚</span></span><br><span class="line">  <span class="built_in">print</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">list.forEach(printElement);</span><br></pre></td></tr></table></figure><p><code>forEach</code>çš„å‡½æ•°å®šä¹‰å¦‚ä¸‹</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> forEach(<span class="keyword">void</span> f(E element)) &#123;</span><br><span class="line">  <span class="keyword">for</span> (E element <span class="keyword">in</span> <span class="keyword">this</span>) f(element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ä¾‹å­ç›´è§‚å±•ç¤ºå°†å‡½æ•°ä½œä¸ºå˜é‡ä¼ é€’çš„æ€æƒ³</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span> makeAdder(<span class="built_in">num</span> n) &#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">num</span> i) =&gt; n + i;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//æ›´æ˜æ™°çš„å†™æ³•</span></span><br><span class="line"><span class="built_in">Function</span> makeAdder_(<span class="built_in">num</span> n) &#123;</span><br><span class="line">  <span class="built_in">Function</span> add = (<span class="built_in">num</span> i) &#123;</span><br><span class="line">    <span class="keyword">return</span> i + n;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> add;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> adder2 = makeAdder(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">print</span>(adder2(<span class="number">3</span>));</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å°å°†è¾“å‡º 5</p><h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h2><h3 id="èµ‹å€¼æ“ä½œç¬¦"><a href="#èµ‹å€¼æ“ä½œç¬¦" class="headerlink" title="èµ‹å€¼æ“ä½œç¬¦"></a>èµ‹å€¼æ“ä½œç¬¦</h3><p>é™¤äº†<code>=</code>ï¼Œè¿˜æœ‰<code>??=</code>ï¼Œè¡¨ç¤ºå¦‚æœå·¦è¾¹çš„å˜é‡ä¸º nullï¼Œåˆ™å°†å³è¾¹çš„å€¼èµ‹äºˆå®ƒï¼Œå¦åˆ™å·¦è¾¹å€¼ä¸å˜ã€‚</p><h3 id="ç›¸ç­‰"><a href="#ç›¸ç­‰" class="headerlink" title="ç›¸ç­‰"></a>ç›¸ç­‰</h3><p><code>==</code>å°†æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯å¦ç›¸ç­‰ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€å¯¹è±¡ä½¿ç”¨çš„æ˜¯é¢„å®šä¹‰çš„<code>identical</code>æ–¹æ³•</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">external</span> <span class="built_in">bool</span> identical(<span class="built_in">Object</span> a, <span class="built_in">Object</span> b);</span><br></pre></td></tr></table></figure><h3 id="é™¤æ³•"><a href="#é™¤æ³•" class="headerlink" title="é™¤æ³•"></a>é™¤æ³•</h3><table><thead><tr><th style="text-align:center">æ“ä½œç¬¦</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">/</td><td>é™¤ï¼Œæ¯”å¦‚ 5/2 = 2.5</td></tr><tr><td style="text-align:center">~/</td><td>æ•´é™¤ï¼Œ 5/2 = 2</td></tr></tbody></table><h3 id="ç±»å‹åˆ¤æ–­"><a href="#ç±»å‹åˆ¤æ–­" class="headerlink" title="ç±»å‹åˆ¤æ–­"></a>ç±»å‹åˆ¤æ–­</h3><table><thead><tr><th style="text-align:center">æ“ä½œç¬¦</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">is</td><td>å¯¹è±¡å±äºæŒ‡å®šç±»å‹åˆ™è¿”å›true</td></tr><tr><td style="text-align:center">is!</td><td>å¯¹è±¡ä¸å±äºæŒ‡å®šç±»å‹è¿”å›true</td></tr><tr><td style="text-align:center">as</td><td>ç±»å‹è½¬æ¢</td></tr></tbody></table><h3 id="æ¡ä»¶è¡¨è¾¾å¼"><a href="#æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="æ¡ä»¶è¡¨è¾¾å¼"></a>æ¡ä»¶è¡¨è¾¾å¼</h3><p>åˆ†ä¸ºä¸¤ç§</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">condition ? expr1 : expr2<span class="comment">//é€šç”¨è¡¨è¾¾å¼</span></span><br><span class="line">expr1 ?? expr2<span class="comment">//å¦‚æœ expr1 éç©ºï¼Œè¿”å›å…¶å€¼ï¼Œå¦åˆ™è¿”å› expr2</span></span><br></pre></td></tr></table></figure><h3 id="çº§è”è°ƒç”¨ä¸éç©ºè°ƒç”¨"><a href="#çº§è”è°ƒç”¨ä¸éç©ºè°ƒç”¨" class="headerlink" title="çº§è”è°ƒç”¨ä¸éç©ºè°ƒç”¨"></a>çº§è”è°ƒç”¨ä¸éç©ºè°ƒç”¨</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¸¸è§„å†™æ³•</span></span><br><span class="line"><span class="keyword">var</span> button = <span class="built_in">querySelector</span>(<span class="string">'#button'</span>);</span><br><span class="line">button.text = <span class="string">'Confirm'</span>;</span><br><span class="line">button.classes.add(<span class="string">'important'</span>);</span><br><span class="line">button.onClick.listen((e) =&gt; <span class="built_in">window</span>.alert(<span class="string">'Confirmed!'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨çº§è”è¡¨è¾¾å¼</span></span><br><span class="line"><span class="built_in">querySelector</span>(<span class="string">'#button'</span>) <span class="comment">// Get an object.</span></span><br><span class="line">  ..text = <span class="string">'Confirm'</span>   <span class="comment">// Use its members.</span></span><br><span class="line">  ..classes.add(<span class="string">'important'</span>)</span><br><span class="line">  ..onClick.listen((e) =&gt; <span class="built_in">window</span>.alert(<span class="string">'Confirmed!'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç©ºè°ƒç”¨</span></span><br><span class="line"><span class="built_in">print</span>(button?.text);</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>Dart è¯­è¨€åœ¨æ¯”å¦‚ <code>if/else</code>ã€<code>[doã€]while</code>ã€<code>for</code>ã€<code>switch/case</code>ç­‰è¯­å¥ä¸Šè·Ÿ Java ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚</p><p>å¼‚å¸¸å¤„ç†çš„åšæ³•å¦‚ä¸‹</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="keyword">throw</span> <span class="string">'x should be less than 10'</span>;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> FormatException(<span class="string">'Expected at least 1 section'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•è·å¼‚å¸¸</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; on OutOfLlamasException &#123;</span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> <span class="comment">//...</span></span><br><span class="line">&#125; on Exception <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'Unknown exception: <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125; catch (e, s) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Exception details:\n <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Stack trace:\n <span class="subst">$s<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;ç»ˆäºå¼€å§‹ Flutter çš„å…·ä½“å­¦ä¹ ï¼Œä¸€åˆ‡ä» Dart è¯­è¨€å¼€å§‹ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;void main() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(&amp;apos;hello world&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Dart" scheme="http://yoursite.com/categories/Dart/"/>
    
    
      <category term="Dart" scheme="http://yoursite.com/tags/Dart/"/>
    
  </entry>
  
  <entry>
    <title>Android Binder æºç è§£æ</title>
    <link href="http://yoursite.com/Android-Binder-%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <id>http://yoursite.com/Android-Binder-æºç è§£æ/</id>
    <published>2019-03-23T04:18:53.000Z</published>
    <updated>2019-03-23T04:18:54.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Java çº¿ç¨‹å’Œçº¿ç¨‹æ± è¯¦è§£</title>
    <link href="http://yoursite.com/Java-%E7%BA%BF%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%AF%A6%E8%A7%A3/"/>
    <id>http://yoursite.com/Java-çº¿ç¨‹å’Œçº¿ç¨‹æ± è¯¦è§£/</id>
    <published>2019-03-20T09:29:06.000Z</published>
    <updated>2019-03-21T10:02:08.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>çº¿ç¨‹åœ¨ Java å¼€å‘ä¸­æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µã€‚ åœ¨Javaä¸­ï¼Œâ€œçº¿ç¨‹â€æŒ‡ä¸¤ä»¶ä¸åŒçš„äº‹æƒ…ï¼š</p><blockquote><p>java.lang.Thread ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼›</p><p>çº¿ç¨‹çš„æ‰§è¡Œã€‚</p></blockquote><a id="more"></a><h2 id="Java-çº¿ç¨‹"><a href="#Java-çº¿ç¨‹" class="headerlink" title="Java çº¿ç¨‹"></a>Java çº¿ç¨‹</h2><h3 id="çº¿ç¨‹å’Œè¿›ç¨‹"><a href="#çº¿ç¨‹å’Œè¿›ç¨‹" class="headerlink" title="çº¿ç¨‹å’Œè¿›ç¨‹"></a>çº¿ç¨‹å’Œè¿›ç¨‹</h3><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>è¿›ç¨‹æ˜¯æŒ‡ä¸€ä¸ªå†…å­˜ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ä¸€å—å†…å­˜ç©ºé—´ï¼Œå³è¿›ç¨‹ç©ºé—´ï¼ˆè™šç©ºé—´ï¼‰ã€‚è¿›ç¨‹ä¸ä¾èµ–äºçº¿ç¨‹è€Œç‹¬ç«‹å­˜åœ¨ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥å¯åŠ¨å¤šä¸ªçº¿ç¨‹ã€‚ç³»ç»Ÿè¿è¡Œä¸€ä¸ªç¨‹åºå³æ˜¯ä¸€ä¸ªè¿›ç¨‹ä»åˆ›å»ºã€è¿è¡Œåˆ°æ¶ˆäº¡çš„è¿‡ç¨‹ã€‚</p><p>çº¿ç¨‹æ˜¯æŒ‡è¿›ç¨‹ä¸­çš„ä¸€ä¸ªæ‰§è¡Œæµç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥è¿è¡Œå¤šä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹æ€»æ˜¯å±äºæŸä¸ªè¿›ç¨‹ï¼Œçº¿ç¨‹æ²¡æœ‰è‡ªå·±çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä¸è¿›ç¨‹å†…çš„å…¶ä»–çº¿ç¨‹ä¸€èµ·å…±äº«åˆ†é…ç»™è¯¥è¿›ç¨‹çš„æ‰€æœ‰èµ„æºã€‚ï¼Œçº¿ç¨‹æ˜¯ CPU æ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œæ˜¯èŠ±è´¹æœ€å°å¼€é”€çš„å®ä½“ã€‚</p><h4 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h4><p>è¿›ç¨‹æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œè¿›ç¨‹ä¸­çš„æ•°æ®å­˜æ”¾ç©ºé—´ï¼ˆå †ç©ºé—´å’Œæ ˆç©ºé—´ï¼‰æ˜¯ç‹¬ç«‹çš„ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚</p><p>çº¿ç¨‹ä¸­å †ç©ºé—´æ˜¯å…±äº«çš„ï¼Œæ ˆç©ºé—´æ˜¯ç‹¬ç«‹çš„ï¼Œçº¿ç¨‹æ¶ˆè€—çš„èµ„æºæ¯”è¿›ç¨‹å°çš„å¤šã€‚</p><blockquote><p>ä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹æ˜¯å¹¶å‘è¿è¡Œçš„ï¼Œä»å¾®è§‚è§’åº¦çœ‹å­˜åœ¨å…ˆåé¡ºåºï¼Œå“ªä¸ªçº¿ç¨‹è¢«æ‰§è¡Œå®Œå…¨å–å†³äº CPU çš„è°ƒåº¦ï¼Œç¨‹åºå‘˜æ— æ³•å¹²æ¶‰ã€‚è¿™ä¹Ÿå°±é€ æˆäº†å¤šçº¿ç¨‹çš„éšæœºæ€§ã€‚</p><p>Java ç¨‹åºçš„è¿›ç¨‹é‡Œé¢è‡³å°‘åŒ…å«ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ä¹Ÿå°±æ˜¯ main() æ–¹æ³•çº¿ç¨‹ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯åƒåœ¾å›æ”¶æœºåˆ¶çº¿ç¨‹ã€‚æ¯å½“ä½¿ç”¨ java å‘½ä»¤æ‰§è¡Œä¸€ä¸ªç±»æ—¶ï¼Œå®é™…ä¸Šéƒ½ä¼šå¯åŠ¨ä¸€ä¸ª JVMï¼Œå¯¹åº”ä¸€ä¸ªè¿›ç¨‹ã€‚</p><p>ç”±äºåˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„å¼€é”€æ¯”åˆ›å»ºä¸€ä¸ªè¿›ç¨‹çš„å¼€é”€å°çš„å¤šï¼Œåœ¨å¼€å‘å¤šä»»åŠ¡è¿è¡Œçš„æ—¶å€™ï¼Œé€šå¸¸è€ƒè™‘åˆ›å»ºå¤šçº¿ç¨‹ï¼Œè€Œä¸æ˜¯åˆ›å»ºå¤šè¿›ç¨‹ã€‚</p></blockquote><p>å®é™…å¼€å‘ä¸­ä½¿ç”¨å¤šçº¿ç¨‹çš„ä¼˜åŠ¿åœ¨äº</p><ul><li>è¿›ç¨‹ä¹‹é—´ä¸èƒ½å…±äº«å†…å­˜ï¼Œè€Œçº¿ç¨‹ä¹‹é—´å¯ä»¥å…±äº«å†…å­˜ã€‚</li><li>ç³»ç»Ÿåˆ›å»ºè¿›ç¨‹éœ€è¦ä¸ºè¯¥è¿›ç¨‹é‡æ–°åˆ†é…ç³»ç»Ÿèµ„æºï¼Œåˆ›å»ºçº¿ç¨‹çš„ä»£ä»·åˆ™å°çš„å¤šï¼Œå› æ­¤å¤šä»»åŠ¡å¹¶å‘æ—¶ï¼Œå¤šçº¿ç¨‹æ•ˆç‡é«˜ã€‚</li><li>Java è¯­è¨€æœ¬èº«å†…ç½®å¤šçº¿ç¨‹åŠŸèƒ½çš„æ”¯æŒï¼Œè€Œä¸æ˜¯å•çº¯ä½œä¸ºåº•å±‚ç³»ç»Ÿçš„è°ƒåº¦æ–¹å¼ï¼Œä»è€Œç®€åŒ–äº†å¤šçº¿ç¨‹ç¼–ç¨‹ã€‚</li></ul><h3 id="çº¿ç¨‹çš„çŠ¶æ€"><a href="#çº¿ç¨‹çš„çŠ¶æ€" class="headerlink" title="çº¿ç¨‹çš„çŠ¶æ€"></a>çº¿ç¨‹çš„çŠ¶æ€</h3><p>å›¾ä¸€</p><p><img src="/Java-çº¿ç¨‹å’Œçº¿ç¨‹æ± è¯¦è§£/çº¿ç¨‹çŠ¶æ€1.png" alt=""></p><p>å›¾äºŒ</p><p><img src="/Java-çº¿ç¨‹å’Œçº¿ç¨‹æ± è¯¦è§£/çº¿ç¨‹çŠ¶æ€2.png" alt=""></p><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><p>Java ä¸­çš„çº¿ç¨‹å¯ä»¥åˆ†ä¸ºç”¨æˆ·çº¿ç¨‹ï¼ˆUser Threadï¼‰å’Œå®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰ã€‚</p><p>åªè¦å½“å‰ JVM å®ä¾‹ä¸­å­˜åœ¨ä»»ä½•ä¸€ä¸ªéå®ˆæŠ¤çº¿ç¨‹æ²¡æœ‰ç»“æŸï¼Œå®ˆæŠ¤çº¿ç¨‹å°±å…¨éƒ¨å·¥ä½œï¼›å½“æœ€åä¸€ä¸ªéå®ˆæŠ¤çº¿ç¨‹ç»“æŸï¼Œå³è™šæ‹Ÿæœºä¸­åªå­˜åœ¨å®ˆæŠ¤çº¿ç¨‹æ—¶ï¼ŒJVM å°±ä¼šåœæ­¢è¿è¡Œã€‚Daemon Thread çš„ä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹æä¾›å„ç§æœåŠ¡ï¼Œæœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯åƒåœ¾æ”¶é›†å™¨ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread();</span><br><span class="line">        thread.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">        System.out.println(<span class="string">"is daemon thread? "</span> + thread.isDaemon());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">is daemon thread? true</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹è¦æ³¨æ„çš„ç‚¹</p><ul><li><code>thread.setDaemon(true)</code> å¿…é¡»åœ¨ <code>thread.start()</code> ä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ª IllegalThreadStateException å¼‚å¸¸ã€‚å› ä¸ºä¸èƒ½æŠŠæ­£åœ¨è¿è¡Œçš„å¸¸è§„çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</li><li>åœ¨ Daemon Thread ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿå±äº Daemon Threadã€‚ </li><li>ä¸è¦åœ¨ Daemon Thread ä¸­åˆ†é…è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ä»»åŠ¡ã€‚ </li></ul><h3 id="Runnable-å’Œ-Thread"><a href="#Runnable-å’Œ-Thread" class="headerlink" title="Runnable å’Œ Thread"></a>Runnable å’Œ Thread</h3><p>Runnable æ˜¯ä¸€ä¸ªçº¿ç¨‹æ¥å£ï¼ŒæŸ¥çœ‹å…¶æ„é€ <br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­åªå®šä¹‰äº†ä¸€ä¸ª<code>run</code>æ–¹æ³•</p><p>Thread æ˜¯å®ç°äº† Runnable æ¥å£çš„ç±»ï¼Œæ‰€æœ‰æ–°å»º Thread å®ä¾‹çš„æ–¹æ³•æœ€åéƒ½ä¼šè°ƒç”¨åˆ°å†…éƒ¨çš„<code>init</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private void init(ThreadGroup g, Runnable target, String name,</span><br><span class="line">                      long stackSize, AccessControlContext acc,</span><br><span class="line">                      boolean inheritThreadLocals)</span><br></pre></td></tr></table></figure></p><p>è§‚å¯Ÿ Thread ä¸­é‡å†™çš„<code>run</code>æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (target != <span class="keyword">null</span>) &#123;</span><br><span class="line">        target.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­ target ä¸º Runnable å¯¹è±¡ï¼Œå³è°ƒç”¨ Thread çš„<code>run</code>å®é™…ä¸Šæ˜¯è°ƒç”¨æˆ‘ä»¬ä¼ è¿›å»çš„ Runnable çš„å¯¹åº”æ–¹æ³•</p><p>è§‚å¯Ÿå…¶<code>start</code>æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ä¸èƒ½é‡å¤è°ƒç”¨ start æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span> (threadStatus != <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalThreadStateException();</span><br><span class="line">        </span><br><span class="line">    <span class="comment">//å°†çº¿ç¨‹åŠ å…¥çº¿ç¨‹ç»„</span></span><br><span class="line">    group.add(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//çº¿ç¨‹å¼€å§‹æ ‡å¿—</span></span><br><span class="line">    <span class="keyword">boolean</span> started = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//è°ƒç”¨nativeæ–¹æ³•å¼€å§‹å¤šçº¿ç¨‹</span></span><br><span class="line">        start0();</span><br><span class="line">        started = <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!started) &#123;</span><br><span class="line">                group.threadStartFailed(<span class="keyword">this</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable ignore) &#123;</span><br><span class="line">            <span class="comment">/* do nothing. If start0 threw a Throwable then</span></span><br><span class="line"><span class="comment">              it will be passed up the call stack */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­<code>start0</code>æ˜¯ native æ–¹æ³•ï¼Œåœ¨å…¶ä¸­æ–°å»ºçº¿ç¨‹ï¼Œç„¶åå›è°ƒ target çš„ run æ–¹æ³•ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥è°ƒç”¨<code>run</code>æ–¹æ³•ï¼Œç›¸å½“äºè°ƒç”¨æ™®é€šæ–¹æ³•ï¼Œä¸ä¼šæœ‰å¤šçº¿ç¨‹æ•ˆæœã€‚åªæœ‰è°ƒç”¨<code>start</code>æ‰ä¼šåœ¨åå°å¼€å¯å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œç­‰å¾… CPU è°ƒåº¦ã€‚</p><h3 id="å¤šçº¿ç¨‹-API"><a href="#å¤šçº¿ç¨‹-API" class="headerlink" title="å¤šçº¿ç¨‹ API"></a>å¤šçº¿ç¨‹ API</h3><h4 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h4><p>å®é™…ä¸Šé™¤äº† Threadï¼ŒJava çš„åŸºç±» Object ä¸­ä¹Ÿå®šä¹‰äº†ä¸€äº›å…³äºå¤šçº¿ç¨‹æ“ä½œçš„æ–¹æ³•</p><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>wait()</td><td>é”å¯¹è±¡è°ƒç”¨è¯¥æ–¹æ³•ä½¿å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œå¹¶ç«‹åˆ»é‡Šæ”¾é”å¯¹è±¡ï¼Œç›´åˆ°è¢«å…¶ä»–çº¿ç¨‹å”¤é†’è¿›å…¥ç­‰é”æ± </td></tr><tr><td>wait(long)</td><td>é”å¯¹è±¡è°ƒç”¨è¯¥æ–¹æ³•ä½¿å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ŒåŒæ—¶é‡Šæ”¾é”å¯¹è±¡ã€‚ä½†æ˜¯è¶…è¿‡ç­‰å¾…çš„æ—¶é—´åçº¿ç¨‹ä¼šè‡ªåŠ¨å”¤é†’ï¼Œæˆ–è€…è¢«å…¶ä»–çº¿ç¨‹å”¤é†’ï¼Œå¹¶è¿›å…¥ç­‰é”æ± ä¸­ã€‚</td></tr><tr><td>wait(long, int)</td><td>å’Œo.wait(long)æ–¹æ³•ä¸€æ ·ï¼Œå¦‚æœintå‚æ•°å¤§äº0åˆ™å‰é¢çš„longæ•°å­—åŠ 1000</td></tr><tr><td>notify()</td><td>éšæœºå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…ä¸­çš„çº¿ç¨‹ï¼ˆåŒä¸€ä¸ªç­‰å¾…é˜»å¡æ± ä¸­ï¼‰</td></tr><tr><td>notifyAll()</td><td>å”¤é†’æ‰€æœ‰ç­‰å¾…ä¸­çš„çº¿ç¨‹ï¼ˆåŒä¸€ä¸ªç­‰å¾…é˜»å¡æ± ä¸­ï¼‰</td></tr></tbody></table><p>ä»¥ä¸Šçš„æ–¹æ³•å¿…é¡»å†™åœ¨ synchronized æ–¹æ³•å†…éƒ¨æˆ–è€… synchronized å—å†…éƒ¨ï¼Œå› ä¸ºå®ƒä»¬è¦æ±‚å½“å‰æ­£åœ¨è¿è¡Œ<code>object.wait()</code>æ–¹æ³•çš„çº¿ç¨‹æ‹¥æœ‰ object çš„å¯¹è±¡é”ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Thread t = Thread.currentThread();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            t.wait(<span class="number">2000</span>);   <span class="comment">//ç”±äºæ²¡æœ‰è·å¾—é”ï¼Œå°†æŠ›å‡º IllegalMonitorStateException å¼‚å¸¸</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"current Thread info in Main: "</span> + t.toString());</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        a.printThreadInfo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">printThreadInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Thread t = Thread.currentThread();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wait(<span class="number">2000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"current Thread info in A: "</span> + t.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åˆ é™¤<code>main</code>ä¸­ try/catch è¯­å¥ä¹‹åï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">current Thread info in Main: Thread[main,5,main]</span><br><span class="line">//ç­‰å¾…ä¸¤ç§’</span><br><span class="line">current Thread info in A: Thread[main,5,main]</span><br></pre></td></tr></table></figure></p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦åœ¨ synchronized ä¸­ï¼Ÿ</strong></p><blockquote><p>waitå’Œnotifyç”¨äºçº¿ç¨‹é—´é€šä¿¡ã€‚<br>ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ä¸¾ä¾‹ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é€šè¿‡é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ï¼Œå¯¹äºé˜Ÿåˆ—çš„æ“ä½œè¦ä¿è¯çº¿ç¨‹å®‰å…¨æ€§</p><p>ä¸€èˆ¬å¯¹é˜Ÿåˆ—çš„æ“ä½œå¦‚ä¸‹:<br>while(queue.size() == MAX_SIZE){ wait() }</p><p>å‡å¦‚ä¸å¯¹è¿™æ®µä»£ç åŠ é”ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚æ¨¡æ‹Ÿä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹t1å’Œä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹t2</p><ul><li><p>t1åˆ¤æ–­é˜Ÿåˆ—æ»¡ï¼Œéœ€è¦ wait é˜»å¡çº¿ç¨‹ã€‚</p></li><li><p>ä½†æ˜¯å°±åœ¨t1è¿˜æ²¡æœ‰è°ƒç”¨ wait çš„æ—¶å€™ï¼Œæ¶ˆè´¹è€…t2æ¶ˆè´¹äº†ä¸€ä¸ªäº§å“ï¼Œå¯¼è‡´é˜Ÿåˆ—éæ»¡ã€‚</p></li><li><p>è¿™æ—¶å€™ç”Ÿäº§è€…çº¿ç¨‹t1è°ƒç”¨ wait é˜»å¡ï¼Œé€ æˆçš„æƒ…å†µå°±æ˜¯é˜Ÿåˆ—éæ»¡ï¼Œä½†æ˜¯ç”Ÿäº§è€…çº¿ç¨‹é˜»å¡äº†ã€‚</p></li><li><p>å‡å¦‚æ­¤æ—¶æ¶ˆè´¹è€…ä¸æ¶ˆè´¹äº†ï¼Œé‚£ä¹ˆç”Ÿäº§è€…åˆ™ä¼šä¸€ç›´é˜»å¡ä¸‹å»ã€‚</p></li><li><p>æ‰€ä»¥åœ¨è°ƒç”¨ waitã€notify ä»¥åŠ notifyAll ç­‰æ–¹æ³•æ—¶ä¸€å®šè¦è¿›è¡ŒåŒæ­¥å¤„ç†ã€‚</p></li></ul></blockquote><p><strong>ä¸ºä»€ä¹ˆå®šä¹‰åœ¨ Object ä¸­ï¼Ÿ</strong></p><blockquote><p>Object ä¸­çš„<code>wait()</code>, <code>notify()</code>ç­‰æ–¹æ³•ï¼Œå’Œ synchronized ä¸€æ ·ï¼Œä¼šå¯¹â€œå¯¹è±¡çš„åŒæ­¥é”â€è¿›è¡Œæ“ä½œã€‚</p><p><code>wait()</code>ä¼šä½¿â€œå½“å‰çº¿ç¨‹â€ç­‰å¾…ã€‚è¿›å…¥ç­‰å¾…çŠ¶æ€æ—¶ï¼Œçº¿ç¨‹åº”è¯¥é‡Šæ”¾å®ƒé”æŒæœ‰çš„â€œåŒæ­¥é”â€ï¼Œå¦åˆ™å…¶å®ƒçº¿ç¨‹è·å–ä¸åˆ°è¯¥â€œåŒæ­¥é”â€å°†æ— æ³•è¿è¡Œï¼<br>å½“çº¿ç¨‹é‡Šæ”¾å®ƒæŒæœ‰çš„â€œåŒæ­¥é”â€ä¹‹åå˜æˆç­‰å¾…çº¿ç¨‹ï¼Œå¯ä»¥è¢«<code>notify()</code>æˆ–<code>notifyAll()</code>å”¤é†’ã€‚é‚£ä¹ˆï¼Œ<code>notify()</code>ä¾æ®ä»€ä¹ˆå”¤é†’ç­‰å¾…çº¿ç¨‹çš„ï¼Ÿæˆ–è€…è¯´ï¼Œ<code>wait()</code>ç­‰å¾…çº¿ç¨‹å’Œ<code>notify()</code>ä¹‹é—´é€šè¿‡ä»€ä¹ˆå…³è”èµ·æ¥ï¼Ÿç­”æ¡ˆæ˜¯ï¼šä¾æ®â€œå¯¹è±¡çš„åŒæ­¥é”â€ã€‚</p><p>è´Ÿè´£å”¤é†’ç­‰å¾…çº¿ç¨‹çš„é‚£ä¸ªçº¿ç¨‹(â€œå”¤é†’çº¿ç¨‹â€)ï¼Œåªæœ‰åœ¨è·å–â€œè¯¥å¯¹è±¡çš„åŒæ­¥é”â€(è¿™é‡Œçš„åŒæ­¥é”å¿…é¡»å’Œç­‰å¾…çº¿ç¨‹çš„åŒæ­¥é”æ˜¯åŒä¸€ä¸ª)ï¼Œå¹¶ä¸”è°ƒç”¨<code>notify()</code>æˆ–<code>notifyAll()</code>æ–¹æ³•ä¹‹åï¼Œæ‰èƒ½å”¤é†’ç­‰å¾…çº¿ç¨‹ã€‚æ­¤æ—¶å› ä¸ºå”¤é†’çº¿ç¨‹è¿˜æŒæœ‰â€œè¯¥å¯¹è±¡çš„åŒæ­¥é”â€ï¼Œæ‰€ä»¥å¿…é¡»ç­‰åˆ°å”¤é†’çº¿ç¨‹é‡Šæ”¾äº†â€œå¯¹è±¡çš„åŒæ­¥é”â€ä¹‹åï¼Œç­‰å¾…çº¿ç¨‹æ‰èƒ½è·å–åˆ°â€œå¯¹è±¡çš„åŒæ­¥é”â€è¿›è€Œç»§ç»­è¿è¡Œã€‚</p><p>æ€»ä¹‹ï¼Œ<code>notify()</code>, <code>wait()</code>ä¾èµ–äºâ€œåŒæ­¥é”â€ï¼Œè€Œâ€œåŒæ­¥é”â€æ˜¯å¯¹è±¡é”æŒæœ‰ï¼Œå¹¶ä¸”æ¯ä¸ªå¯¹è±¡æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªï¼</p><p>è¿™å°±æ˜¯<code>notify()</code>, <code>wait()</code>ç­‰å‡½æ•°å®šä¹‰åœ¨ Object ç±»ï¼Œè€Œä¸æ˜¯ Thread ç±»ä¸­çš„åŸå› ã€‚</p><p>æ¥è‡ª <a href="https://www.cnblogs.com/happy-coder/p/6587092.html" target="_blank" rel="noopener">JAVA çº¿ç¨‹çŠ¶æ€åŠè½¬åŒ–</a></p></blockquote><h4 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h4><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>Thread.currentThread()</td><td>è¿”å›å¯¹å½“å‰çº¿ç¨‹å¯¹è±¡çš„å¼•ç”¨</td></tr><tr><td>Thread.interrupted()</td><td>æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»ä¸­æ–­ï¼ˆè°ƒç”¨è¯¥æ–¹æ³•åå°†è¯¥çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½è®¾ä¸ºfalseï¼Œè¿ç»­ä¸¤æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ç¬¬äºŒæ¬¡è‚¯å®šä¸ºfalseï¼‰</td></tr><tr><td>Thread.sleep(long millis)</td><td>ä½¿å½“å‰çº¿ç¨‹ç¡çœ ï¼ˆä¸ä¼šé‡Šæ”¾é”å¯¹è±¡ï¼Œå¯ä»¥è®©å…¶ä»–çº¿ç¨‹æœ‰æ‰§è¡Œçš„æœºä¼šï¼‰</td></tr><tr><td>Thread.yield()</td><td>ä½¿å½“å‰çº¿ç¨‹æ”¾å¼ƒcpuçš„æ‰§è¡Œæƒï¼ˆæœ‰å¯èƒ½ç«‹åˆ»åˆè¢«é‡æ–°é€‰ä¸­ç»§ç»­æ‰§è¡Œï¼Œåªå¯èƒ½ç»™ä¼˜å…ˆçº§æ›´é«˜çš„çº¿ç¨‹æœºä¼šï¼‰</td></tr><tr><td>t.getId()â€¦</td><td>è¿”å›è¯¥çº¿ç¨‹çš„ id ç­‰ç­‰ä¿¡æ¯</td></tr><tr><td>t.interrupt()</td><td>å°†è¯¥çº¿ç¨‹ä¸­æ–­ï¼ˆå®é™…å¹¶ä¸ä¼šä¸­æ–­ï¼Œåªæ˜¯å°†ä¸­æ–­æ ‡å¿—è®¾ç½®ä¸ºtrueï¼‰</td></tr><tr><td>t.isInterrupted()</td><td>æ£€æµ‹è¯¥çº¿ç¨‹æ˜¯å¦å·²ç»ä¸­æ–­</td></tr><tr><td>t.join()</td><td>åœ¨açº¿ç¨‹ä¸­è°ƒç”¨b.join()ï¼Œåˆ™açº¿ç¨‹é˜»å¡ï¼Œç›´åˆ°bçº¿ç¨‹æ‰§è¡Œå®Œ</td></tr><tr><td>t.join(long millis)</td><td>åŒä¸Šï¼Œä¸è¿‡açº¿ç¨‹é˜»å¡çš„æ—¶é—´æ ¹æ®longçš„å¤§å°æœ‰å…³ï¼Œå¦‚æœè¾¾åˆ°è®¾å®šçš„é˜»å¡æ—¶é—´ï¼Œå°±ç®—bçº¿ç¨‹æ²¡æœ‰æ‰§è¡Œå®Œï¼Œaçº¿ç¨‹ä¹Ÿä¼šè¢«å”¤é†’ã€‚</td></tr></tbody></table><hr><p>å…³äº interruptï¼Œ<a href="https://blog.csdn.net/qpc908694753/article/details/61414495" target="_blank" rel="noopener">JAVA interruptã€interruptedå’ŒisInterruptedçš„åŒºåˆ«</a></p><blockquote><p>interrupt æ–¹æ³•æ˜¯ç”¨äºä¸­æ–­çº¿ç¨‹çš„ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹çš„çŠ¶æ€å°†è¢«ç½®ä¸ºâ€ä¸­æ–­â€çŠ¶æ€ã€‚</p><p>æ³¨æ„ï¼šçº¿ç¨‹ä¸­æ–­ä»…ä»…æ˜¯è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ä½ï¼Œä¸ä¼šåœæ­¢çº¿ç¨‹ã€‚éœ€è¦ç”¨æˆ·è‡ªå·±å»ç›‘è§†çº¿ç¨‹çš„çŠ¶æ€å¹¶åšå¤„ç†ã€‚æ”¯æŒçº¿ç¨‹ä¸­æ–­çš„æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯çº¿ç¨‹ä¸­æ–­åä¼šæŠ›å‡º InterruptedException çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¿™é‡Œçš„sleepï¼Œä»¥åŠObject.waitç­‰æ–¹æ³•ï¼‰å°±æ˜¯åœ¨ç›‘è§†çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œä¸€æ—¦çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€è¢«ç½®ä¸ºâ€œä¸­æ–­çŠ¶æ€â€ï¼Œå°±ä¼šæŠ›å‡ºä¸­æ–­å¼‚å¸¸ã€‚</p></blockquote><h4 id="åºŸå¼ƒæ–¹æ³•"><a href="#åºŸå¼ƒæ–¹æ³•" class="headerlink" title="åºŸå¼ƒæ–¹æ³•"></a>åºŸå¼ƒæ–¹æ³•</h4><ul><li>stopï¼šä¼šé‡Šæ”¾è¯¥çº¿ç¨‹æ‰€æŒæœ‰çš„æ‰€æœ‰é”ï¼Œä½†è¿™ç§é‡Šæ”¾æ˜¯ä¸å¯æ§åˆ¶ã€éé¢„æœŸçš„ã€‚è€Œä¸”ä¸€ä¸ªçº¿ç¨‹ä¸åº”è¯¥ç”±å…¶ä»–çº¿ç¨‹æ¥å¼ºåˆ¶ä¸­æ–­æˆ–åœæ­¢ï¼Œè€Œåº”è¯¥è‡ªè¡Œåœæ­¢</li><li>suspendï¼šçº¿ç¨‹åœ¨æš‚åœçš„æ—¶å€™ä»ç„¶å æœ‰è¯¥èµ„æºï¼Œå¯¼è‡´éœ€è¦è¯¥èµ„æºçš„çº¿ç¨‹äº§ç”Ÿç¯è·¯ç­‰å¾…ï¼Œä»è€Œé€ æˆæ­»é”ã€‚</li><li>resumeï¼šç”¨æ¥å›å¤è¢«æŒ‚èµ·çš„çº¿ç¨‹ï¼Œè·Ÿ suspend å¯¹åº”ã€‚</li></ul><h2 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h2><p>Java ä¸­å…³äºçº¿ç¨‹æ± çš„ç»§æ‰¿å…³ç³»å¦‚ä¸‹</p><p><img src="/Java-çº¿ç¨‹å’Œçº¿ç¨‹æ± è¯¦è§£/ç»§æ‰¿å›¾.png" alt=""></p><p>Executor æ˜¯ä¸€ä¸ªé¡¶å±‚æ¥å£ï¼Œå…¶ä¸­åªå£°æ˜äº†ä¸€ä¸ªæ–¹æ³•<code>execute(Runnable)</code>ï¼Œç”¨æ¥æ‰§è¡Œä¼ è¿›å»çš„ä»»åŠ¡</p><p>ExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£ï¼Œå¹¶å£°æ˜äº†ä¸€äº›æ–¹æ³•ï¼š<code>submit</code>ã€<code>invokeAll</code>ã€<code>invokeAny</code>ä»¥åŠ<code>shutDown</code> ç­‰</p><p>æŠ½è±¡ç±» AbstractExecutorService å®ç°äº† ExecutorService æ¥å£ï¼ŒåŸºæœ¬å®ç°äº† ExecutorService ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•</p><p>ThreadPoolExecutor ç»§æ‰¿äº†ç±» AbstractExecutorServiceï¼Œæ˜¯çº¿ç¨‹æ± å®ç°ç±»ï¼Œæ„é€ æ–¹æ³•å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> maximumPoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">long</span> keepAliveTime,</span></span></span><br><span class="line"><span class="function"><span class="params">                          TimeUnit unit,</span></span></span><br><span class="line"><span class="function"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span></span><br><span class="line"><span class="function"><span class="params">                          ThreadFactory threadFactory,</span></span></span><br><span class="line"><span class="function"><span class="params">                          RejectedExecutionHandler handler)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (corePoolSize &lt; <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt;= <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt; corePoolSize ||</span><br><span class="line">        keepAliveTime &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">    <span class="keyword">if</span> (workQueue == <span class="keyword">null</span> || threadFactory == <span class="keyword">null</span> || handler == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    <span class="keyword">this</span>.corePoolSize = corePoolSize;</span><br><span class="line">    <span class="keyword">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class="line">    <span class="keyword">this</span>.workQueue = workQueue;</span><br><span class="line">    <span class="keyword">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class="line">    <span class="keyword">this</span>.threadFactory = threadFactory;</span><br><span class="line">    <span class="keyword">this</span>.handler = handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ul><li>corePoolSizeï¼šæ ¸å¿ƒæ± çš„å¤§å°ï¼Œåˆ›å»ºäº†çº¿ç¨‹æ± åï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± ä¸­å¹¶æ²¡æœ‰ä»»ä½•çº¿ç¨‹ï¼Œè€Œæ˜¯ç­‰å¾…æœ‰ä»»åŠ¡åˆ°æ¥æ‰åˆ›å»ºçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œé™¤éè°ƒç”¨<code>prestartAllCoreThreads</code>æˆ–è€…<code>prestartCoreThread</code>æ–¹æ³•é¢„åˆ›å»ºçº¿ç¨‹ï¼Œå³åœ¨æ²¡æœ‰ä»»åŠ¡åˆ°æ¥ä¹‹å‰å°±åˆ›å»º corePoolSize ä¸ªçº¿ç¨‹æˆ–è€…ä¸€ä¸ªçº¿ç¨‹ã€‚å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ° corePoolSize åï¼Œåˆ°è¾¾çš„ä»»åŠ¡ä¼šè¢«æ”¾åˆ°ç¼“å­˜é˜Ÿåˆ—ä¸­</li><li>maximumPoolSizeï¼šçº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ï¼Œè¡¨ç¤ºåœ¨çº¿ç¨‹æ± ä¸­æœ€å¤šèƒ½åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹</li><li>keepAliveTimeï¼šçº¿ç¨‹æ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶æœ€å¤šä¿æŒå¤šä¹…æ—¶é—´ä¼šç»ˆæ­¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°å¤§äº corePoolSize æ—¶ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹ç©ºé—²çš„æ—¶é—´è¾¾åˆ° keepAliveTimeï¼Œå°±ä¼šç»ˆæ­¢ï¼Œç›´åˆ°çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸è¶…è¿‡ corePoolSizeã€‚ä½†å¦‚æœè°ƒç”¨äº†<code>allowCoreThreadTimeOut(boolean)</code>æ–¹æ³•ï¼Œå³ä½¿çº¿ç¨‹æ•°ä¸å¤§äº corePoolSizeï¼Œè¯¥å‚æ•°ä¹Ÿä¼šèµ·ä½œç”¨ï¼Œç›´åˆ°çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸º0</li><li><p>unitï¼šå‚æ•°keepAliveTimeçš„æ—¶é—´å•ä½ï¼Œæœ‰7ç§å–å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TimeUnit.DAYS;               //å¤©</span><br><span class="line">TimeUnit.HOURS;             //å°æ—¶</span><br><span class="line">TimeUnit.MINUTES;           //åˆ†é’Ÿ</span><br><span class="line">TimeUnit.SECONDS;           //ç§’</span><br><span class="line">TimeUnit.MILLISECONDS;      //æ¯«ç§’</span><br><span class="line">TimeUnit.MICROSECONDS;      //å¾®å¦™</span><br><span class="line">TimeUnit.NANOSECONDS;       //çº³ç§’</span><br></pre></td></tr></table></figure></li><li><p>workQueueï¼šé˜»å¡é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜å‚¨ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¼šå¯¹çº¿ç¨‹æ± çš„è¿è¡Œè¿‡ç¨‹äº§ç”Ÿé‡å¤§å½±å“ã€‚ä¸€èˆ¬æ¥è¯´æœ‰ä»¥ä¸‹å‡ ç§é€‰æ‹©ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ArrayBlockingQueue;</span><br><span class="line">LinkedBlockingQueue;</span><br><span class="line">SynchronousQueue;</span><br></pre></td></tr></table></figure></li><li><p>threadFactoryï¼šçº¿ç¨‹å·¥å‚ï¼Œä¸»è¦ç”¨æ¥åˆ›å»ºçº¿ç¨‹</p></li><li>handlerï¼šè¡¨ç¤ºå½“æ‹’ç»å¤„ç†ä»»åŠ¡æ—¶çš„ç­–ç•¥ï¼Œæœ‰ä»¥ä¸‹å››ç§é€‰æ‹©ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ThreadPoolExecutor.AbortPolicyï¼šä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡º RejectedExecutionException å¼‚å¸¸ã€‚ </span><br><span class="line">ThreadPoolExecutor.DiscardPolicyï¼šä¹Ÿæ˜¯ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä¸æŠ›å‡ºå¼‚å¸¸ã€‚ </span><br><span class="line">ThreadPoolExecutor.DiscardOldestPolicyï¼šä¸¢å¼ƒé˜Ÿåˆ—æœ€å‰é¢çš„ä»»åŠ¡ï¼Œç„¶åé‡æ–°å°è¯•æ‰§è¡Œä»»åŠ¡ï¼ˆé‡å¤æ­¤è¿‡ç¨‹ï¼‰</span><br><span class="line">ThreadPoolExecutor.CallerRunsPolicyï¼šç”±è°ƒç”¨çº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡</span><br></pre></td></tr></table></figure></li></ul><h4 id="ä¸ºä½•ä½¿ç”¨"><a href="#ä¸ºä½•ä½¿ç”¨" class="headerlink" title="ä¸ºä½•ä½¿ç”¨"></a>ä¸ºä½•ä½¿ç”¨</h4><ul><li>é™ä½èµ„æºæ¶ˆè€—<br><br>å¯ä»¥é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ </li><li>æé«˜å“åº”é€Ÿåº¦<br><br>å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚ </li><li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ <br><br>çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶åœ°åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§</li></ul><h4 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h4><p>å®é™…ä¸Šæ–°å»ºçº¿ç¨‹æ± éƒ½é€šè¿‡å·¥å‚ç±» Executors ç±»å®ç°ï¼Œå…¶ä¸­å®šä¹‰ä¸€äº›æ–°å»º ThreadPoolExecutor å®ä¾‹çš„å·¥å‚æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºå¯å®¹çº³å›ºå®šæ•°é‡çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œæ¯ä¸ªçº¿ç¨‹çš„å­˜æ´»æ—¶é—´æ˜¯æ— é™çš„</span></span><br><span class="line"><span class="comment">//çº¿ç¨‹æ± æ»¡äº†å°±ä¸å†æ·»åŠ çº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">//å¦‚æœæ± ä¸­çš„æ‰€æœ‰çº¿ç¨‹å‡åœ¨ç¹å¿™çŠ¶æ€ï¼Œå¯¹äºæ–°ä»»åŠ¡ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ä¸­(æ— ç•Œçš„é˜»å¡é˜Ÿåˆ—)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads, ThreadFactory threadFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(),</span><br><span class="line">                                  threadFactory);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ‰æ–°ä»»åŠ¡åˆ°æ¥ï¼Œåˆ™æ’å…¥åˆ°SynchronousQueueä¸­ï¼Œç”±äºSynchronousQueueæ˜¯åŒæ­¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">//å› æ­¤ä¼šåœ¨æ± ä¸­å¯»æ‰¾å¯ç”¨çº¿ç¨‹æ¥æ‰§è¡Œï¼Œè‹¥æœ‰å¯ä»¥çº¿ç¨‹åˆ™æ‰§è¡Œï¼Œè‹¥æ²¡æœ‰å¯ç”¨çº¿ç¨‹åˆ™åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œè¯¥ä»»åŠ¡</span></span><br><span class="line"><span class="comment">//è‹¥æ± ä¸­çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡æŒ‡å®šå¤§å°ï¼Œåˆ™è¯¥çº¿ç¨‹ä¼šè¢«é”€æ¯ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">(ThreadFactory threadFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;(),</span><br><span class="line">                                  threadFactory);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œä¸”çº¿ç¨‹çš„å­˜æ´»æ—¶é—´æ˜¯æ— é™çš„</span></span><br><span class="line"><span class="comment">//å½“è¯¥çº¿ç¨‹æ­£ç¹å¿™æ—¶ï¼Œå¯¹äºæ–°ä»»åŠ¡ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ä¸­(æ— ç•Œçš„é˜»å¡é˜Ÿåˆ—)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newSingleThreadExecutor</span><span class="params">(ThreadFactory threadFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> FinalizableDelegatedExecutorService</span><br><span class="line">        (<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                                <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(),</span><br><span class="line">                                threadFactory));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± å†…çº¿ç¨‹å­˜æ´»æ—¶é—´æ— é™åˆ¶ï¼Œçº¿ç¨‹æ± å¯ä»¥æ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">//å¦‚æœæ‰€æœ‰çº¿ç¨‹å‡å¤„äºç¹å¿™çŠ¶æ€ï¼Œå¯¹äºæ–°ä»»åŠ¡ä¼šè¿›å…¥DelayedWorkQueueé˜Ÿåˆ—ä¸­</span></span><br><span class="line"><span class="comment">//è¿™æ˜¯ä¸€ç§æŒ‰ç…§è¶…æ—¶æ—¶é—´æ’åºçš„é˜Ÿåˆ—ç»“æ„</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ScheduledExecutorService <span class="title">newScheduledThreadPool</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> corePoolSize, ThreadFactory threadFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ScheduledThreadPoolExecutor(corePoolSize, threadFactory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ThreadPoolExecutor ä¸­æ¯”è¾ƒé‡è¦çš„æ–¹æ³•</p><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>execute()</td><td>å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œäº¤ç”±çº¿ç¨‹æ± å»æ‰§è¡Œ</td></tr><tr><td>submit()</td><td>å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡çš„ï¼Œèƒ½å¤Ÿè¿”å›ä»»åŠ¡æ‰§è¡Œçš„ç»“æœï¼ˆåˆ©ç”¨ Futureï¼‰</td></tr><tr><td>shutdown()</td><td>å…³é—­çº¿ç¨‹æ± </td></tr><tr><td>shutdownNow()</td><td>å…³é—­çº¿ç¨‹æ± </td></tr></tbody></table><p>è¿˜æœ‰å…¶ä»–çš„æ–¹æ³•æ¯”å¦‚ï¼š<code>getQueue()</code>ã€<code>getPoolSize()</code> ã€<code>getActiveCount()</code>ã€<code>getCompletedTaskCount()</code>ç­‰ç”¨æ¥è·å–çº¿ç¨‹æ± çš„ç›¸å…³å±æ€§ã€‚</p><p>ç®€å•ä½¿ç”¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ExecutorService executor = Executors.newSingleThreadExecutor();</span><br><span class="line">    System.out.println(Thread.currentThread());</span><br><span class="line">    executor.execute(()-&gt; &#123;</span><br><span class="line">        System.out.println(Thread.currentThread());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ§åˆ¶å°è¾“å‡º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Thread[main,5,main]</span><br><span class="line">Thread[pool-1-thread-1,5,main]</span><br></pre></td></tr></table></figure></p><h4 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h4><p>è§‚å¯Ÿ ThreadPoolExecutor ä¸­çš„<code>execute</code>æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (command == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">  </span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * ä¸€ã€åˆ¤æ–­å½“å‰æ´»è·ƒçº¿ç¨‹æ•°æ˜¯å¦å°äº corePoolSizeï¼Œå¦‚æœå°äºï¼Œè°ƒç”¨ addWorker åˆ›å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line"><span class="comment">         * äºŒã€å¦‚æœå¤§äº corePoolSizeï¼Œå°†ä»»åŠ¡æ·»åŠ åˆ° workQueue é˜Ÿåˆ—ã€‚</span></span><br><span class="line"><span class="comment">         * ä¸‰ã€å¦‚æœåŠ å…¥ workQueue å¤±è´¥ï¼Œåˆ™åˆ›å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œ</span></span><br><span class="line"><span class="comment">         *     å¦‚æœåˆ›å»ºçº¿ç¨‹å¤±è´¥(å½“å‰çº¿ç¨‹æ•°å¤§äºmaximumPoolSize)ï¼Œå°±ä¼šè°ƒç”¨reject(å†…éƒ¨ç”¨handler)å¤„ç†æ‹’ç»ä»»åŠ¡ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> c = ctl.get();</span><br><span class="line">        <span class="keyword">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class="line">            <span class="keyword">if</span> (addWorker(command, <span class="keyword">true</span>))</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            c = ctl.get();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class="line">            <span class="keyword">int</span> recheck = ctl.get();</span><br><span class="line">            <span class="keyword">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class="line">                reject(command);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (workerCountOf(recheck) == <span class="number">0</span>)</span><br><span class="line">                addWorker(<span class="keyword">null</span>, <span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!addWorker(command, <span class="keyword">false</span>))</span><br><span class="line">            reject(command);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>è·Ÿè¸ª<code>addWorker</code>æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">addWorker</span><span class="params">(Runnable firstTask, <span class="keyword">boolean</span> core)</span> </span>&#123;</span><br><span class="line">    retry:</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> c = ctl.get();;) &#123;</span><br><span class="line">        <span class="comment">// Check if queue empty only if necessary.</span></span><br><span class="line">        <span class="keyword">if</span> (runStateAtLeast(c, SHUTDOWN)</span><br><span class="line">            &amp;&amp; (runStateAtLeast(c, STOP)</span><br><span class="line">                || firstTask != <span class="keyword">null</span></span><br><span class="line">                || workQueue.isEmpty()))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *åœ¨åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ï¼Œå³coreç­‰äºfalseæ—¶ã€‚åˆ¤æ–­å½“å‰çº¿ç¨‹æ•°æ˜¯å¦å¤§äºç­‰äºmaximumPoolSizeï¼Œ</span></span><br><span class="line"><span class="comment">             *å¦‚æœå¤§äºç­‰äºåˆ™è¿”å›falseï¼Œå³ä¸Šè¾¹è¯´çš„ç¬¬ä¸‰æ­¥ä¸­åˆ›å»ºçº¿ç¨‹å¤±è´¥çš„æƒ…å†µ</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">if</span> (workerCountOf(c)</span><br><span class="line">                &gt;= ((core ? corePoolSize : maximumPoolSize) &amp; COUNT_MASK))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (compareAndIncrementWorkerCount(c))</span><br><span class="line">                <span class="keyword">break</span> retry;</span><br><span class="line">            c = ctl.get();  <span class="comment">// Re-read ctl</span></span><br><span class="line">            <span class="keyword">if</span> (runStateAtLeast(c, SHUTDOWN))</span><br><span class="line">                <span class="keyword">continue</span> retry;</span><br><span class="line">            <span class="comment">// else CAS failed due to workerCount change; retry inner loop</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">boolean</span> workerStarted = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">boolean</span> workerAdded = <span class="keyword">false</span>;</span><br><span class="line">    Worker w = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * åˆ›å»ºWorkeræ—¶ä¼šè°ƒç”¨threadFactoryæ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚</span></span><br><span class="line"><span class="comment">         * ä¸Šè¾¹çš„ç¬¬äºŒæ­¥ä¸­ä¸­å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¼šè§¦å‘Workerçš„runæ–¹æ³•è¢«çº¿ç¨‹è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        w = <span class="keyword">new</span> Worker(firstTask);</span><br><span class="line">        <span class="keyword">final</span> Thread t = w.thread;</span><br><span class="line">        <span class="keyword">if</span> (t != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">final</span> ReentrantLock mainLock = <span class="keyword">this</span>.mainLock;</span><br><span class="line">            mainLock.lock();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> c = ctl.get();</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (isRunning(c) ||</span><br><span class="line">                    (runStateLessThan(c, STOP) &amp;&amp; firstTask == <span class="keyword">null</span>)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (t.isAlive()) <span class="comment">// precheck that t is startable</span></span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalThreadStateException();</span><br><span class="line">                    workers.add(w);</span><br><span class="line">                    <span class="keyword">int</span> s = workers.size();</span><br><span class="line">                    <span class="keyword">if</span> (s &gt; largestPoolSize)</span><br><span class="line">                        largestPoolSize = s;</span><br><span class="line">                    workerAdded = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                mainLock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (workerAdded) &#123;</span><br><span class="line">                t.start();</span><br><span class="line">                workerStarted = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (! workerStarted)</span><br><span class="line">            addWorkerFailed(w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> workerStarted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ–°å»º Work ï¼ŒåŒæ—¶ä¹Ÿä¼šåˆ©ç”¨å·¥å‚ç±»å®ä¾‹åŒ–ä¸€ä¸ªçº¿ç¨‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Worker(Runnable firstTask) &#123;</span><br><span class="line">    setState(-<span class="number">1</span>); <span class="comment">// inhibit interrupts until runWorker</span></span><br><span class="line">    <span class="keyword">this</span>.firstTask = firstTask;</span><br><span class="line">    <span class="keyword">this</span>.thread = getThreadFactory().newThread(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¦‚æœ workerAddedï¼Œè°ƒç”¨<code>t.start()</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    runWorker(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è·Ÿè¸ª<code>runWorker</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">runWorker</span><span class="params">(Worker w)</span> </span>&#123;</span><br><span class="line">    Thread wt = Thread.currentThread();</span><br><span class="line">    Runnable task = w.firstTask;</span><br><span class="line">    w.firstTask = <span class="keyword">null</span>;</span><br><span class="line">    w.unlock(); <span class="comment">// allow interrupts</span></span><br><span class="line">    <span class="keyword">boolean</span> completedAbruptly = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (task != <span class="keyword">null</span> || (task = getTask()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((runStateAtLeast(ctl.get(), STOP) ||</span><br><span class="line">                 (Thread.interrupted() &amp;&amp;</span><br><span class="line">                  runStateAtLeast(ctl.get(), STOP))) &amp;&amp;</span><br><span class="line">                !wt.isInterrupted())</span><br><span class="line">                wt.interrupt();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                beforeExecute(wt, task);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    task.run();</span><br><span class="line">                    afterExecute(task, <span class="keyword">null</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">                    afterExecute(task, ex);</span><br><span class="line">                    <span class="keyword">throw</span> ex;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                task = <span class="keyword">null</span>;</span><br><span class="line">                w.completedTasks++;</span><br><span class="line">                w.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        completedAbruptly = <span class="keyword">false</span>;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        processWorkerExit(w, completedAbruptly);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°<code>getTask</code>æ–¹æ³•ä¸æ–­ä» workerQueue ä¸­è¯»å–ä»»åŠ¡ç„¶åæ‰§è¡Œã€‚åªè¦<code>getTask</code>æ–¹æ³•ä¸è¿”å› nullï¼Œå¾ªç¯å°±ä¸ä¼šé€€å‡ºã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Runnable <span class="title">getTask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> timedOut = <span class="keyword">false</span>; <span class="comment">// Did the last poll() time out?</span></span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="keyword">int</span> c = ctl.get();</span><br><span class="line">        <span class="keyword">if</span> (runStateAtLeast(c, SHUTDOWN)</span><br><span class="line">            &amp;&amp; (runStateAtLeast(c, STOP) || workQueue.isEmpty())) &#123;</span><br><span class="line">            decrementWorkerCount();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> wc = workerCountOf(c);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ˜¯åˆ¤æ–­å½“å‰çº¿ç¨‹æ•°æ˜¯å¦å¤§äº corePoolSize</span></span><br><span class="line">        <span class="keyword">boolean</span> timed = allowCoreThreadTimeOut || wc &gt; corePoolSize;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ((wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut))</span><br><span class="line">            &amp;&amp; (wc &gt; <span class="number">1</span> || workQueue.isEmpty())) &#123;</span><br><span class="line">            <span class="keyword">if</span> (compareAndDecrementWorkerCount(c))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * å¦‚æœå½“å‰çº¿ç¨‹æ•°å¤§äº corePoolSizeï¼Œè°ƒç”¨ workQueue çš„pollæ–¹æ³•è·å–ä»»åŠ¡</span></span><br><span class="line"><span class="comment">         * è¶…æ—¶æ—¶é—´ä¸º keepAliveTimeã€‚å¦‚æœè¶…æ—¶ï¼Œpollè¿”å›äº†nullï¼Œä¸Šè¾¹çš„whileå¾ªåºå°±ä¼šé€€å‡º</span></span><br><span class="line"><span class="comment">         * å¦‚æœå½“å‰çº¿ç¨‹æ•°å°äº corePoolSizeï¼Œè°ƒç”¨ workQueue çš„takeæ–¹æ³•é˜»å¡å½“å‰</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runnable r = timed ?</span><br><span class="line">                workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) :</span><br><span class="line">                workQueue.take();</span><br><span class="line">            <span class="keyword">if</span> (r != <span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> r;</span><br><span class="line">            timedOut = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException retry) &#123;</span><br><span class="line">            timedOut = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€åç”¨ä¸€å¼ å›¾æ€»ç»“ä¸Šè¿°è¿‡ç¨‹</p><p><img src="/Java-çº¿ç¨‹å’Œçº¿ç¨‹æ± è¯¦è§£/çº¿ç¨‹æ± æµç¨‹.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;çº¿ç¨‹åœ¨ Java å¼€å‘ä¸­æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µã€‚ åœ¨Javaä¸­ï¼Œâ€œçº¿ç¨‹â€æŒ‡ä¸¤ä»¶ä¸åŒçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;java.lang.Thread ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼›&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹çš„æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="å¤šçº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="çº¿ç¨‹æ± " scheme="http://yoursite.com/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    
  </entry>
  
  <entry>
    <title>Java æ•°æ®åº“çŸ¥è¯†æ•´ç†</title>
    <link href="http://yoursite.com/Java-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86/"/>
    <id>http://yoursite.com/Java-æ•°æ®åº“çŸ¥è¯†æ•´ç†/</id>
    <published>2019-03-18T02:45:26.000Z</published>
    <updated>2019-03-18T02:45:28.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ã€Šå‰‘æŒ‡offerã€‹é¢˜ç›® Java å®ç°</title>
    <link href="http://yoursite.com/%E3%80%8A%E5%89%91%E6%8C%87offer%E3%80%8B%E9%A2%98%E7%9B%AE-Java-%E5%AE%9E%E7%8E%B0/"/>
    <id>http://yoursite.com/ã€Šå‰‘æŒ‡offerã€‹é¢˜ç›®-Java-å®ç°/</id>
    <published>2019-03-18T02:42:29.000Z</published>
    <updated>2019-03-25T09:17:06.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°"><a href="#Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°" class="headerlink" title="Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°"></a>Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton singleton;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;  </span><br><span class="line">                <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">                    singleton = <span class="keyword">new</span> Singleton();  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> singleton;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="Problem2ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾"><a href="#Problem2ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾" class="headerlink" title="Problem2ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾"></a>Problem2ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾</h3><p>åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»äºŒç»´æ•°ç»„çš„å³ä¸Šè§’å¼€å§‹é€‰å–ä¸ key æ¯”è¾ƒçš„æ•´æ•°</span></span><br><span class="line"><span class="comment">     * column çš„å˜åŒ–:arr[0].length - 1 ---&gt; 0</span></span><br><span class="line"><span class="comment">     * row çš„å˜åŒ– 0 ---&gt; arr.length</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> arr </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span>[][] arr, <span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> col = arr[<span class="number">0</span>].length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (col &gt;= <span class="number">0</span> &amp;&amp; row &lt; arr.length) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[row][col] == key) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr[row][col] &gt; key) &#123;   <span class="comment">//å¤§äºæŸ¥æ‰¾å€¼ï¼Œåˆ™å¾€å‰æ¨ä¸€åˆ—</span></span><br><span class="line">            col--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;    <span class="comment">//å°äºæŸ¥æ‰¾å€¼ï¼Œåˆ™å¾€ä¸‹æ¨ä¸€è¡Œ</span></span><br><span class="line">            row++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem3ï¼šæ›¿æ¢ç©ºæ ¼"><a href="#Problem3ï¼šæ›¿æ¢ç©ºæ ¼" class="headerlink" title="Problem3ï¼šæ›¿æ¢ç©ºæ ¼"></a>Problem3ï¼šæ›¿æ¢ç©ºæ ¼</h3><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå°†å­—ç¬¦ä¸²çš„æ¯ä¸ªç©ºæ ¼æ›¿æ¢ä¸ºâ€%20â€ã€‚ä¾‹å¦‚è¾“å…¥<code>We are happy</code>ï¼Œåˆ™è¾“å‡º<code>We%20are%20happy</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨ StringBuilder</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">replace</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (str.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str.charAt(i) == <span class="string">' '</span>) &#123;</span><br><span class="line">            builder.append(<span class="string">"%20"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            builder.append(str.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> builder.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem4ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"><a href="#Problem4ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨" class="headerlink" title="Problem4ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"></a>Problem4ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</h3><p>è¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼ŒæŒ‰ç…§ä»å°¾åˆ°å¤´çš„é¡ºåºæ‰“å°å‡ºæ¯ä¸ªèŠ‚ç‚¹çš„å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    T value;</span><br><span class="line">    ListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨æ ˆå®ç°</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headNode</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printListReverse</span><span class="params">(ListNode headNode)</span> </span>&#123;</span><br><span class="line">    Stack&lt;ListNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (headNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">        stack.push(headNode);</span><br><span class="line">        headNode = headNode.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!stack.empty()) &#123;</span><br><span class="line">        System.out.println(stack.pop().value + <span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ListNode&lt;Integer&gt; node = <span class="keyword">new</span> ListNode&lt;&gt;(<span class="number">1</span>);</span><br><span class="line">    node.next = <span class="keyword">new</span> ListNode&lt;&gt;(<span class="number">2</span>);</span><br><span class="line">    node.next.next = <span class="keyword">new</span> ListNode&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">    printListReverse(node);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem5ï¼šé‡å»ºäºŒå‰æ ‘"><a href="#Problem5ï¼šé‡å»ºäºŒå‰æ ‘" class="headerlink" title="Problem5ï¼šé‡å»ºäºŒå‰æ ‘"></a>Problem5ï¼šé‡å»ºäºŒå‰æ ‘</h3><p>è¾“å…¥æŸäºŒå‰æ ‘çš„å‰åºéå†å’Œä¸­åºéå†ç»“æœï¼Œè¯·é‡å»ºå‡ºè¯¥äºŒå‰æ ‘ã€‚</p><p>å‡è®¾è¾“å…¥çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœä¸­éƒ½ä¸åŒ…å«é‡å¤çš„æ•°å­—ã€‚</p><p>ä¾‹å¦‚è¾“å…¥å‰åºéå†åºåˆ—ï¼š <code>{1, 2, 4, 7, 3, 5, 6, 8}</code></p><p>ä¸­åºéå†åºåˆ—ï¼š<code>{4, 7, 2, 1, 5, 3, 8, 6}</code></p><p>é‡å»ºå‡ºæ‰€ç¤ºäºŒå‰æ ‘å¹¶ä¸”è¾“å‡ºå®ƒçš„å¤´ç»“ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">     <span class="number">1</span></span><br><span class="line">   /   \</span><br><span class="line">  <span class="number">2</span>     <span class="number">3</span></span><br><span class="line"> /     / \</span><br><span class="line"><span class="number">4</span>     <span class="number">5</span>   <span class="number">6</span></span><br><span class="line"> \        /</span><br><span class="line"> <span class="number">7</span>        <span class="number">8</span></span><br></pre></td></tr></table></figure><h4 id="çŸ¥è¯†ç‚¹è¡¥å……"><a href="#çŸ¥è¯†ç‚¹è¡¥å……" class="headerlink" title="çŸ¥è¯†ç‚¹è¡¥å……"></a>çŸ¥è¯†ç‚¹è¡¥å……</h4><blockquote><p>å‰åºéå†ï¼šå…ˆè®¿é—®æ ¹èŠ‚ç‚¹ï¼Œå†è®¿é—®å·¦å­ç»“ç‚¹ï¼Œæœ€åè®¿é—®å³å­ç»“ç‚¹ï¼›ï¼ˆæ ¹å·¦å³ï¼‰</p><p>ä¸­åºéå†ï¼šå…ˆè®¿é—®å·¦å­ç»“ç‚¹ï¼Œå†è®¿é—®æ ¹ç»“ç‚¹ï¼Œæœ€åè®¿é—®å³å­ç»“ç‚¹ï¼›ï¼ˆå·¦æ ¹å³ï¼‰</p><p>ååºéå†ï¼šå…ˆè®¿é—®å·¦å­ç»“ç‚¹ï¼Œå†è®¿é—®å³å­ç»“ç‚¹ï¼Œæœ€åè®¿é—®æ ¹ç»“ç‚¹ï¼›ï¼ˆå·¦å³æ ¹ï¼‰</p></blockquote><blockquote><p>äºŒå‰æœç´¢æ ‘ï¼šå·¦å­ç»“ç‚¹æ€»æ˜¯å°äºæˆ–ç­‰äºæ ¹ç»“ç‚¹ï¼Œè€Œå³å­ç»“ç‚¹æ€»æ˜¯å¤§äºæˆ–ç­‰äºæ ¹ç»“ç‚¹ã€‚</p><p>äºŒå‰æ ‘çš„ç‰¹ä¾‹æ˜¯<strong>å †</strong>å’Œ<strong>çº¢é»‘æ ‘</strong>ã€‚</p><p>å †åˆ†ä¸ºæœ€å¤§å †å’Œæœ€å°å †ã€‚åœ¨æœ€å¤§å †ä¸­æ ¹èŠ‚ç‚¹çš„å€¼æœ€å¤§ï¼Œåœ¨æœ€å°å †ä¸­æ ¹èŠ‚ç‚¹çš„å€¼æœ€å°ã€‚</p><p>çº¢é»‘æ ‘æ˜¯æŠŠæ ‘ä¸­çš„ç»“ç‚¹å®šä¹‰ä¸ºçº¢ã€é»‘ä¸¤ç§é¢œè‰²ï¼Œå¹¶é€šè¿‡è§„åˆ™ç¡®ä¿ä»æ ¹ç»“ç‚¹åˆ°å¶ç»“ç‚¹çš„æœ€é•¿è·¯å¾„çš„é•¿åº¦ä¸è¶…è¿‡æœ€çŸ­è·¯å¾„çš„ä¸¤å€ã€‚</p></blockquote><h3 id="Problem6ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"><a href="#Problem6ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—" class="headerlink" title="Problem6ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"></a>Problem6ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</h3><p>ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼Œè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•°<br><code>appendTail</code>å’Œ<code>deleteHead</code>,åˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥ç»“ç‚¹å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤ç»“ç‚¹çš„åŠŸèƒ½<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConstructQueue</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     s1 ç”¨æ¥å®ç°æ”¾å…¥æ–°çš„å…ƒç´ ï¼Œç›´æ¥æ”¾åˆ°æ ˆé¡¶</span></span><br><span class="line"><span class="comment">     s2 ç”¨æ¥è¾…åŠ©åˆ é™¤å…ƒç´ ï¼Œåˆ é™¤é˜Ÿå¤´æ—¶ï¼Œå…ˆå°† s1 ä¸­é™¤åº•éƒ¨å…ƒç´ ä¹‹å¤–å…¨éƒ½ç§»åˆ° s2</span></span><br><span class="line"><span class="comment">     ç„¶ååˆ é™¤åº•éƒ¨å…ƒç´ ï¼Œå†å°† s2 å…ƒç´ ç§»å› s1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Stack&lt;String&gt; stack1 = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">    Stack&lt;String&gt; stack2 = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ç°appendTailå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">appendTail</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        stack1.push(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ç°deleteHeadå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteHead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!stack1.empty()) &#123;</span><br><span class="line">            stack2.push(stack1.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        String head = stack2.pop();</span><br><span class="line">        <span class="keyword">while</span> (!stack2.empty()) &#123;</span><br><span class="line">            stack1.push(stack2.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ConstructQueue queue = <span class="keyword">new</span> ConstructQueue();</span><br><span class="line">        queue.appendTail(<span class="string">"a"</span>);</span><br><span class="line">        queue.appendTail(<span class="string">"b"</span>);</span><br><span class="line">        queue.appendTail(<span class="string">"c"</span>);</span><br><span class="line">        queue.appendTail(<span class="string">"d"</span>);</span><br><span class="line">        System.out.println(queue.deleteHead());</span><br><span class="line">        System.out.println(queue.deleteHead());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a</span><br><span class="line">b</span><br></pre></td></tr></table></figure></p><h3 id="Problem7ï¼šæ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—"><a href="#Problem7ï¼šæ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—" class="headerlink" title="Problem7ï¼šæ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—"></a>Problem7ï¼šæ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—</h3><p>æŠŠä¸€ä¸ªæ•°ç»„æœ€å¼€å§‹çš„è‹¥å¹²ä¸ªå…ƒç´ æ¬åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ•°ç»„çš„æ—‹è½¬ ã€‚è¾“å…¥ä¸€ä¸ªé€’å¢æ’åºçš„æ•°ç»„çš„æ—‹è½¬ï¼Œè¾“å‡ºæ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´ ã€‚<br>ä¾‹å¦‚æ•°ç»„ <code>{3, 4, 5, 1, 2}</code>ä¸º<code>{1, 2, 3, 4, 5}</code>çš„ä¸€ä¸ªæ—‹è½¬ï¼Œè¯¥æ•°ç»„çš„æœ€å°å€¼ä¸º 1;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] a = &#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line">    System.out.println(minNumInRotateArray(a));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨æ„åˆ°æ—‹è½¬ä¹‹åçš„æ•°ç»„å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ªæ’åºå­æ•°ç»„ï¼Œå‰é¢çš„å­æ•°ç»„å…ƒç´ éƒ½å¤§äºæˆ–ç­‰äºåé¢å­æ•°ç»„çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">     * è¿˜å¯ä»¥æ³¨æ„åˆ°æœ€å°çš„å…ƒç´ åˆšå¥½æ˜¯è¿™ä¸¤ä¸ªå­æ•°ç»„çš„åˆ†ç•Œç‚¹ã€‚åœ¨æ’åºæ•°ç»„ä¸­æˆ‘ä»¬å¯ä»¥ç”¨äºŒåˆ†æŸ¥æ‰¾æ³•å®ç°O(logn)çš„æŸ¥æ‰¾ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç”¨ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ ã€‚æŒ‰ç…§æ—‹è½¬è§„åˆ™ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ åº”è¯¥å¤§äºç­‰äºæœ€åä¸€ä¸ªå…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">     * æ¥ç€å¯ä»¥æ‰¾åˆ°æ•°ç»„ä¸­é—´çš„å…ƒç´ ã€‚å¦‚æœä¸­é—´å…ƒç´ ä½äºå‰é¢çš„é€’å¢æ•°ç»„ï¼Œåˆ™å®ƒåº”è¯¥å¤§äºç­‰äºç¬¬ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ï¼Œ</span></span><br><span class="line"><span class="comment">     * æ­¤æ—¶æˆ‘ä»¬è¦æ‰¾åˆ°çš„æœ€å°å…ƒç´ è‚¯å®šåº”è¯¥ä½äºè¯¥ä¸­é—´å…ƒç´ çš„åé¢ã€‚è¿™æ ·æˆ‘ä»¬æŠŠç¬¬ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸­é—´å…ƒç´ ï¼Œä»è€Œç¼©å°æŸ¥æ‰¾èŒƒå›´ã€‚</span></span><br><span class="line"><span class="comment">     * åŒç†ç¬¬äºŒä¸ªæŒ‡é’ˆçš„èŒƒå›´ä¹Ÿå°†é€æ¸ç¼©å°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¬¬ä¸€ä¸ªæŒ‡é’ˆæ€»æ˜¯æŒ‡å‘å‰é¢çš„é€’å¢æ•°ç»„å…ƒç´ ï¼Œç¬¬äºŒä¸ªæŒ‡é’ˆæ€»æ˜¯æŒ‡å‘åé¢çš„é€’å¢æ•°ç»„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">     * æœ€ç»ˆç¬¬ä¸€ä¸ªæŒ‡é’ˆå°†æŒ‡å‘å‰é¢çš„å­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç¬¬äºŒä¸ªæŒ‡é’ˆå°†æŒ‡å‘åé¢çš„å­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ</span></span><br><span class="line"><span class="comment">     * å³äºŒè€…æœ€åæŒ‡å‘ç›¸é‚»çš„å…ƒç´ ï¼Œä¸”ç¬¬äºŒä¸ªæŒ‡é’ˆæŒ‡å‘çš„åˆšå¥½æ˜¯æœ€å°çš„å…ƒç´ â€”â€”å¾ªç¯ç»“æŸæ¡ä»¶ã€‚</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">minNumInRotateArray</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (array == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> right = array.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (array[left] &gt;= array[right]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (right - left == <span class="number">1</span>) &#123;</span><br><span class="line">            mid = right;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mid = (left + right) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ­¤æ—¶åº”è¯¥ç”¨é¡ºåºæŸ¥æ‰¾ï¼Œå› ä¸ºä¸ç¡®å®šarray[mid]ä½äºå“ªä¸ªæœ‰åºå­æ•°ç»„</span></span><br><span class="line">        <span class="keyword">if</span> (array[left] == array[right] &amp;&amp; array[right] == array[mid]) &#123;</span><br><span class="line">            <span class="keyword">return</span> findInOrder(array, left, right);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (array[left] &lt;= array[mid]) &#123;</span><br><span class="line">            left = mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> array[mid];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">findInOrder</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = array[left];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; right; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (array[i] &lt; k) &#123;</span><br><span class="line">            k = array[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> k;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem8ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—"><a href="#Problem8ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—" class="headerlink" title="Problem8ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—"></a>Problem8ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—</h3><p>å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥nï¼Œæ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬né¡¹ï¼Œæ–æ³¢é‚£å¥‘æ•°åˆ—çš„å®šä¹‰å¦‚ä¸‹ï¼š </p><blockquote><p>n=0, f(n)=0;<br>n=1, f(n)=1;<br>n&gt;1, f(n) = f(n-1) + f(n-2).</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">11</span>; i++) &#123;</span><br><span class="line">        System.out.print(fibonacci(i) + <span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">fibonacci</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fibonacci(n-<span class="number">1</span>) + fibonacci(n-<span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 1 1 2 3 5 8 13 21 34 55</span><br></pre></td></tr></table></figure></p><h3 id="Problem9ï¼šäºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°"><a href="#Problem9ï¼šäºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°" class="headerlink" title="Problem9ï¼šäºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°"></a>Problem9ï¼šäºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°</h3><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼Œè¾“å‡ºè¯¥æ•°äºŒè¿›åˆ¶è¡¨ç¤ºä¸­1çš„ä¸ªæ•°ã€‚</p><p>ä¾‹å¦‚æŠŠ9è¡¨ç¤ºæˆäºŒè¿›åˆ¶æ˜¯1001ï¼Œæœ‰2ä½æ˜¯1ï¼Œå› æ­¤å¦‚æœè¾“å…¥9ï¼Œè¯¥å‡½æ•°è¾“å‡º2ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public static int oneCountsOfBinary(int i) &#123;</span><br><span class="line">    char[] chars = Integer.toBinaryString(i).toCharArray();</span><br><span class="line">    int count = 0;</span><br><span class="line">    for (char c : chars) &#123;</span><br><span class="line">        if (c == &apos;1&apos;) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static int _oneCountsOfBinary(int i) &#123;</span><br><span class="line">    int count = 0;</span><br><span class="line">    int flag = 1;</span><br><span class="line">    while (flag != 0) &#123;</span><br><span class="line">        if ((i &amp; flag) != 0) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        flag = flag &lt;&lt; 1;</span><br><span class="line">    &#125;</span><br><span class="line">    return count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem10ï¼šæ•°å€¼çš„æ•´æ•°æ¬¡æ–¹"><a href="#Problem10ï¼šæ•°å€¼çš„æ•´æ•°æ¬¡æ–¹" class="headerlink" title="Problem10ï¼šæ•°å€¼çš„æ•´æ•°æ¬¡æ–¹"></a>Problem10ï¼šæ•°å€¼çš„æ•´æ•°æ¬¡æ–¹</h3><p> å®ç°å‡½æ•°<code>double power(double base, int exponent)</code>ï¼Œæ±‚ base çš„ exponent æ¬¡æ–¹ã€‚ä¸èƒ½ä½¿ç”¨åº“å‡½æ•°ï¼ŒåŒæ—¶ä¸éœ€è¦è€ƒè™‘å¤§æ•°é—®é¢˜ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">power</span><span class="params">(<span class="keyword">double</span> base, <span class="keyword">int</span> exponent)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (base &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"è¿ç®—æ— æ„ä¹‰"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (exponent == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (exponent &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> / powerUnsigned(base, -exponent);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> powerUnsigned(base, exponent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">double</span> <span class="title">powerUnsigned</span><span class="params">(<span class="keyword">double</span> base, <span class="keyword">int</span> exponent)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> result = base;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; exponent; i++) &#123;</span><br><span class="line">        result = result * base;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Problem11ï¼šOï¼ˆ1ï¼‰æ—¶é—´åˆ é™¤é“¾è¡¨ç»“ç‚¹"><a href="#Problem11ï¼šOï¼ˆ1ï¼‰æ—¶é—´åˆ é™¤é“¾è¡¨ç»“ç‚¹" class="headerlink" title="Problem11ï¼šOï¼ˆ1ï¼‰æ—¶é—´åˆ é™¤é“¾è¡¨ç»“ç‚¹"></a>Problem11ï¼šOï¼ˆ1ï¼‰æ—¶é—´åˆ é™¤é“¾è¡¨ç»“ç‚¹</h3><p>ç»™å®šå•å‘é“¾è¡¨çš„å¤´æŒ‡é’ˆå’Œä¸€ä¸ªç»“ç‚¹æŒ‡é’ˆï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°åœ¨O(1)æ—¶é—´åˆ é™¤è¯¥ç»“ç‚¹ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    Node next;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œç›´æ¥ç½®ç©º</span></span><br><span class="line"><span class="comment"> * å½“å¾…åˆ é™¤èŠ‚ç‚¹ä¸ºå°¾èŠ‚ç‚¹æ—¶ï¼Œéœ€è¦éå†å¾—åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åè®©å¾—åˆ°çš„èŠ‚ç‚¹çš„next ä¸º null</span></span><br><span class="line"><span class="comment"> * å¦åˆ™ p-&gt;next çš„å€¼èµ‹å€¼ç»™pï¼ŒæŠŠp-&gt;nextåˆ é™¤æ‰</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> delNode</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteNode</span><span class="params">(Node head, Node delNode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || delNode == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (head == delNode) &#123;</span><br><span class="line">        head = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (delNode.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        Node temp = head;</span><br><span class="line">        <span class="keyword">while</span> (temp.next != delNode) &#123;</span><br><span class="line">            temp = temp.next;</span><br><span class="line">        &#125;</span><br><span class="line">        temp.next = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    delNode.value = delNode.next.value;</span><br><span class="line">    delNode.next = delNode.next.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Problem12ï¼šè°ƒæ•´æ•°ç»„ä¸­å¥‡æ•°å’Œå¶æ•°çš„å…ˆåé¡ºåº"><a href="#Problem12ï¼šè°ƒæ•´æ•°ç»„ä¸­å¥‡æ•°å’Œå¶æ•°çš„å…ˆåé¡ºåº" class="headerlink" title="Problem12ï¼šè°ƒæ•´æ•°ç»„ä¸­å¥‡æ•°å’Œå¶æ•°çš„å…ˆåé¡ºåº"></a>Problem12ï¼šè°ƒæ•´æ•°ç»„ä¸­å¥‡æ•°å’Œå¶æ•°çš„å…ˆåé¡ºåº</h3><p>è¾“å…¥ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå®ç°ä¸€ä¸ªå‡½æ•°æ¥è°ƒæ•´è¯¥æ•°ç»„ä¸­æ•°å­—çš„é¡ºåºï¼Œä½¿å¾—æ‰€æœ‰ å¥‡æ•°ä½äºæ•°ç»„çš„å‰åŠéƒ¨åˆ†ï¼Œæ‰€æœ‰å¶æ•°ä½äºæ•°ç»„çš„ååŠéƒ¨åˆ†;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">orderArray</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> right = array.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; !isEven(array[left])) &#123;</span><br><span class="line">            left ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; isEven(array[right])) &#123;</span><br><span class="line">            right --;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp = array[left];</span><br><span class="line">            array[left] = array[right];</span><br><span class="line">            array[right] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isEven</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((i &amp; <span class="number">1</span>) == <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Problem13ï¼šé“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹"><a href="#Problem13ï¼šé“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹" class="headerlink" title="Problem13ï¼šé“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹"></a>Problem13ï¼šé“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹</h3><p>è¾“å…¥ä¸€ä¸ªé“¾è¡¨ï¼Œè¾“å‡ºè¯¥é“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹ã€‚ä¸ºäº†ç¬¦åˆå¤§å¤šæ•°äººçš„ä¹  æƒ¯ï¼Œä»1å¼€å§‹è®¡æ•°ï¼Œå³é“¾è¡¨çš„å°¾ç»“ç‚¹æ˜¯å€’æ•°ç¬¬ä¸€ä¸ªç»“ç‚¹ã€‚</p><p>ä¾‹å¦‚ä¸€ä¸ªé“¾è¡¨æœ‰6ä¸ªç»“ç‚¹ï¼Œä»å¤´ç»“ç‚¹å¼€å§‹å®ƒä»¬çš„å€¼ä¾æ¬¡æ˜¯<code>1ã€2ã€3ã€4ã€5ã€6</code>ã€‚è¿™ä¸ªé“¾è¡¨çš„å€’æ•°ç¬¬ä¸‰ä¸ªç»“ç‚¹æ˜¯å€¼ä¸º4çš„ç»“ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆè§£å†³ï¼Œç¬¬ä¸€ä¸ªæŒ‡é’ˆä»é“¾è¡¨çš„å¤´æŒ‡é’ˆå¼€å§‹éå†å‘å‰èµ°k-1ï¼Œç¬¬äºŒä¸ªæŒ‡é’ˆä¿æŒä¸åŠ¨</span></span><br><span class="line"><span class="comment"> * ä»ç¬¬kæ­¥å¼€å§‹ï¼Œç¬¬äºŒä¸ªæŒ‡é’ˆä¹Ÿå¼€å§‹ä»é“¾è¡¨çš„å¤´æŒ‡é’ˆå¼€å§‹éå†</span></span><br><span class="line"><span class="comment"> * ç”±äºä¸¤ä¸ªæŒ‡é’ˆçš„è·ç¦»ä¿æŒåœ¨k-1ï¼Œå½“ç¬¬ä¸€ä¸ªæŒ‡é’ˆåˆ°è¾¾é“¾è¡¨çš„å°¾ç»“ç‚¹æ—¶ï¼Œç¬¬äºŒä¸ªæŒ‡é’ˆåˆšå¥½åœ¨å€’æ•°ç¬¬kä¸ªç»“ç‚¹ä¸Š</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head å¤´ç»“ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> k å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(ListNode head, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode first = head;</span><br><span class="line">    ListNode second = head;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; k; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (first.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">            first = first.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(first.val);</span><br><span class="line">    <span class="keyword">while</span> (first.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        first = first.next;</span><br><span class="line">        second = second.next;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(first.val);</span><br><span class="line">    <span class="keyword">return</span> second.val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    ListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.val = val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem14ï¼šç¿»è½¬é“¾è¡¨"><a href="#Problem14ï¼šç¿»è½¬é“¾è¡¨" class="headerlink" title="Problem14ï¼šç¿»è½¬é“¾è¡¨"></a>Problem14ï¼šç¿»è½¬é“¾è¡¨</h3><p>å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åé“¾è¡¨çš„å¤´ç»“ç‚¹</p><p><img src="/ã€Šå‰‘æŒ‡offerã€‹é¢˜ç›®-Java-å®ç°/ç¿»è½¬é“¾è¡¨.png" alt=""></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¿»è½¬å•é“¾è¡¨</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> ç¿»è½¬ä¹‹åçš„å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">getReversedListHead</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//currentèŠ‚ç‚¹æ˜¯headçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    ListNode current = head.next;</span><br><span class="line">    <span class="comment">//å½“å‰çš„headå˜ä¸ºé“¾è¡¨çš„å°¾ï¼Œæ‰€ä»¥nextä¸ºç©º</span></span><br><span class="line">    head.next = <span class="keyword">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (current != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//currentNextèŠ‚ç‚¹æ˜¯currentçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</span></span><br><span class="line">        ListNode currentNext = current.next;</span><br><span class="line">        <span class="comment">//current.nextåæ–¹å‘æŒ‡å‘ä»¥å‰çš„èŠ‚ç‚¹</span></span><br><span class="line">        current.next = head;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//ç§»åŠ¨headå’ŒcurrentæŒ‡é’ˆï¼Œåˆ°åé¢headé‡æ–°æˆä¸ºå¤´èŠ‚ç‚¹</span></span><br><span class="line">        head = current;</span><br><span class="line">        current = currentNext;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¿»è½¬å•é“¾è¡¨çš„é€’å½’å®ç°</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> ç¿»è½¬ä¹‹åçš„å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">reverseListByRecursion</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode newList = reverseListByRecursion(head.next);</span><br><span class="line">    head.next.next = head;</span><br><span class="line">    head.next = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">return</span> newList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem15ï¼šåˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨"><a href="#Problem15ï¼šåˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨" class="headerlink" title="Problem15ï¼šåˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨"></a>Problem15ï¼šåˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨</h3><p>è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„ç»“ç‚¹ä»ç„¶æ˜¯æŒ‰ç…§é€’å¢æ’åºçš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">merge</span><span class="params">(ListNode n1, ListNode n2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n1 == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> n2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n2 == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> n1;</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode mergeNode = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (n1.val &lt; n2.val) &#123;</span><br><span class="line">        mergeNode = n1;</span><br><span class="line">        mergeNode.next = merge(n1.next, n2);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        mergeNode = n2;</span><br><span class="line">        mergeNode.next = merge(n1, n2.next);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mergeNode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Problem16ï¼šæ ‘çš„å­ç»“æ„åˆ¤æ–­"><a href="#Problem16ï¼šæ ‘çš„å­ç»“æ„åˆ¤æ–­" class="headerlink" title="Problem16ï¼šæ ‘çš„å­ç»“æ„åˆ¤æ–­"></a>Problem16ï¼šæ ‘çš„å­ç»“æ„åˆ¤æ–­</h3><h3 id="Problem17ï¼šäºŒå‰æ ‘çš„é•œåƒ"><a href="#Problem17ï¼šäºŒå‰æ ‘çš„é•œåƒ" class="headerlink" title="Problem17ï¼šäºŒå‰æ ‘çš„é•œåƒ"></a>Problem17ï¼šäºŒå‰æ ‘çš„é•œåƒ</h3><h3 id="Problem18ï¼šé¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ"><a href="#Problem18ï¼šé¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ" class="headerlink" title="Problem18ï¼šé¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ"></a>Problem18ï¼šé¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ</h3><h3 id="Problem19ï¼šåŒ…å«minå‡½æ•°çš„æ ˆ"><a href="#Problem19ï¼šåŒ…å«minå‡½æ•°çš„æ ˆ" class="headerlink" title="Problem19ï¼šåŒ…å«minå‡½æ•°çš„æ ˆ"></a>Problem19ï¼šåŒ…å«minå‡½æ•°çš„æ ˆ</h3><h3 id="Problem20ï¼šæ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ—"><a href="#Problem20ï¼šæ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ—" class="headerlink" title="Problem20ï¼šæ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ—"></a>Problem20ï¼šæ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ—</h3><h3 id="Problem21ï¼šä»ä¸Šå¾€ä¸‹æ‰“å°äºŒå‰æ ‘"><a href="#Problem21ï¼šä»ä¸Šå¾€ä¸‹æ‰“å°äºŒå‰æ ‘" class="headerlink" title="Problem21ï¼šä»ä¸Šå¾€ä¸‹æ‰“å°äºŒå‰æ ‘"></a>Problem21ï¼šä»ä¸Šå¾€ä¸‹æ‰“å°äºŒå‰æ ‘</h3><h3 id="Problem22ï¼šäºŒå‰æœç´¢æ ‘çš„ååºéå†"><a href="#Problem22ï¼šäºŒå‰æœç´¢æ ‘çš„ååºéå†" class="headerlink" title="Problem22ï¼šäºŒå‰æœç´¢æ ‘çš„ååºéå†"></a>Problem22ï¼šäºŒå‰æœç´¢æ ‘çš„ååºéå†</h3><h3 id="Problem23ï¼šäºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„"><a href="#Problem23ï¼šäºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„" class="headerlink" title="Problem23ï¼šäºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„"></a>Problem23ï¼šäºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„</h3><h3 id="Problem24ï¼šå­—ç¬¦ä¸²çš„æ’åˆ—"><a href="#Problem24ï¼šå­—ç¬¦ä¸²çš„æ’åˆ—" class="headerlink" title="Problem24ï¼šå­—ç¬¦ä¸²çš„æ’åˆ—"></a>Problem24ï¼šå­—ç¬¦ä¸²çš„æ’åˆ—</h3><h3 id="Problem25ï¼šæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ•°å­—"><a href="#Problem25ï¼šæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ•°å­—" class="headerlink" title="Problem25ï¼šæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ•°å­—"></a>Problem25ï¼šæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ•°å­—</h3><h3 id="Problem26ï¼šè¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ"><a href="#Problem26ï¼šè¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ" class="headerlink" title="Problem26ï¼šè¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ"></a>Problem26ï¼šè¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ</h3><h3 id="Problem27ï¼šæ•´æ•°ä¸­1å‡ºç°çš„æ¬¡æ•°"><a href="#Problem27ï¼šæ•´æ•°ä¸­1å‡ºç°çš„æ¬¡æ•°" class="headerlink" title="Problem27ï¼šæ•´æ•°ä¸­1å‡ºç°çš„æ¬¡æ•°"></a>Problem27ï¼šæ•´æ•°ä¸­1å‡ºç°çš„æ¬¡æ•°</h3><h3 id="Problem28ï¼šæŠŠæ•°ç»„æ’æˆæœ€å°çš„æ•°"><a href="#Problem28ï¼šæŠŠæ•°ç»„æ’æˆæœ€å°çš„æ•°" class="headerlink" title="Problem28ï¼šæŠŠæ•°ç»„æ’æˆæœ€å°çš„æ•°"></a>Problem28ï¼šæŠŠæ•°ç»„æ’æˆæœ€å°çš„æ•°</h3><h3 id="Problem29ï¼šä¸‘æ•°"><a href="#Problem29ï¼šä¸‘æ•°" class="headerlink" title="Problem29ï¼šä¸‘æ•°"></a>Problem29ï¼šä¸‘æ•°</h3><h3 id="Problem30ï¼šç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦"><a href="#Problem30ï¼šç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦" class="headerlink" title="Problem30ï¼šç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦"></a>Problem30ï¼šç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦</h3><h3 id="Problem31ï¼šæ•°ç»„ä¸­çš„é€†åºå¯¹"><a href="#Problem31ï¼šæ•°ç»„ä¸­çš„é€†åºå¯¹" class="headerlink" title="Problem31ï¼šæ•°ç»„ä¸­çš„é€†åºå¯¹"></a>Problem31ï¼šæ•°ç»„ä¸­çš„é€†åºå¯¹</h3><h3 id="Problem32ï¼šä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹"><a href="#Problem32ï¼šä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹" class="headerlink" title="Problem32ï¼šä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹"></a>Problem32ï¼šä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹</h3><h3 id="Problem33ï¼šäºŒå‰æ ‘çš„æ·±åº¦-amp-amp-å¹³è¡¡äºŒå‰æ ‘åˆ¤æ–­"><a href="#Problem33ï¼šäºŒå‰æ ‘çš„æ·±åº¦-amp-amp-å¹³è¡¡äºŒå‰æ ‘åˆ¤æ–­" class="headerlink" title="Problem33ï¼šäºŒå‰æ ‘çš„æ·±åº¦&amp;&amp;å¹³è¡¡äºŒå‰æ ‘åˆ¤æ–­"></a>Problem33ï¼šäºŒå‰æ ‘çš„æ·±åº¦&amp;&amp;å¹³è¡¡äºŒå‰æ ‘åˆ¤æ–­</h3><h3 id="Problem34ï¼šæ•°å­—åœ¨æ’åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°"><a href="#Problem34ï¼šæ•°å­—åœ¨æ’åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°" class="headerlink" title="Problem34ï¼šæ•°å­—åœ¨æ’åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°"></a>Problem34ï¼šæ•°å­—åœ¨æ’åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°</h3><h3 id="Problem35ï¼šæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—"><a href="#Problem35ï¼šæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—" class="headerlink" title="Problem35ï¼šæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—"></a>Problem35ï¼šæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—</h3><h3 id="Problem36ï¼šå’Œä¸ºSçš„ä¸¤ä¸ªæ•°å­—"><a href="#Problem36ï¼šå’Œä¸ºSçš„ä¸¤ä¸ªæ•°å­—" class="headerlink" title="Problem36ï¼šå’Œä¸ºSçš„ä¸¤ä¸ªæ•°å­—"></a>Problem36ï¼šå’Œä¸ºSçš„ä¸¤ä¸ªæ•°å­—</h3><h3 id="Problem37ï¼šå’Œä¸ºSçš„è¿ç»­æ­£æ•°åºåˆ—"><a href="#Problem37ï¼šå’Œä¸ºSçš„è¿ç»­æ­£æ•°åºåˆ—" class="headerlink" title="Problem37ï¼šå’Œä¸ºSçš„è¿ç»­æ­£æ•°åºåˆ—"></a>Problem37ï¼šå’Œä¸ºSçš„è¿ç»­æ­£æ•°åºåˆ—</h3><h3 id="Problem38ï¼šç¿»è½¬å•è¯çš„é¡ºåº"><a href="#Problem38ï¼šç¿»è½¬å•è¯çš„é¡ºåº" class="headerlink" title="Problem38ï¼šç¿»è½¬å•è¯çš„é¡ºåº"></a>Problem38ï¼šç¿»è½¬å•è¯çš„é¡ºåº</h3><h3 id="Problem39ï¼šæ‰‘å…‹ç‰Œçš„é¡ºå­"><a href="#Problem39ï¼šæ‰‘å…‹ç‰Œçš„é¡ºå­" class="headerlink" title="Problem39ï¼šæ‰‘å…‹ç‰Œçš„é¡ºå­"></a>Problem39ï¼šæ‰‘å…‹ç‰Œçš„é¡ºå­</h3><h3 id="Problem40ï¼šyåœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰"><a href="#Problem40ï¼šyåœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰" class="headerlink" title="Problem40ï¼šyåœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰"></a>Problem40ï¼šyåœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰</h3><h3 id="Problem41ï¼šè®¡ç®—1-2-3-Â·Â·Â·-n"><a href="#Problem41ï¼šè®¡ç®—1-2-3-Â·Â·Â·-n" class="headerlink" title="Problem41ï¼šè®¡ç®—1+2+3+ Â·Â·Â· + n"></a>Problem41ï¼šè®¡ç®—1+2+3+ Â·Â·Â· + n</h3><h3 id="Problem42ï¼šä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³•"><a href="#Problem42ï¼šä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³•" class="headerlink" title="Problem42ï¼šä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³•"></a>Problem42ï¼šä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³•</h3><h3 id="Problem43ï¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°"><a href="#Problem43ï¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°" class="headerlink" title="Problem43ï¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°"></a>Problem43ï¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°</h3><h3 id="Problem44ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"><a href="#Problem44ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—" class="headerlink" title="Problem44ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—"></a>Problem44ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—</h3><h3 id="Problem45ï¼šæ„å»ºä¹˜ç§¯æ•°ç»„"><a href="#Problem45ï¼šæ„å»ºä¹˜ç§¯æ•°ç»„" class="headerlink" title="Problem45ï¼šæ„å»ºä¹˜ç§¯æ•°ç»„"></a>Problem45ï¼šæ„å»ºä¹˜ç§¯æ•°ç»„</h3><h3 id="Problem46ï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"><a href="#Problem46ï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…" class="headerlink" title="Problem46ï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"></a>Problem46ï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</h3><h3 id="Problem47ï¼šè¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²"><a href="#Problem47ï¼šè¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²" class="headerlink" title="Problem47ï¼šè¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²"></a>Problem47ï¼šè¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²</h3><h3 id="Problem48ï¼šå­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦"><a href="#Problem48ï¼šå­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦" class="headerlink" title="Problem48ï¼šå­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦"></a>Problem48ï¼šå­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªä¸é‡å¤çš„å­—ç¬¦</h3><h3 id="Problem49ï¼šé“¾è¡¨ä¸­ç¯çš„å…¥å£ç»“ç‚¹"><a href="#Problem49ï¼šé“¾è¡¨ä¸­ç¯çš„å…¥å£ç»“ç‚¹" class="headerlink" title="Problem49ï¼šé“¾è¡¨ä¸­ç¯çš„å…¥å£ç»“ç‚¹"></a>Problem49ï¼šé“¾è¡¨ä¸­ç¯çš„å…¥å£ç»“ç‚¹</h3><h3 id="Problem50ï¼šåˆ é™¤é“¾è¡¨ä¸­æ¬§å† é‡å¤çš„èŠ‚ç‚¹"><a href="#Problem50ï¼šåˆ é™¤é“¾è¡¨ä¸­æ¬§å† é‡å¤çš„èŠ‚ç‚¹" class="headerlink" title="Problem50ï¼šåˆ é™¤é“¾è¡¨ä¸­æ¬§å† é‡å¤çš„èŠ‚ç‚¹"></a>Problem50ï¼šåˆ é™¤é“¾è¡¨ä¸­æ¬§å† é‡å¤çš„èŠ‚ç‚¹</h3><h3 id="Problem51ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹"><a href="#Problem51ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹" class="headerlink" title="Problem51ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹"></a>Problem51ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</h3><h3 id="Problem52ï¼šæŠŠäºŒå‰æ ‘æ‰“å°æˆå¤šè¡Œ"><a href="#Problem52ï¼šæŠŠäºŒå‰æ ‘æ‰“å°æˆå¤šè¡Œ" class="headerlink" title="Problem52ï¼šæŠŠäºŒå‰æ ‘æ‰“å°æˆå¤šè¡Œ"></a>Problem52ï¼šæŠŠäºŒå‰æ ‘æ‰“å°æˆå¤šè¡Œ</h3><h3 id="Problem53ï¼šæŒ‰ä¹‹å­—å½¢é¡ºåºæ‰“å°äºŒå‰æ ‘"><a href="#Problem53ï¼šæŒ‰ä¹‹å­—å½¢é¡ºåºæ‰“å°äºŒå‰æ ‘" class="headerlink" title="Problem53ï¼šæŒ‰ä¹‹å­—å½¢é¡ºåºæ‰“å°äºŒå‰æ ‘"></a>Problem53ï¼šæŒ‰ä¹‹å­—å½¢é¡ºåºæ‰“å°äºŒå‰æ ‘</h3><h3 id="Problem54ï¼šåºåˆ—åŒ–äºŒå‰æ ‘"><a href="#Problem54ï¼šåºåˆ—åŒ–äºŒå‰æ ‘" class="headerlink" title="Problem54ï¼šåºåˆ—åŒ–äºŒå‰æ ‘"></a>Problem54ï¼šåºåˆ—åŒ–äºŒå‰æ ‘</h3><h3 id="Problem55ï¼šäºŒå‰æœç´¢æ ‘çš„ç¬¬Kä¸ªèŠ‚ç‚¹"><a href="#Problem55ï¼šäºŒå‰æœç´¢æ ‘çš„ç¬¬Kä¸ªèŠ‚ç‚¹" class="headerlink" title="Problem55ï¼šäºŒå‰æœç´¢æ ‘çš„ç¬¬Kä¸ªèŠ‚ç‚¹"></a>Problem55ï¼šäºŒå‰æœç´¢æ ‘çš„ç¬¬Kä¸ªèŠ‚ç‚¹</h3><h3 id="Problem56ï¼šæ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼å¤§å€¼"><a href="#Problem56ï¼šæ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼å¤§å€¼" class="headerlink" title="Problem56ï¼šæ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼å¤§å€¼"></a>Problem56ï¼šæ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼å¤§å€¼</h3>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°&quot;&gt;&lt;a href=&quot;#Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°&quot; class=&quot;headerlink&quot; title=&quot;Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°&quot;&gt;&lt;/a&gt;Problem1ï¼šå•ä¾‹æ¨¡å¼å®ç°&lt;/h3&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Singleton&lt;/span&gt; &lt;/span&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;volatile&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; Singleton singleton;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Singleton&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;&amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; Singleton &lt;span class=&quot;title&quot;&gt;getSingleton&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (singleton == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (Singleton.class) &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (singleton == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    singleton = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Singleton();  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; singleton;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://yoursite.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="ç®—æ³•" scheme="http://yoursite.com/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Android å¤šçº¿ç¨‹æŠ€æœ¯</title>
    <link href="http://yoursite.com/Android-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%8A%80%E6%9C%AF/"/>
    <id>http://yoursite.com/Android-å¤šçº¿ç¨‹æŠ€æœ¯/</id>
    <published>2019-03-17T03:56:59.000Z</published>
    <updated>2019-03-17T04:43:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¤šçº¿ç¨‹æŠ€æœ¯ä¸€ç›´æ˜¯è½¯ä»¶å¼€å‘ä¸­çš„é‡ç‚¹ï¼Œæœ¬æ–‡å°†ä»‹ç» Java ä¸­çš„çº¿ç¨‹å’Œçº¿ç¨‹æ± ä½¿ç”¨ï¼Œç„¶åå†è¯¦ç»†åˆ†æ Android ä¸­çš„å¤šçº¿ç¨‹æœºåˆ¶ï¼ŒåŒ…æ‹¬ AsyncTaskã€IntentService ä»¥åŠ HandlerThread ç­‰ç­‰ã€‚<a id="more"></a> </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¤šçº¿ç¨‹æŠ€æœ¯ä¸€ç›´æ˜¯è½¯ä»¶å¼€å‘ä¸­çš„é‡ç‚¹ï¼Œæœ¬æ–‡å°†ä»‹ç» Java ä¸­çš„çº¿ç¨‹å’Œçº¿ç¨‹æ± ä½¿ç”¨ï¼Œç„¶åå†è¯¦ç»†åˆ†æ Android ä¸­çš„å¤šçº¿ç¨‹æœºåˆ¶ï¼ŒåŒ…æ‹¬ AsyncTaskã€IntentService ä»¥åŠ HandlerThread ç­‰ç­‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="å¤šçº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Android LruCache ç¼“å­˜è¯¦è§£</title>
    <link href="http://yoursite.com/Android-LruCache-%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3/"/>
    <id>http://yoursite.com/Android-LruCache-ç¼“å­˜è¯¦è§£/</id>
    <published>2019-03-17T02:49:27.000Z</published>
    <updated>2019-03-17T03:43:32.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3392635-584d9b129fd4132c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" alt=""><br><a id="more"></a></p><h2 id="Android-ç¼“å­˜ç­–ç•¥"><a href="#Android-ç¼“å­˜ç­–ç•¥" class="headerlink" title="Android ç¼“å­˜ç­–ç•¥"></a>Android ç¼“å­˜ç­–ç•¥</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜ç­–ç•¥ä¸»è¦åŒ…å«ç¼“å­˜çš„æ·»åŠ ã€è·å–å’Œåˆ é™¤ã€‚å¦‚ä½•æ·»åŠ å’Œè·å–ç¼“å­˜è¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦åˆ é™¤ç¼“å­˜å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºä¸ç®¡æ˜¯å†…å­˜ç¼“å­˜è¿˜æ˜¯ç¡¬ç›˜ç¼“å­˜ï¼Œå®ƒä»¬çš„ç¼“å­˜å¤§å°éƒ½æ˜¯æœ‰é™çš„ã€‚å½“ç¼“å­˜æ»¡äº†ä¹‹åï¼Œå†å‘å…¶æ·»åŠ ç¼“å­˜ï¼Œå°±éœ€è¦å…ˆåˆ é™¤æ—§çš„ç¼“å­˜ã€‚å› æ­¤ LRU ç¼“å­˜ç®—æ³•åº”è¿è€Œç”Ÿã€‚</p><p>LRUï¼ˆLeast Recently Usedï¼‰ï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯å½“ç¼“å­˜æ»¡æ—¶ï¼Œä¼˜å…ˆæ·˜æ±°é‚£äº›è¿‘æœŸæœ€å°‘ä½¿ç”¨çš„ç¼“å­˜å¯¹è±¡ï¼Œæœ‰æ•ˆçš„é¿å…äº† OOM çš„å‡ºç°ã€‚Android ä¸­é‡‡ç”¨ LRU ç®—æ³•çš„å¸¸ç”¨ç¼“å­˜æœ‰ä¸¤ç§ï¼šLruCache å’Œ DisLruCacheï¼Œåˆ†åˆ«ç”¨äºå®ç°å†…å­˜ç¼“å­˜å’Œç¡¬ç›˜ç¼“å­˜ã€‚</p><p>LRU ç¼“å­˜çš„å®ç°ç±»ä¼¼äºä¸€ä¸ªç‰¹æ®Šçš„æ ˆï¼ŒæŠŠè®¿é—®è¿‡çš„å…ƒç´ æ”¾ç½®åˆ°æ ˆé¡¶ï¼ˆè‹¥æ ˆä¸­å­˜åœ¨ï¼Œåˆ™æ›´æ–°è‡³æ ˆé¡¶ï¼›è‹¥æ ˆä¸­ä¸å­˜åœ¨åˆ™ç›´æ¥å…¥æ ˆï¼‰ï¼Œç„¶åå¦‚æœæ ˆä¸­å…ƒç´ æ•°é‡è¶…è¿‡é™å®šå€¼ï¼Œåˆ™åˆ é™¤æ ˆåº•å…ƒç´ ï¼ˆå³æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å…ƒç´ ï¼‰ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/3392635-bb6c6461e8d01701.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/291/format/webp" alt=""></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>LruCache æ˜¯Android 3.1æ‰€æä¾›çš„ä¸€ä¸ªç¼“å­˜ç±»ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚è€Œ  DisLruCache  ç›®å‰è¿˜ä¸æ˜¯ Android SDKçš„ä¸€éƒ¨åˆ†ï¼Œä½† Android å®˜æ–¹æ–‡æ¡£æ¨èä½¿ç”¨è¯¥ç®—æ³•æ¥å®ç°ç¡¬ç›˜ç¼“å­˜ã€‚</p><p>è®²åˆ° LruCache ä¸å¾—ä¸æä¸€ä¸‹ LinkedHashMapï¼Œå› ä¸º LruCache ä¸­ Lru ç®—æ³•å°±æ˜¯é€šè¿‡ LinkedHashMap æ¥å®ç°çš„ã€‚</p><p>LinkedHashMap ç»§æ‰¿äº HashMapï¼Œä½¿ç”¨äº†ä¸€ä¸ªåŒå‘é“¾è¡¨æ¥å­˜å‚¨ Map ä¸­çš„ Entry é¡ºåºå…³ç³»ï¼Œè¿™ç§é¡ºåºæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ LRU é¡ºåºï¼Œä¸€ç§æ˜¯æ’å…¥é¡ºåºï¼Œç”±å…¶æ„é€ å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity,<span class="keyword">float</span> loadFactor, <span class="keyword">boolean</span> accessOrder)</span></span></span><br></pre></td></tr></table></figure><p>ä¸­çš„æœ€åä¸€ä¸ªå‚æ•° accessOrder æ¥æŒ‡å®šã€‚</p><p>å¯¹äº<code>get</code>ã€<code>put</code>ã€<code>remove</code>ç­‰æ“ä½œï¼ŒLinkedHashMap é™¤äº†è¦åš HashMap åšçš„äº‹æƒ…ï¼Œè¿˜ä¼šåšäº›è°ƒæ•´ Entry é¡ºåºé“¾è¡¨çš„å·¥ä½œã€‚LruCache ä¸­å°† LinkedHashMap çš„é¡ºåºè®¾ç½®ä¸º LRU é¡ºåºæ¥å®ç° LRU ç¼“å­˜ï¼Œæ¯æ¬¡è°ƒç”¨ <code>get</code>(ä¹Ÿå°±æ˜¯ä»å†…å­˜ç¼“å­˜ä¸­å–å›¾ç‰‡)ï¼Œåˆ™å°†è¯¥å¯¹è±¡ç§»åˆ°é“¾è¡¨çš„å°¾ç«¯ã€‚è°ƒç”¨<code>put</code> æ’å…¥æ–°çš„å¯¹è±¡ï¼Œåˆ™å­˜å‚¨åœ¨é“¾è¡¨å°¾ç«¯ï¼Œè¿™æ ·å½“å†…å­˜ç¼“å­˜è¾¾åˆ°è®¾å®šçš„æœ€å¤§å€¼æ—¶ï¼Œå°†é“¾è¡¨å¤´éƒ¨çš„å¯¹è±¡ï¼ˆè¿‘æœŸæœ€å°‘ç”¨åˆ°çš„ï¼‰ç§»é™¤ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/3392635-af28ceea733149ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/650/format/webp" alt=""></p><p>LruCache çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œä»¥å›¾ç‰‡ç¼“å­˜ä¸ºä¾‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> maxMemory = (<span class="keyword">int</span>) (Runtime.getRuntime().totalMemory()/<span class="number">1024</span>);</span><br><span class="line"><span class="keyword">int</span> cacheSize = maxMemory/<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">mMemoryCache = <span class="keyword">new</span> LruCache&lt;String, Bitmap&gt;(cacheSize) &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">sizeOf</span><span class="params">(String key, Bitmap value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.getRowBytes() * value.getHeight() / <span class="number">1024</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><ol><li>è®¾ç½®LruCacheç¼“å­˜çš„å¤§å°ï¼Œä¸€èˆ¬ä¸ºå½“å‰è¿›ç¨‹å¯ç”¨å®¹é‡çš„1/8ã€‚</li><li>é‡å†™sizeOfæ–¹æ³•ï¼Œè®¡ç®—å‡ºè¦ç¼“å­˜çš„æ¯å¼ å›¾ç‰‡çš„å¤§å°ã€‚</li></ol><p>æ³¨æ„ï¼šç¼“å­˜çš„æ€»å®¹é‡å’Œæ¯ä¸ªç¼“å­˜å¯¹è±¡çš„å¤§å°æ‰€ç”¨å•ä½è¦ä¸€è‡´ã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>LruCache çš„æ ¸å¿ƒæ€æƒ³å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯è¦ç»´æŠ¤ä¸€ä¸ªç¼“å­˜å¯¹è±¡åˆ—è¡¨ï¼Œå…¶ä¸­å¯¹è±¡åˆ—è¡¨çš„æ’åˆ—æ–¹å¼æ˜¯æŒ‰ç…§è®¿é—®é¡ºåºå®ç°çš„ï¼Œå³ä¸€ç›´æ²¡è®¿é—®çš„å¯¹è±¡ä¼šæ”¾åœ¨é˜Ÿå°¾ï¼Œå³å°†è¢«æ·˜æ±°ã€‚è€Œæœ€è¿‘è®¿é—®çš„å¯¹è±¡ä¼šæ”¾åœ¨é˜Ÿå¤´ï¼Œæœ€åè¢«æ·˜æ±°ã€‚<br>è¿™ä¸ªé˜Ÿåˆ—ç”± LinkedHashMap æ¥ç»´æŠ¤ã€‚LinkedHashMap ç”±æ•°ç»„+åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„å®ç°ï¼Œå…¶ä¸­åŒå‘é“¾è¡¨çš„ç»“æ„å¯ä»¥å®ç°è®¿é—®é¡ºåºå’Œæ’å…¥é¡ºåºï¼Œä½¿å¾— LinkedHashMap ä¸­çš„<code>&lt;key,value&gt;</code>å¯¹æŒ‰ç…§ä¸€å®šé¡ºåºæ’åˆ—èµ·æ¥ã€‚</p><p>é€šè¿‡ä¸‹é¢çš„æ„é€ å‡½æ•°æ¥æŒ‡å®š LinkedHashMap ä¸­åŒå‘é“¾è¡¨çš„ç»“æ„æ˜¯è®¿é—®é¡ºåºè¿˜æ˜¯æ’å…¥é¡ºåºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor, <span class="keyword">boolean</span> accessOrder)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(initialCapacity, loadFactor);</span><br><span class="line">    <span class="keyword">this</span>.accessOrder = accessOrder;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>accessOrder è®¾ç½®ä¸º true åˆ™ä¸ºè®¿é—®é¡ºåºï¼›ä¸º falseï¼Œåˆ™ä¸ºæ’å…¥é¡ºåºã€‚</p><p>ä»¥å…·ä½“ä¾‹å­è§£é‡Šï¼Œå½“è®¾ç½®ä¸ºtrueæ—¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    LinkedHashMap&lt;Integer, Integer&gt; map = <span class="keyword">new</span> LinkedHashMap&lt;&gt;(<span class="number">0</span>, <span class="number">0.75f</span>, <span class="keyword">true</span>);</span><br><span class="line">    map.put(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    map.put(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    map.put(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">    map.put(<span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">    map.put(<span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">    map.put(<span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line">    map.put(<span class="number">6</span>, <span class="number">6</span>);</span><br><span class="line">    map.get(<span class="number">1</span>);</span><br><span class="line">    map.get(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123;</span><br><span class="line">        System.out.println(entry.getKey() + <span class="string">":"</span> + entry.getValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸º:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">0</span></span><br><span class="line"><span class="number">3</span>:<span class="number">3</span></span><br><span class="line"><span class="number">4</span>:<span class="number">4</span></span><br><span class="line"><span class="number">5</span>:<span class="number">5</span></span><br><span class="line"><span class="number">6</span>:<span class="number">6</span></span><br><span class="line"><span class="number">1</span>:<span class="number">1</span></span><br><span class="line"><span class="number">2</span>:<span class="number">2</span></span><br></pre></td></tr></table></figure></p><p>å³æœ€è¿‘è®¿é—®çš„æœ€åè¾“å‡ºï¼Œæ­£å¥½æ»¡è¶³ LRU ç¼“å­˜ç®—æ³•çš„æ€æƒ³ã€‚å¯è§ LruCache çš„å·§å¦™å®ç°ï¼Œå°±æ˜¯åˆ©ç”¨äº†LinkedHashMap çš„è¿™ç§æ•°æ®ç»“æ„ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬åœ¨ LruCache æºç ä¸­å…·ä½“çœ‹çœ‹ï¼Œæ€æ ·åº”ç”¨ LinkedHashMap æ¥å®ç°ç¼“å­˜çš„æ·»åŠ ï¼Œè·å¾—å’Œåˆ é™¤</p><p>æ„é€ æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public LruCache(int maxSize) &#123;</span><br><span class="line">    if (maxSize &lt;= 0) &#123;</span><br><span class="line">        throw new IllegalArgumentException(&quot;maxSize &lt;= 0&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    this.maxSize = maxSize;</span><br><span class="line">    this.map = new LinkedHashMap&lt;K, V&gt;(0, 0.75f, true);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>put</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (key == <span class="keyword">null</span> || value == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"key == null || value == null"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    V previous;</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="comment">//æ’å…¥çš„ç¼“å­˜å¯¹è±¡å€¼åŠ 1</span></span><br><span class="line">        putCount++;</span><br><span class="line">        <span class="comment">//å¢åŠ å·²æœ‰ç¼“å­˜çš„å¤§å°</span></span><br><span class="line">        size += safeSizeOf(key, value);</span><br><span class="line">        <span class="comment">//å‘mapä¸­åŠ å…¥ç¼“å­˜å¯¹è±¡</span></span><br><span class="line">        previous = map.put(key, value);</span><br><span class="line">        <span class="comment">//å¦‚æœå·²æœ‰ç¼“å­˜å¯¹è±¡ï¼Œåˆ™ç¼“å­˜å¤§å°æ¢å¤åˆ°ä¹‹å‰</span></span><br><span class="line">        <span class="keyword">if</span> (previous != <span class="keyword">null</span>) &#123;</span><br><span class="line">            size -= safeSizeOf(key, previous);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//entryRemoved()æ˜¯ä¸ªç©ºæ–¹æ³•ï¼Œå¯ä»¥è‡ªè¡Œå®ç°</span></span><br><span class="line">    <span class="keyword">if</span> (previous != <span class="keyword">null</span>) &#123;</span><br><span class="line">        entryRemoved(<span class="keyword">false</span>, key, previous, value);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è°ƒæ•´ç¼“å­˜å¤§å°(å…³é”®æ–¹æ³•)</span></span><br><span class="line">    trimToSize(maxSize);</span><br><span class="line">    <span class="keyword">return</span> previous;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæ·»åŠ è¿‡ç¼“å­˜å¯¹è±¡åä¼šè°ƒç”¨<code>trimToSize</code>æ–¹æ³•ï¼Œæ¥åˆ¤æ–­ç¼“å­˜æ˜¯å¦å·²æ»¡ï¼Œå¦‚æœæ»¡äº†å°±åˆ é™¤è¿‘æœŸæœ€å°‘ä½¿ç”¨çš„å¯¹è±¡</p><p><code>trimToSize</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">trimToSize</span><span class="params">(<span class="keyword">int</span> maxSize)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ­»å¾ªç¯</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">        K key;</span><br><span class="line">        V value;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (size &lt; <span class="number">0</span> || (map.isEmpty() &amp;&amp; size != <span class="number">0</span>)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(getClass().getName()</span><br><span class="line">                        + <span class="string">".sizeOf() is reporting inconsistent results!"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//å¦‚æœç¼“å­˜å¤§å°sizeå°äºæœ€å¤§ç¼“å­˜ï¼Œæˆ–è€…mapä¸ºç©ºï¼Œä¸éœ€è¦å†åˆ é™¤ç¼“å­˜å¯¹è±¡ï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">if</span> (size &lt;= maxSize || map.isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//è¿­ä»£å™¨è·å–ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼Œå³é˜Ÿå°¾çš„å…ƒç´ ï¼Œè¿‘æœŸæœ€å°‘è®¿é—®çš„å…ƒç´ </span></span><br><span class="line">            Map.Entry&lt;K, V&gt; toEvict = map.entrySet().iterator().next();</span><br><span class="line">            key = toEvict.getKey();</span><br><span class="line">            value = toEvict.getValue();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//åˆ é™¤è¯¥å¯¹è±¡ï¼Œå¹¶æ›´æ–°ç¼“å­˜å¤§å°</span></span><br><span class="line">            map.remove(key);</span><br><span class="line">            size -= safeSizeOf(key, value);</span><br><span class="line">            evictionCount++;</span><br><span class="line">        &#125;</span><br><span class="line">        entryRemoved(<span class="keyword">true</span>, key, value, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸æ–­åœ°åˆ é™¤ LinkedHashMap ä¸­é˜Ÿå°¾çš„å…ƒç´ ï¼Œç›´åˆ°ç¼“å­˜å¤§å°å°äºæœ€å¤§å€¼ã€‚</p><p>å½“è°ƒç”¨ LruCache çš„<code>get</code>æ–¹æ³•è·å–é›†åˆä¸­çš„ç¼“å­˜å¯¹è±¡æ—¶ï¼Œå°±ä»£è¡¨è®¿é—®äº†ä¸€æ¬¡è¯¥å…ƒç´ ï¼Œé˜Ÿåˆ—å°†ä¼šæ›´æ–°ï¼Œä¿æŒå…¶æŒ‰ç…§è®¿é—®é¡ºåºçš„æ’åºçš„è§„åˆ™ã€‚è¿™ä¸ªæ›´æ–°è¿‡ç¨‹æ˜¯åœ¨ LinkedHashMap ä¸­çš„<code>get</code>æ–¹æ³•ä¸­å®Œæˆçš„ã€‚</p><p>å…ˆçœ‹ LruCache çš„<code>get</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">get</span><span class="params">(K key)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//keyä¸ºç©ºæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (key == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"key == null"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    V mapValue;</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">    <span class="comment">//è·å–å¯¹åº”çš„ç¼“å­˜å¯¹è±¡</span></span><br><span class="line">    <span class="comment">//get()æ–¹æ³•ä¼šå®ç°å°†è®¿é—®çš„å…ƒç´ æ›´æ–°åˆ°é˜Ÿåˆ—å¤´éƒ¨çš„åŠŸèƒ½</span></span><br><span class="line">    mapValue = map.get(key);</span><br><span class="line">        <span class="keyword">if</span> (mapValue != <span class="keyword">null</span>) &#123;</span><br><span class="line">            hitCount++;</span><br><span class="line">            <span class="keyword">return</span> mapValue;</span><br><span class="line">        &#125;</span><br><span class="line">        missCount++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>LinkedHashMap çš„<code>get</code>æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    LinkedHashMapEntry&lt;K,V&gt; e = (LinkedHashMapEntry&lt;K,V&gt;)getEntry(key);</span><br><span class="line">    <span class="keyword">if</span> (e == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//å®ç°æ’åºçš„å…³é”®æ–¹æ³•</span></span><br><span class="line">    e.recordAccess(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">return</span> e.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">recordAccess</span><span class="params">(HashMap&lt;K,V&gt; m)</span> </span>&#123;</span><br><span class="line">    LinkedHashMap&lt;K,V&gt; lm = (LinkedHashMap&lt;K,V&gt;)m;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ˜¯å¦æ˜¯è®¿é—®æ’åº</span></span><br><span class="line">    <span class="keyword">if</span> (lm.accessOrder) &#123;</span><br><span class="line">        lm.modCount++;</span><br><span class="line">        <span class="comment">//åˆ é™¤æ­¤å…ƒç´ </span></span><br><span class="line">        remove();</span><br><span class="line">        <span class="comment">//å°†æ­¤å…ƒç´ ç§»åŠ¨åˆ°é˜Ÿåˆ—çš„å¤´éƒ¨</span></span><br><span class="line">        addBefore(lm.header);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç”±æ­¤å¯è§ LruCache ä¸­ç»´æŠ¤äº†ä¸€ä¸ªé›†åˆ LinkedHashMapï¼Œè¯¥ LinkedHashMap æ˜¯ä»¥è®¿é—®é¡ºåºæ’åºçš„ã€‚å½“è°ƒç”¨<code>put</code>æ–¹æ³•æ—¶ï¼Œå°±ä¼šåœ¨é˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´ ï¼Œå¹¶è°ƒç”¨<code>trimToSize</code>åˆ¤æ–­ç¼“å­˜æ˜¯å¦å·²æ»¡ï¼Œå¦‚æœæ»¡äº†å°±ç”¨ LinkedHashMap çš„è¿­ä»£å™¨åˆ é™¤é˜Ÿå°¾å…ƒç´ ï¼Œå³è¿‘æœŸæœ€å°‘è®¿é—®çš„å…ƒç´ ã€‚å½“è°ƒç”¨<code>get(</code>æ–¹æ³•è®¿é—®ç¼“å­˜å¯¹è±¡æ—¶ï¼Œå°±ä¼šè°ƒç”¨ LinkedHashMap çš„<code>get</code>æ–¹æ³•è·å¾—å¯¹åº”é›†åˆå…ƒç´ ï¼ŒåŒæ—¶æ›´æ–°è¯¥å…ƒç´ åˆ°é˜Ÿå¤´ã€‚</strong></p><p>ä»¥ä¸Šä¾¿æ˜¯ LruCache å®ç°çš„åŸç†ï¼Œç†è§£äº† LinkedHashMap çš„æ•°æ®ç»“æ„å°±èƒ½ç†è§£æ•´ä¸ªåŸç†ã€‚</p><p>æœ¬æ–‡è½¬è‡ª <a href="https://www.jianshu.com/p/b49a111147ee" target="_blank" rel="noopener">å½»åº•è§£æAndroidç¼“å­˜æœºåˆ¶â€”â€”LruCache</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3392635-584d9b129fd4132c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="LRU" scheme="http://yoursite.com/tags/LRU/"/>
    
      <category term="ç¼“å­˜" scheme="http://yoursite.com/tags/%E7%BC%93%E5%AD%98/"/>
    
  </entry>
  
  <entry>
    <title>Java åå°„è¯¦è§£</title>
    <link href="http://yoursite.com/Java-%E5%8F%8D%E5%B0%84%E8%AF%A6%E8%A7%A3/"/>
    <id>http://yoursite.com/Java-åå°„è¯¦è§£/</id>
    <published>2019-03-16T15:25:47.000Z</published>
    <updated>2019-03-17T02:47:56.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>åå°„æ˜¯ä¸€ç§è®¡ç®—æœºå¤„ç†æ–¹å¼ï¼Œæ˜¯ç¨‹åºå¯ä»¥è®¿é—®ã€æ£€æµ‹å’Œä¿®æ”¹å®ƒæœ¬èº«çŠ¶æ€æˆ–è¡Œä¸ºçš„ä¸€ç§èƒ½åŠ›ã€‚Java åå°„ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åŠ è½½ä¸€ä¸ªç±»ï¼ŒåŠ¨æ€è·å–ç±»çš„å±æ€§ã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ä¿¡æ¯ã€‚åå°„ä½¿ Java è¿™ä¸€é™æ€è¯­è¨€æœ‰äº†åŠ¨æ€çš„ç‰¹æ€§ã€‚<a id="more"></a></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Apple</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Apple</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, </span></span><br><span class="line"><span class="function">            NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException </span>&#123;</span><br><span class="line">        <span class="comment">//æ­£å¸¸è°ƒç”¨</span></span><br><span class="line">        Apple apple = <span class="keyword">new</span> Apple();</span><br><span class="line">        apple.setPrice(<span class="number">10</span>);</span><br><span class="line">        System.out.println(<span class="string">"Price is "</span> + apple.getPrice());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åå°„è°ƒç”¨</span></span><br><span class="line">        Class clazz = Class.forName(<span class="string">"Apple"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä½¿ç”¨ getFields() æ— æ³•è·å–ç§æœ‰å±æ€§</span></span><br><span class="line">        Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field: fields) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Field is "</span> + field.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        Method setPriceMethod = clazz.getMethod(<span class="string">"setPrice"</span>, <span class="keyword">int</span>.class);</span><br><span class="line"></span><br><span class="line">        Constructor appleConstructor = clazz.getConstructor();</span><br><span class="line">        Object appleObj = appleConstructor.newInstance();</span><br><span class="line">        <span class="comment">//Constructor appleConstructor = clazz.getConstructor(int.class);   //è·å¾—æœ‰å‚æ„é€ å™¨</span></span><br><span class="line">        <span class="comment">//Object appleObj = appleConstructor.newInstance(int.class)     //è°ƒç”¨æœ‰å‚æ„é€ å™¨</span></span><br><span class="line"></span><br><span class="line">        setPriceMethod.invoke(appleObj, <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">        Method getPriceMethod = clazz.getMethod(<span class="string">"getPrice"</span>);</span><br><span class="line">        System.out.println(<span class="string">"Price is "</span> + getPriceMethod.invoke(appleObj));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><h4 id="ç±»çš„å®ä¾‹åŒ–å’Œæ„é€ å‡½æ•°"><a href="#ç±»çš„å®ä¾‹åŒ–å’Œæ„é€ å‡½æ•°" class="headerlink" title="ç±»çš„å®ä¾‹åŒ–å’Œæ„é€ å‡½æ•°"></a>ç±»çš„å®ä¾‹åŒ–å’Œæ„é€ å‡½æ•°</h4><blockquote><p>è·å–å…¬æœ‰æ„é€ å‡½æ•°ï¼Œä¸åŒ…æ‹¬çˆ¶ç±»ï¼ŒClass.class<br>public Constructor&lt;?&gt;[] getConstructors()<br>public Constructor<t> getConstructor(Class&lt;?&gt;â€¦ parameterTypes)</t></p><p>è·å–å½“å‰ç±»æ„é€ å‡½æ•°ï¼Œå¿½ç•¥ä¿®é¥°ç¬¦<br>public Constructor&lt;?&gt;[] getDeclaredConstructors()<br>public Constructor<t> getDeclaredConstructor(Class&lt;?&gt;â€¦ parameterTypes)</t></p></blockquote><blockquote><p>æ„é€ å‡½æ•°è°ƒç”¨ï¼ŒConstructor.class<br>public T newInstance(Objectâ€¦ initargs)</p><p>å¿½ç•¥ä¿®é¥°ç¬¦ï¼Œå¼ºåˆ¶è°ƒç”¨<br>public void setAccessible(boolean flag)</p></blockquote><h4 id="ç±»æˆå‘˜å˜é‡çš„è·å–"><a href="#ç±»æˆå‘˜å˜é‡çš„è·å–" class="headerlink" title="ç±»æˆå‘˜å˜é‡çš„è·å–"></a>ç±»æˆå‘˜å˜é‡çš„è·å–</h4><blockquote><p>è·å–å…¬æœ‰å˜é‡ï¼ŒåŒ…æ‹¬çˆ¶ç±»ï¼ŒClass.class<br>public Field[] getFields()<br>public Field getField(String name)</p><p>è·å–å½“å‰ç±»æˆå‘˜å˜é‡ï¼Œå¿½ç•¥ä¿®é¥°ç¬¦<br>public Field[] getDeclaredFields()<br>public Field getDeclaredField(String name)</p></blockquote><blockquote><p>æˆå‘˜å˜é‡èµ‹å€¼ï¼ŒField.class<br>//objä¸ºå®ä¾‹å¯¹è±¡<br>public void set(Object obj,Object value)</p><p>å¿½ç•¥ä¿®é¥°ç¬¦ï¼Œå¼ºåˆ¶è°ƒç”¨<br>public void setAccessible(boolean flag)</p></blockquote><h4 id="ç±»æ–¹æ³•çš„è·å–"><a href="#ç±»æ–¹æ³•çš„è·å–" class="headerlink" title="ç±»æ–¹æ³•çš„è·å–"></a>ç±»æ–¹æ³•çš„è·å–</h4><blockquote><p>è·å–å…¬æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬çˆ¶ç±»ï¼ŒClass.class<br>public Method[] getMethods()<br>public Method getMethod(String name, Class&lt;?&gt;â€¦ parameterTypes)</p><p>è·å–å½“å‰ç±»æ–¹æ³•ï¼Œå¿½ç•¥ä¿®é¥°ç¬¦<br>public Method[] getDeclaredMethods()<br>public Method getDeclaredMethod(String name, Class&lt;?&gt;â€¦ parameterTypes)</p></blockquote><blockquote><p>æ–¹æ³•è°ƒç”¨ï¼ŒMethod.class<br>//objä¸ºç±»å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦‚æœä¸ºé™æ€æ–¹æ³•objä¸ºNull<br>invoke(Object obj, Objectâ€¦ args)</p><p>å¿½ç•¥ä¿®é¥°ç¬¦ï¼Œå¼ºåˆ¶è°ƒç”¨<br>public void setAccessible(boolean flag)</p></blockquote><h4 id="ç±»æ³¨è§£çš„è·å–"><a href="#ç±»æ³¨è§£çš„è·å–" class="headerlink" title="ç±»æ³¨è§£çš„è·å–"></a>ç±»æ³¨è§£çš„è·å–</h4><blockquote><p>è·å–ç±»çš„â€annotationClassâ€ç±»å‹çš„æ³¨è§£ï¼ŒåŒ…æ‹¬çˆ¶ç±»<br>public Annotation<a>    getAnnotation(Class annotationClass)</a></p><p>// è·å–ç±»çš„å…¨éƒ¨æ³¨è§£ ï¼ŒåŒ…æ‹¬çˆ¶ç±»<br>public Annotation[]    getAnnotations()</p><p>// è·å–ç±»è‡ªèº«å£°æ˜çš„å…¨éƒ¨æ³¨è§£ ï¼Œå¿½ç•¥ä¿®é¥°ç¬¦<br>public Annotation[]    getDeclaredAnnotations()</p></blockquote><h4 id="ç±»çˆ¶ç±»çš„è·å–"><a href="#ç±»çˆ¶ç±»çš„è·å–" class="headerlink" title="ç±»çˆ¶ç±»çš„è·å–"></a>ç±»çˆ¶ç±»çš„è·å–</h4><blockquote><p>è·å–å®ç°çš„å…¨éƒ¨æ¥å£<br>public Type[]    getGenericInterfaces()</p><p>è·å–çˆ¶ç±»<br>public Type    getGenericSuperclass()</p></blockquote><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><h3 id="RTTIå’ŒClasså¯¹è±¡"><a href="#RTTIå’ŒClasså¯¹è±¡" class="headerlink" title="RTTIå’ŒClasså¯¹è±¡"></a>RTTIå’ŒClasså¯¹è±¡</h3><p>RTTIï¼Œå³ Run-Time Type Identificationï¼Œè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ã€‚RTTI èƒ½åœ¨è¿è¡Œæ—¶å°±èƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«æ¯ä¸ªç¼–è¯‘æ—¶å·²çŸ¥çš„ç±»å‹ã€‚</p><p>å¾ˆå¤šæ—¶å€™éœ€è¦è¿›è¡Œå‘ä¸Šè½¬å‹ï¼Œæ¯”å¦‚ Fruit ç±»æ´¾ç”Ÿå‡º Apple ç±»ï¼Œå½“ç°æœ‰çš„æ–¹æ³•å°† Fruit ä½œä¸ºå‚æ•°æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥å…¶æ´¾ç”Ÿç±»çš„å¼•ç”¨ï¼Œé‚£ä¹ˆ RTTI å°±ä¼šèµ·ä½œç”¨ã€‚é€šè¿‡ RTTI è¯†åˆ«å‡º Apple ç±»æ˜¯ Fruit çš„æ´¾ç”Ÿç±»ï¼Œç„¶åå‘ä¸Šè½¬å‹ã€‚ç‰¹åˆ«æ˜¯åœ¨ç”¨æ¥å£ç±»å‹ä½œä¸ºå‚æ•°çš„æ—¶å€™ï¼Œè¿™ä¸€ç‰¹æ€§æ›´æ˜¯è¢«é¢‘ç¹ä½¿ç”¨ã€‚</p><p>è€Œè¿™äº›ç±»å‹ä¿¡æ¯æ˜¯é€šè¿‡ä¸€ä¸ªç‰¹æ®Šå¯¹è±¡<strong>Classï¼ˆjava.lang.Classï¼‰</strong>å®ç°çš„ï¼Œå®ƒåŒ…å«è·Ÿç±»ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>å½“ç¨‹åºè¦ä½¿ç”¨æŸä¸ªç±»æ—¶ï¼Œå¦‚æœè¯¥ç±»è¿˜æœªè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œåˆ™ç³»ç»Ÿä¼šé€šè¿‡åŠ è½½ã€è¿æ¥ã€åˆå§‹åŒ–ä¸‰æ­¥æ¥å®ç°å¯¹è¿™ä¸ªç±»è¿›è¡Œåˆå§‹åŒ–ã€‚</p><ul><li>åŠ è½½ ï¼šå°† class æ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œå¹¶ä¸ºä¹‹åˆ›å»ºä¸€ä¸ª Class å¯¹è±¡ã€‚ä»»ä½•ç±»è¢«ä½¿ç”¨æ—¶ç³»ç»Ÿéƒ½ä¼šå»ºç«‹ä¸€ä¸ª Class å¯¹è±¡ã€‚</li><li><p>è¿æ¥ï¼š</p><ul><li>éªŒè¯ æ˜¯å¦æœ‰æ­£ç¡®çš„å†…éƒ¨ç»“æ„ï¼Œå¹¶å’Œå…¶ä»–ç±»åè°ƒä¸€è‡´</li><li>å‡†å¤‡ è´Ÿè´£ä¸ºç±»çš„é™æ€æˆå‘˜åˆ†é…å†…å­˜ï¼Œå¹¶è®¾ç½®é»˜è®¤åˆå§‹åŒ–å€¼</li><li>è§£æ å°†ç±»çš„äºŒè¿›åˆ¶æ•°æ®ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨</li></ul></li><li><p>åˆå§‹åŒ–ï¼šå¦‚æœè¯¥ç±»æœ‰è¶…ç±»ï¼Œåˆ™å¯¹å…¶åˆå§‹åŒ–ï¼Œæ‰§è¡Œé™æ€åŸŸå’Œé™æ€åˆå§‹åŒ–å—ã€‚</p></li></ul><p>è·å– Class å¯¹è±¡çš„æ–¹å¼æœ‰ä¸‰ç§</p><ol><li><p>Object ç±»çš„ getClass() æ–¹æ³•ï¼Œæ‰§è¡Œé™æ€å—å’ŒåŠ¨æ€æ„é€ å—</p></li><li><p>æ•°æ®ç±»å‹çš„é™æ€å±æ€§ class ï¼Œä¸ä¼šåˆå§‹åŒ–è¯¥ç±»</p></li><li><p>Classç±»ä¸­çš„é™æ€æ–¹æ³•<code>public static Class forName(String className)</code>ï¼Œæ‰§è¡Œé™æ€å—ï¼Œä¸æ‰§è¡ŒåŠ¨æ€æ„é€ å—</p></li></ol><h3 id="RTTIå’Œåå°„"><a href="#RTTIå’Œåå°„" class="headerlink" title="RTTIå’Œåå°„"></a>RTTIå’Œåå°„</h3><p>Java æœ‰ä¸¤ç§ RTTI æ–¹å¼ï¼Œä¸€ç§æ˜¯ä¼ ç»Ÿçš„ï¼Œå‡è®¾åœ¨ç¼–è¯‘æ—¶å·²ç»çŸ¥é“äº†æ‰€æœ‰çš„ç±»å‹ï¼›è¿˜æœ‰ä¸€ç§ï¼Œæ˜¯åˆ©ç”¨åå°„æœºåˆ¶ï¼Œåœ¨è¿è¡Œæ—¶å†å°è¯•ç¡®å®šç±»å‹ä¿¡æ¯ã€‚</p><p>RTTIå’Œåå°„ä¹‹é—´çš„çœŸæ­£åŒºåˆ«åªåœ¨äºï¼š</p><blockquote><p>RTTIï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ‰“å¼€å’Œæ£€æŸ¥.classæ–‡ä»¶<br>åå°„ï¼šè¿è¡Œæ—¶æ‰“å¼€å’Œæ£€æŸ¥.classæ–‡ä»¶</p></blockquote><p>ä¸¥æ ¼çš„è¯´ï¼Œåå°„ä¹Ÿæ˜¯ä¸€ç§å½¢å¼çš„RTTIï¼Œä¸è¿‡ï¼Œä¸€èˆ¬çš„æ–‡æ¡£èµ„æ–™ä¸­æŠŠRTTIå’Œåå°„åˆ†å¼€ï¼Œå› ä¸ºä¸€èˆ¬çš„ï¼Œå¤§å®¶è®¤ä¸º RTTIæŒ‡çš„æ˜¯ä¼ ç»Ÿçš„ RTTIï¼Œé€šè¿‡ç»§æ‰¿å’Œå¤šæ€æ¥å®ç°ï¼Œåœ¨è¿è¡Œæ—¶é€šè¿‡è°ƒç”¨è¶…ç±»çš„æ–¹æ³•æ¥å®ç°å…·ä½“çš„åŠŸèƒ½</p><p>æœªå®Œå¾…ç»­</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;åå°„æ˜¯ä¸€ç§è®¡ç®—æœºå¤„ç†æ–¹å¼ï¼Œæ˜¯ç¨‹åºå¯ä»¥è®¿é—®ã€æ£€æµ‹å’Œä¿®æ”¹å®ƒæœ¬èº«çŠ¶æ€æˆ–è¡Œä¸ºçš„ä¸€ç§èƒ½åŠ›ã€‚Java åå°„ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åŠ è½½ä¸€ä¸ªç±»ï¼ŒåŠ¨æ€è·å–ç±»çš„å±æ€§ã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ä¿¡æ¯ã€‚åå°„ä½¿ Java è¿™ä¸€é™æ€è¯­è¨€æœ‰äº†åŠ¨æ€çš„ç‰¹æ€§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="åå°„" scheme="http://yoursite.com/tags/%E5%8F%8D%E5%B0%84/"/>
    
  </entry>
  
  <entry>
    <title>åŸºæœ¬æ•°æ®ç»“æ„çš„ç®€å•Javaå®ç°</title>
    <link href="http://yoursite.com/%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9A%84%E7%AE%80%E5%8D%95Java%E5%AE%9E%E7%8E%B0/"/>
    <id>http://yoursite.com/åŸºæœ¬æ•°æ®ç»“æ„çš„ç®€å•Javaå®ç°/</id>
    <published>2019-03-16T14:08:55.000Z</published>
    <updated>2019-03-16T14:40:26.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>JDK ä¸­æä¾›äº†å¾ˆå¤šæ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><blockquote><p>Collection<br>â”œ List<br>â”‚   â”œ LinkedList<br>â”‚   â”œ ArrayList<br>â”‚   â”” Vector<br>â”‚ã€€    â””Stack<br>â”” Set</p><p>Map<br>â”œ Hashtable<br>â”œ HashMap<br>â”” WeakHashMap</p></blockquote><p>æœ¬æ–‡å°†è¿›è¡Œéƒ¨åˆ†æ•°æ®ç»“æ„çš„ç®€å•å®ç°ã€‚</p><a id="more"></a><h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyStack</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object[] dataArray;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxSize;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> nowSize = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyStack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyStack</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">        maxSize = initialCapacity;</span><br><span class="line">        dataArray = <span class="keyword">new</span> Object[maxSize];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (size() &gt;= maxSize) &#123;</span><br><span class="line">            resize();</span><br><span class="line">        &#125;</span><br><span class="line">        dataArray[nowSize++] = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (empty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T)dataArray[--nowSize];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (empty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T)dataArray[nowSize-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">search</span><span class="params">(T target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = nowSize;</span><br><span class="line">        <span class="keyword">while</span> (p &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dataArray[p] == target) &#123;</span><br><span class="line">                <span class="keyword">return</span> p;</span><br><span class="line">            &#125;</span><br><span class="line">            p--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        maxSize = maxSize &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        Object[] newArray = <span class="keyword">new</span> Object[maxSize];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dataArray.length; i++) &#123;</span><br><span class="line">            newArray[i] = dataArray[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.dataArray = newArray;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nowSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nowSize == <span class="number">0</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyQueue</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object[] dataArray;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxSize;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> front;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> rear;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyQueue</span><span class="params">(<span class="keyword">int</span> initialSize)</span> </span>&#123;</span><br><span class="line">        maxSize = initialSize;</span><br><span class="line">        dataArray = <span class="keyword">new</span> Object[maxSize];</span><br><span class="line">        front = rear = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enqueue</span><span class="params">(T newData)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (size() &gt;= maxSize) &#123;</span><br><span class="line">            resize();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//éå¾ªç¯é˜Ÿåˆ—</span></span><br><span class="line">        dataArray[rear++] = newData;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//å¾ªç¯é˜Ÿåˆ—</span></span><br><span class="line">        <span class="comment">//dataArray[rear] = newData;</span></span><br><span class="line">        <span class="comment">//rear = (rear+1) % maxSize;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">dequeue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (empty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        T value = (T)dataArray[front];</span><br><span class="line">        <span class="comment">//éå¾ªç¯é˜Ÿåˆ—</span></span><br><span class="line">        dataArray[front++] = <span class="keyword">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//å¾ªç¯é˜Ÿåˆ—</span></span><br><span class="line">        <span class="comment">//dataArray[front] = null;</span></span><br><span class="line">        <span class="comment">//front = (front+1) % maxSize;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        maxSize = maxSize &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        Object[] temp = <span class="keyword">new</span> Object[maxSize];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dataArray.length; i++) &#123;</span><br><span class="line">            temp[i] = dataArray[i];</span><br><span class="line">        &#125;</span><br><span class="line">        dataArray = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Math.abs(front - rear);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> front == rear ? <span class="keyword">true</span> : <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BinaryTree"><a href="#BinaryTree" class="headerlink" title="BinaryTree"></a>BinaryTree</h2><p><img src="/åŸºæœ¬æ•°æ®ç»“æ„çš„ç®€å•Javaå®ç°/äºŒå‰æœç´¢æ ‘.png" alt="äºŒå‰æœç´¢æ ‘"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBinaryTree</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node root;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> key;</span><br><span class="line">        <span class="keyword">private</span> T value;</span><br><span class="line">        <span class="keyword">private</span> Node leftChild;</span><br><span class="line">        <span class="keyword">private</span> Node rightChild;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> key, T value)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.key = key;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Node <span class="title">find</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        Node currentNode = root;</span><br><span class="line">        <span class="keyword">while</span> (currentNode != <span class="keyword">null</span> &amp;&amp; currentNode.key != key) &#123;</span><br><span class="line">            <span class="keyword">if</span> (key &lt; currentNode.leftChild.key) &#123;</span><br><span class="line">                currentNode = currentNode.leftChild;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                currentNode = currentNode.rightChild;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> currentNode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> key, T value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">            root = <span class="keyword">new</span> Node(key, value);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Node currentNode = root;</span><br><span class="line">        Node parentNode = root;</span><br><span class="line">        Boolean isLeftChild = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (currentNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            parentNode = currentNode;</span><br><span class="line">            <span class="keyword">if</span> (key &lt; currentNode.key) &#123;</span><br><span class="line">                currentNode = currentNode.leftChild;</span><br><span class="line">                isLeftChild = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                currentNode = currentNode.rightChild;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Node newNode = <span class="keyword">new</span> Node(key, value);</span><br><span class="line">        <span class="keyword">if</span> (isLeftChild) &#123;</span><br><span class="line">            parentNode.leftChild = newNode;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            parentNode.rightChild = newNode;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        Node currentNode = root;    <span class="comment">//å¾…åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">        Node parentNode = root;     <span class="comment">//å¾…åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">        Boolean isLeftChild = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (currentNode != <span class="keyword">null</span> &amp;&amp; currentNode.key != key) &#123;</span><br><span class="line">            parentNode = currentNode;</span><br><span class="line">            <span class="keyword">if</span> (key &lt; currentNode.key) &#123;</span><br><span class="line">                currentNode = currentNode.leftChild;</span><br><span class="line">                isLeftChild = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                currentNode = currentNode.rightChild;</span><br><span class="line">                isLeftChild = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (currentNode == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åˆ é™¤èŠ‚ç‚¹ä¸ºå¶å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (currentNode.leftChild == <span class="keyword">null</span> &amp;&amp; currentNode.rightChild == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (currentNode == root) &#123;</span><br><span class="line">                root = <span class="keyword">null</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isLeftChild) &#123;</span><br><span class="line">                parentNode.leftChild = <span class="keyword">null</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                parentNode.rightChild = <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentNode.rightChild == <span class="keyword">null</span>) &#123;    <span class="comment">//å¾…åˆ é™¤èŠ‚ç‚¹åªæœ‰å·¦å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (currentNode == root) &#123;</span><br><span class="line">                root = currentNode.leftChild;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isLeftChild) &#123;</span><br><span class="line">                parentNode.leftChild = currentNode.leftChild;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                parentNode.rightChild = currentNode.leftChild;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentNode.leftChild == <span class="keyword">null</span>) &#123;    <span class="comment">//å¾…åˆ é™¤èŠ‚ç‚¹åªæœ‰å³å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (currentNode == root) &#123;</span><br><span class="line">                root = currentNode.rightChild;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isLeftChild) &#123;</span><br><span class="line">                parentNode.leftChild = currentNode.rightChild;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                parentNode.rightChild = currentNode.rightChild;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;    <span class="comment">//å¾…åˆ é™¤èŠ‚ç‚¹æ—¢æœ‰å·¦å­èŠ‚ç‚¹åˆæœ‰å³å­èŠ‚ç‚¹</span></span><br><span class="line">            Node directPostNode = getDirectPostNode(currentNode);</span><br><span class="line">            currentNode.key = directPostNode.key;</span><br><span class="line">            currentNode.value = directPostNode.value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å¾—å¾…åˆ é™¤èŠ‚ç‚¹çš„ç›´æ¥åç»§èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * å½“å¾…åˆ é™¤èŠ‚ç‚¹æ—¢æœ‰å·¦å­©å­ï¼Œåˆæœ‰å³å­©å­æ—¶ï¼Œä¾‹å¦‚åˆ é™¤å›¾ä¸€ä¸­ key å€¼ä¸º 10 çš„èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * è¿™æ—¶å°±éœ€è¦ç”¨ key å€¼ä¸º 10 çš„èŠ‚ç‚¹çš„ä¸­åºåç»§èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹ 11ï¼‰æ¥ä»£æ›¿ key å€¼ä¸º 10 çš„èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * å¹¶åˆ é™¤ key å€¼ä¸º 10 çš„èŠ‚ç‚¹çš„ä¸­åºåç»§èŠ‚ç‚¹ï¼Œ</span></span><br><span class="line"><span class="comment">     * ç”±ä¸­åºéå†ç›¸å…³è§„åˆ™å¯çŸ¥ï¼Œ key å€¼ä¸º 10 çš„èŠ‚ç‚¹çš„ç›´æ¥ä¸­åºåç»§èŠ‚ç‚¹ä¸€å®šæ˜¯å…¶å³å­æ ‘ä¸­ key å€¼æœ€å°çš„èŠ‚ç‚¹ï¼Œ</span></span><br><span class="line"><span class="comment">     * æ‰€ä»¥æ­¤ä¸­åºåç»§èŠ‚ç‚¹ä¸€å®šä¸å«å­èŠ‚ç‚¹æˆ–è€…åªå«æœ‰ä¸€ä¸ªå³å­©å­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * é¦–å…ˆæ‰¾åˆ° key å€¼ä¸º 10 çš„èŠ‚ç‚¹çš„ç›´æ¥ä¸­åºåç»§èŠ‚ç‚¹ï¼ˆå³å…¶å³å­æ ‘ä¸­å€¼æœ€å°çš„èŠ‚ç‚¹ 11ï¼‰ï¼Œ</span></span><br><span class="line"><span class="comment">     * å¹¶åˆ é™¤æ­¤ç›´æ¥ä¸­åºåç»§èŠ‚ç‚¹ï¼Œç„¶åå°†æ­¤åç»§èŠ‚ç‚¹çš„ keyã€value å€¼èµ‹ç»™å¾…åˆ é™¤èŠ‚ç‚¹çš„ keyï¼Œvalueå€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delNode å¾…åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¿”å›ç›´æ¥åç»§èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">getDirectPostNode</span><span class="params">(Node delNode)</span> </span>&#123;</span><br><span class="line">        Node parentNode = delNode;  <span class="comment">//ä¿å­˜å¾…åˆ é™¤èŠ‚ç‚¹çš„ç›´æ¥åç»§èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">        Node direcrPostNode = delNode;  <span class="comment">//ä¿å­˜å¾…åˆ é™¤èŠ‚ç‚¹çš„ç›´æ¥åç»§èŠ‚ç‚¹</span></span><br><span class="line">        Node currentNode = delNode.rightChild;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (currentNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            parentNode = direcrPostNode;</span><br><span class="line">            direcrPostNode = currentNode;</span><br><span class="line">            currentNode = currentNode.leftChild;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (direcrPostNode != delNode.rightChild) &#123; <span class="comment">//ä»æ ‘ä¸­åˆ é™¤æ­¤ç›´æ¥åç»§èŠ‚ç‚¹</span></span><br><span class="line">            parentNode.leftChild = direcrPostNode.rightChild;</span><br><span class="line">            direcrPostNode.rightChild = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> direcrPostNode;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preOrder</span><span class="params">(Node rootNode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rootNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(rootNode.key + <span class="string">": "</span> + rootNode.value);</span><br><span class="line">            preOrder(rootNode.leftChild);</span><br><span class="line">            preOrder(rootNode.rightChild);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inOrder</span><span class="params">(Node rootNode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rootNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            preOrder(rootNode.leftChild);</span><br><span class="line">            System.out.println(rootNode.key + <span class="string">": "</span> + rootNode.value);</span><br><span class="line">            preOrder(rootNode.rightChild);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postOrder</span><span class="params">(Node rootNode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rootNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            preOrder(rootNode.leftChild);</span><br><span class="line">            preOrder(rootNode.rightChild);</span><br><span class="line">            System.out.println(rootNode.key + <span class="string">": "</span> + rootNode.value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h2><p><img src="/åŸºæœ¬æ•°æ®ç»“æ„çš„ç®€å•Javaå®ç°/HashMap.png" alt="HashMap"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;JDK ä¸­æä¾›äº†å¾ˆå¤šæ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Collection&lt;br&gt;â”œ List&lt;br&gt;â”‚   â”œ LinkedList&lt;br&gt;â”‚   â”œ ArrayList&lt;br&gt;â”‚   â”” Vector&lt;br&gt;â”‚ã€€    â””Stack&lt;br&gt;â”” Set&lt;/p&gt;
&lt;p&gt;Map&lt;br&gt;â”œ Hashtable&lt;br&gt;â”œ HashMap&lt;br&gt;â”” WeakHashMap&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ¬æ–‡å°†è¿›è¡Œéƒ¨åˆ†æ•°æ®ç»“æ„çš„ç®€å•å®ç°ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="æ•°æ®ç»“æ„" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>Android æ¶ˆæ¯æœºåˆ¶è¯¦è§£</title>
    <link href="http://yoursite.com/Android-%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3/"/>
    <id>http://yoursite.com/Android-æ¶ˆæ¯æœºåˆ¶è¯¦è§£/</id>
    <published>2019-03-16T06:13:19.000Z</published>
    <updated>2019-03-17T03:49:56.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>Android çš„æ¶ˆæ¯æœºåˆ¶ï¼Œä¸»è¦æ˜¯æŒ‡ Handler çš„è¿è¡Œæœºåˆ¶ã€‚<a id="more"></a></p><h2 id="ANR"><a href="#ANR" class="headerlink" title="ANR"></a>ANR</h2><p>Application Not Respondingï¼Œå³åº”ç”¨ç¨‹åºæ— å“åº”ï¼Œåœ¨ä»‹ç»æ¶ˆæ¯æœºåˆ¶çš„ç›¸å…³çŸ¥è¯†ä¹‹å‰å…ˆäº†è§£ ANRã€‚</p><h3 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h3><p>Androidç³»ç»Ÿä¸­ï¼ŒActivityManagerService(AMS) å’Œ WindowManagerService(WMS) ä¼šæ£€æµ‹ App çš„å“åº”æ—¶é—´ï¼Œå¦‚æœAppåœ¨ç‰¹å®šæ—¶é—´æ— æ³•å“åº”å±å¹•è§¦æ‘¸æˆ–é”®ç›˜è¾“å…¥äº‹ä»¶ï¼Œæˆ–è€…ç‰¹å®šäº‹ä»¶æ²¡æœ‰å¤„ç†å®Œæ¯•ï¼Œå°±ä¼šå‡ºç°ANRã€‚</p><p>ä»¥ä¸‹å››ç§æ¡ä»¶éƒ½å¯ä»¥é€ æˆ ANR</p><ul><li>InputDispatching Timeoutï¼š5ç§’å†…æ— æ³•å“åº”å±å¹•è§¦æ‘¸æˆ–é”®ç›˜è¾“å…¥äº‹ä»¶</li><li>BroadcastQueue Timeout ï¼šåœ¨æ‰§è¡Œå‰å°å¹¿æ’­ï¼ˆBroadcastReceiverï¼‰çš„<code>onReceive</code>æ–¹æ³•ä¸­10ç§’æ²¡æœ‰å¤„ç†å®Œæˆï¼Œåå°åˆ™ä¸º60ç§’ã€‚</li><li>Service Timeout ï¼šå‰å°æœåŠ¡20ç§’å†…ï¼Œåå°æœåŠ¡åœ¨200ç§’å†…æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ã€‚</li><li>ContentProvider Timeout ï¼šContentProvider çš„ publish åœ¨10så†…æ²¡è¿›è¡Œå®Œã€‚</li></ul><h3 id="åˆ†æå’Œè§£å†³"><a href="#åˆ†æå’Œè§£å†³" class="headerlink" title="åˆ†æå’Œè§£å†³"></a>åˆ†æå’Œè§£å†³</h3><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><ul><li>æŸ¥çœ‹ log ä¿¡æ¯</li><li>Java çº¿ç¨‹è°ƒç”¨åˆ†æï¼Œ<code>jstack {pid}</code>ï¼Œå…¶ä¸­ pid ä¸ºè™šæ‹Ÿæœºè¿›ç¨‹ idï¼Œå¯ä»¥é€šè¿‡<code>jps</code>æŸ¥çœ‹å½“å‰æ‰€æœ‰çº¿ç¨‹ã€‚</li><li>æŸ¥çœ‹ trace.txt æ–‡ä»¶ï¼Œå…¶å¯¼å‡ºç›®å½•ä¸º Android SDK çš„ /platform-tools ç›®å½•ï¼ŒWindows ä¸‹åœ¨è¯¥ç›®å½•ä½¿ç”¨å‘½ä»¤<code>./adb pull /data/anr/traces.txt</code>æŸ¥çœ‹</li></ul><h4 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h4><ul><li>é¿å…æ­»é”çš„å‡ºç°ï¼Œä½¿ç”¨å­çº¿ç¨‹æ¥å¤„ç†è€—æ—¶æ“ä½œæˆ–é˜»å¡ä»»åŠ¡ã€‚</li><li>é¿å…åœ¨ä¸»çº¿ç¨‹ query providerã€ä¸è¦æ»¥ç”¨SharePreferences</li><li>æ–‡ä»¶è¯»å†™æˆ–æ•°æ®åº“æ“ä½œæ”¾åœ¨å­çº¿ç¨‹å¼‚æ­¥æ“ä½œï¼Œæ“ä½œå®Œæˆä¹‹ååŠæ—¶å…³é—­æµã€‚</li><li>BroadcastReciever çš„<code>onRecieve</code>ä¸è¦è¿›è¡Œè€—æ—¶æ“ä½œã€‚</li></ul><h2 id="Handler-æœºåˆ¶"><a href="#Handler-æœºåˆ¶" class="headerlink" title="Handler æœºåˆ¶"></a>Handler æœºåˆ¶</h2><p>ç”±ä¸Šæ–‡æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ä¸»çº¿ç¨‹è¿›è¡Œè€—æ—¶æ“ä½œå°†ä¼šå¼•å‘ ANRï¼Œè€Œä¸” Android ç¦æ­¢åœ¨å­çº¿ç¨‹ä¸­ç›´æ¥ UI æ“ä½œï¼Œè¯¥æœºåˆ¶ç”± ViewRootImpl çš„<code>checkThread</code>è¿›è¡ŒéªŒè¯<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">checkThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mThread != Thread.currrentThread()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> CalledFromWrongThreadException(</span><br><span class="line">            <span class="string">"Only the original thread that created a view hierarchy can</span></span><br><span class="line"><span class="string">            touch its views"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨è¯¥æœºåˆ¶çš„åŸå› ï¼Œä¸€æ˜¯å¤šçº¿ç¨‹ä¸­å¹¶å‘è®¿é—® UI ä¼šé€ æˆä¸å¯é¢„çŸ¥çŠ¶æ€ï¼›äºŒæ˜¯å¯¹æ§ä»¶ä½¿ç”¨é”æœºåˆ¶ä¼šé™ä½ UI è®¿é—®çš„æ•ˆç‡ã€‚<br>é‚£ä¹ˆï¼Œå½“æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹æŠ€æœ¯ç»“æŸæ•°æ®çš„å­˜å‚¨ã€è·å–ï¼Œæƒ³å›åˆ°ä¸»çº¿ç¨‹æ“ä½œ UI è¯¥æ€ä¹ˆåˆ‡æ¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ä½¿ç”¨ Handler ã€‚</p><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"><span class="meta">@SuppressLint</span>(<span class="string">"HandlerLeak"</span>)</span><br><span class="line"><span class="keyword">private</span> Handler mHandler = <span class="keyword">new</span> Handler() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.handleMessage(msg);</span><br><span class="line">        <span class="keyword">if</span> (msg.what == <span class="number">1</span>) &#123;</span><br><span class="line">            log.e(<span class="string">"MSG"</span>, <span class="string">"æ”¶åˆ°æ¶ˆæ¯"</span>)ï¼›</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            mHandler.sendEmptyMessage(<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æˆå‘˜å˜é‡åˆ›å»º Handler çš„æ–¹å¼å¾ˆæœ‰å¯èƒ½é€ æˆå†…å­˜æ³„æ¼ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯ä½¿ç”¨é™æ€å†…éƒ¨ç±»å’Œå¼±å¼•ç”¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MyHandler hander = <span class="keyword">new</span> MyHandler(context);</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> WeakReference&lt;Context&gt; out;</span><br><span class="line">    </span><br><span class="line">    MyHandler(Context ctx) &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        out = <span class="keyword">new</span> WeakReference&lt;&gt;(ctx);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (out.get() != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">//è¿›è¡Œæ¶ˆæ¯å¤„ç†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Handler çš„è¿è¡Œæœºåˆ¶åº•å±‚ç”± MessageQueue å’Œ Looper æ”¯æ’‘ã€‚ç®€å•æ¦‚æ‹¬ï¼ŒHandler æŠŠä¸€ä¸ªçº¿ç¨‹æ¶ˆæ¯å‘é€ç»™å½“å‰çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå³ MessageQueueï¼Œè€Œ Looper è´Ÿè´£ç®¡ç†æ¶ˆæ¯é˜Ÿåˆ—çš„ã€‚</p><h3 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h3><p>è§‚å¯Ÿ Handler çš„æ„é€ å‡½æ•°<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(Callback callback, <span class="keyword">boolean</span> async)</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">    mLooper = Looper.myLooper();</span><br><span class="line">    <span class="keyword">if</span> (mLooper == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">            <span class="string">"Can't create handler inside thread "</span> + Thread.currentThread()  + <span class="string">" that has not called"</span> </span><br><span class="line">            + <span class="string">" Looper.prepare()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    mQueue = mLooper.mQueue;</span><br><span class="line">    mCallback = callback;</span><br><span class="line">    mAsynchronous = async;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨å…¶ä¸­ç»™ MessageQueue ã€Callback å’Œ Asynchronous èµ‹å€¼ã€‚è§‚å¯Ÿ if è¯­å¥ï¼Œå¦‚æœ mLooper ä¸º nullï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå…¶å®å°±æ˜¯æ— æ³•åœ¨æœªè°ƒç”¨<code>Looper.prepare</code>çš„çº¿ç¨‹å†…åˆ›å»º handlerã€‚</p><p>ä¸è¿‡ï¼Œä¸ºä»€ä¹ˆåœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»º Handler ä¸éœ€è¦è°ƒç”¨<code>Looper.prepare</code>å’Œ<code>Looper.loop</code>æ–¹æ³•å‘¢ï¼Ÿå…¶å®æ˜¯å› ä¸ºåœ¨åˆ›å»º Activity çš„æ—¶å€™ï¼Œä¼šç»è¿‡ä¸€ç³»åˆ—è°ƒç”¨è¿‡ç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œ ActivityThread çš„<code>main</code>æ–¹æ³•ï¼Œåœ¨å…¶ä¸­è°ƒç”¨äº†<code>prepareMainLooper</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ......</span><br><span class="line">        Looper.prepareMainLooper();</span><br><span class="line">        ......</span><br><span class="line">        Looper.loop();</span><br><span class="line">        ......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepareMainLooper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    prepare(<span class="keyword">false</span>);     <span class="comment">//quitAllowed å‚æ•°ä¼ false</span></span><br><span class="line">    <span class="keyword">synchronized</span> (Looper.class) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sMainLooper != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"The main Looper has already been prepared."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        sMainLooper = myLooper();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…³äº ActivityThreadï¼š<a href="http://www.cnblogs.com/younghao/p/5126408.html" target="_blank" rel="noopener">Androidçº¿ç¨‹ç®¡ç†ï¼ˆäºŒï¼‰â€”â€”ActivityThread</a></p><h3 id="MessageQueue"><a href="#MessageQueue" class="headerlink" title="MessageQueue"></a>MessageQueue</h3><p>é¡¾åæ€ä¹‰ï¼ŒæŒ‡æ¶ˆæ¯é˜Ÿåˆ—ã€‚é¦–å…ˆè®¤è¯† Messageï¼Œå½“ç”¨æˆ·åœ¨UIç•Œé¢æ—¶ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œè¯¥äº‹ä»¶ä¼šè¢«å°è£…æˆä¸€æ¡ Messageï¼Œè¢«æ·»åŠ åˆ° MessageQueue ä¸­ã€‚Message å†…éƒ¨å°è£…äº†ä¸€ä¸ªå±æ€§ tagetï¼Œå…¶å®è´¨æ˜¯ä¸€ä¸ª Handler å¯¹è±¡ã€‚</p><p>ç”±äºä¸€ä¸ªçº¿ç¨‹åœ¨ä¸€æ®µæ—¶é—´åªèƒ½å¯¹ä¸€ç§æ“ä½œè¿›è¡Œç›¸å…³çš„å¤„ç†ï¼Œå› æ­¤ä½¿ç”¨ MessageQueue æ¥ç®¡ç†æ‰€æœ‰æ¶ˆæ¯çš„å…ˆåé¡ºåºï¼Œå…¶å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå•é“¾è¡¨ç”¨ä»¥å­˜å‚¨æ¶ˆæ¯åˆ—è¡¨ã€‚</p><p>å½“ Handler è°ƒç”¨<code>sendMessage</code>æ—¶ï¼Œæœ€åä¼šè°ƒç”¨åˆ°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">sendMessageAtTime</span><span class="params">(Message msg, <span class="keyword">long</span> uptimeMillis)</span> </span>&#123;</span><br><span class="line">    MessageQueue queue = mQueue;</span><br><span class="line">    <span class="keyword">if</span> (queue == <span class="keyword">null</span>) &#123;</span><br><span class="line">        RuntimeException e = <span class="keyword">new</span> RuntimeException(</span><br><span class="line">                <span class="keyword">this</span> + <span class="string">" sendMessageAtTime() called with no mQueue"</span>);</span><br><span class="line">        Log.w(<span class="string">"Looper"</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> enqueueMessage(queue, msg, uptimeMillis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹<code>enqueueMessage</code>æ–¹æ³•ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">enqueueMessage</span><span class="params">(Message msg, <span class="keyword">long</span> when)</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mQuitting) &#123;</span><br><span class="line">            IllegalStateException e = <span class="keyword">new</span> IllegalStateException(</span><br><span class="line">                    msg.target + <span class="string">" sending message to a Handler on a dead thread"</span>);</span><br><span class="line">            msg.recycle();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        msg.markInUse();</span><br><span class="line">        msg.when = when;</span><br><span class="line">        Message p = mMessages;</span><br><span class="line">        <span class="keyword">boolean</span> needWake;</span><br><span class="line">        <span class="keyword">if</span> (p == <span class="keyword">null</span> || when == <span class="number">0</span> || when &lt; p.when) &#123;</span><br><span class="line">            msg.next = p;</span><br><span class="line">            mMessages = msg;</span><br><span class="line">            needWake = mBlocked;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            needWake = mBlocked &amp;&amp; p.target == <span class="keyword">null</span> &amp;&amp; msg.isAsynchronous();</span><br><span class="line">            Message prev;</span><br><span class="line">            <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">                prev = p;</span><br><span class="line">                p = p.next;</span><br><span class="line">                <span class="keyword">if</span> (p == <span class="keyword">null</span> || when &lt; p.when) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (needWake &amp;&amp; p.isAsynchronous()) &#123;</span><br><span class="line">                    needWake = <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            msg.next = p; <span class="comment">// invariant: p == prev.next</span></span><br><span class="line">            prev.next = msg;</span><br><span class="line">        &#125;</span><br><span class="line">        ......</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆåˆ¤æ–­æ¶ˆæ¯é˜Ÿåˆ—é‡Œæœ‰æ²¡æœ‰æ¶ˆæ¯ï¼Œæ²¡æœ‰åˆ™å°†å½“å‰æ’å…¥çš„æ¶ˆæ¯ä½œä¸ºé˜Ÿå¤´ï¼Œå¹¶ä¸”å¦‚æœæ­¤æ—¶æ¶ˆæ¯é˜Ÿåˆ—å¤„äºç­‰å¾…çŠ¶æ€åˆ™å°†å…¶å”¤é†’</li><li>å¦‚æœé˜Ÿåˆ—å·²æœ‰æ¶ˆæ¯ï¼Œåˆ™æ ¹æ® Message åˆ›å»ºçš„æ—¶é—´è¿›è¡Œæ’å…¥</li></ul><h3 id="Looper"><a href="#Looper" class="headerlink" title="Looper"></a>Looper</h3><p>é€šå¸¸è¿è¡Œåœ¨ä¸€ä¸ªæ¶ˆæ¯çš„å¾ªç¯é˜Ÿåˆ—å½“ä¸­ï¼Œçº¿ç¨‹é»˜è®¤ä¸ä¼šæä¾›æ¶ˆæ¯å¾ªç¯å»ç®¡ç†æ¶ˆæ¯é˜Ÿåˆ—ï¼Œéœ€è¦åœ¨çº¿ç¨‹å½“ä¸­è°ƒç”¨<code>Looper.prepare</code>æ–¹æ³•ä½¿æ¶ˆæ¯å¾ªç¯åˆå§‹åŒ–ï¼Œå¹¶ä¸”è°ƒç”¨<code>Looper.loop</code>ä½¿æ¶ˆæ¯å¾ªç¯ä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œ<strong>å–å‡º MessageQueue ä¸­çš„æ¶ˆæ¯åˆ†å‘ç»™ Handler</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    prepare(<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">(<span class="keyword">boolean</span> quitAllowed)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sThreadLocal.get() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Only one Looper may be created per thread"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sThreadLocal.set(<span class="keyword">new</span> Looper(quitAllowed));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>prepare(boolean quitAllowed)</code>å®ä¾‹åŒ–äº†ä¸€ä¸ª Looper ï¼Œç„¶åå°†å…¶è®¾ç½®è¿› sThreadLocal ä¸­ã€‚å½“<code>Looper.prepare</code>æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰å¯ä»¥æ‰§è¡Œ<code>loop</code>æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„Looper</span></span><br><span class="line">        <span class="keyword">final</span> Looper me = myLooper();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//å½“å‰çº¿ç¨‹çš„MessageQueue</span></span><br><span class="line">        <span class="keyword">final</span> MessageQueue queue = me.mQueue;</span><br><span class="line">        ......</span><br><span class="line">        <span class="comment">//å¾ªç¯ä» MessageQueue å–å‡ºæ¶ˆæ¯.</span></span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">            Message msg = queue.next();</span><br><span class="line">            ......</span><br><span class="line">            <span class="comment">//å°†æ¶ˆæ¯åˆ†å‘å‡ºå»</span></span><br><span class="line">            msg.target.dispatchMessage(msg);</span><br><span class="line">            ......</span><br><span class="line">            <span class="comment">//å°†æ¶ˆæ¯å›æ”¶</span></span><br><span class="line">            msg.recycle();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ¶ˆæ¯é˜Ÿåˆ—çš„ next è¿”å›äº†æ–°æ¶ˆæ¯ï¼Œå°±ä¼šè°ƒç”¨<code>msg.target.dispatchMessage(msg)</code>ï¼Œtarget å³ä¸ºå‘é€æ¶ˆæ¯çš„ Handler å¯¹è±¡ã€‚æˆåŠŸå°†ä»£ç é€»è¾‘åˆ‡æ¢åˆ°æŒ‡å®šçš„çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispatchMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (msg.callback != <span class="keyword">null</span>) &#123;</span><br><span class="line">        handleCallback(msg);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mCallback != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mCallback.handleMessage(msg)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        handleMessage(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆæ£€æŸ¥ Message çš„ callBack æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™<code>handlerCallback(msg)</code>ï¼Œæœ€ç»ˆè°ƒç”¨ callback çš„<code>run</code>æ–¹æ³•</li><li>å¦‚æœä¸ºç©ºï¼Œæ£€æŸ¥ mCallBack æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™è°ƒç”¨å®ƒçš„<code>handleMassage</code>ï¼ŒCallBack æ˜¯ä¸€ä¸ªæ¥å£ï¼Œåˆ©ç”¨å®ƒæˆ‘ä»¬å¯ä»¥ä¼ ä¸€ä¸ª Callback æ¥åˆ›å»º Handlerã€‚</li><li>å¦‚æœéƒ½ä¸ºç©ºï¼Œè°ƒç”¨ Handler å†…éƒ¨çš„<code>handleMessage</code>ï¼Œä¹Ÿå°±æ˜¯å¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬åˆ›å»º Handler å®ä¾‹çš„æ—¶å€™éœ€è¦é‡å†™çš„æ–¹æ³•ã€‚</li></ul><h3 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h3><p>ä¸€ä¸ªçº¿ç¨‹å†…éƒ¨çš„æ•°æ®å­˜å‚¨ç±»ï¼Œå½“æŸäº›æ•°æ®æ˜¯ä»¥çº¿ç¨‹ä¸ºä½œç”¨åŸŸè€Œä¸”ä¸åŒçº¿ç¨‹å…·æœ‰ä¸åŒçš„æ•°æ®å‰¯æœ¬çš„æ—¶å€™ï¼Œå¯ä»¥é‡‡ç”¨ ThreadLocalã€‚å¯¹äº Handler æ¥è¯´ï¼Œå®ƒéœ€è¦è·å–å½“å‰çº¿ç¨‹çš„ Looperï¼Œå¾ˆæ˜æ˜¾ä¸åŒçš„çº¿ç¨‹å…·æœ‰å„è‡ªçš„ Looperï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡ ThreadLocal å®ç° Looper åœ¨çº¿ç¨‹ä¸­çš„å­˜å–ã€‚å¦‚æœä¸é‡‡ç”¨ ThreadLocalï¼Œé‚£ä¹ˆç³»ç»Ÿå°±å¿…é¡»æä¾›ä¸€ä¸ªå…¨å±€çš„å“ˆå¸Œè¡¨ä¾› Handler æŸ¥æ‰¾ Looperï¼Œå†æä¾›ä¸€ä¸ªç±»ä¼¼ LooperManager çš„ç±»ã€‚</p><p>ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¼”ç¤º ThreadLocal çš„çœŸæ­£å«ä¹‰<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–°å»ºä¸€ä¸ª boolean ç±»å‹çš„å˜é‡</span></span><br><span class="line"><span class="keyword">private</span> ThreadLocal&lt;Boolean&gt; value = <span class="keyword">new</span> ThreadLocal&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨ä¸»çº¿ç¨‹ä¸­å°†å…¶è®¾ä¸º true</span></span><br><span class="line">value.set(<span class="keyword">true</span>);</span><br><span class="line">log.e(<span class="string">"MainThread"</span>, value.get());</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­çº¿ç¨‹ä¸­è®¾ä¸º false</span></span><br><span class="line"><span class="keyword">new</span> Thread(<span class="string">"Thread1"</span>) &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        value.set(<span class="keyword">false</span>);</span><br><span class="line">        log.e(<span class="string">"Thread1"</span>, value.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦ä¸€ä¸ªå­çº¿ç¨‹ç›´æ¥è¯»å–</span></span><br><span class="line"><span class="keyword">new</span> Thread(<span class="string">"Thread2"</span>) &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.e(<span class="string">"Thread2"</span>, value.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œæ—¥å¿—å¦‚ä¸‹</p><blockquote><p>MainThread, true<br>Thread1, false<br>Thread2, null</p></blockquote><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶è®¿é—®çš„æ˜¯åŒä¸€ä¸ª ThreadLocal å¯¹è±¡ï¼Œä½†æ˜¯ä¸åŒçº¿ç¨‹è·å–çš„å€¼æ˜¯ä¸ä¸€æ ·çš„ã€‚ThreadLocal çš„å®ç°åŸç†ï¼š<a href="https://www.cnblogs.com/dolphin0520/p/3920407.html" target="_blank" rel="noopener">Javaå¹¶å‘ç¼–ç¨‹ï¼šæ·±å…¥å‰–æThreadLocal</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Handler æœºåˆ¶æ˜¯å¦‚æ­¤é‡è¦ï¼Œå¼€å‘ä¸­æˆ‘ä»¬æ€»ä¼šæ˜¾å¼æˆ–éšå¼çš„ç”¨åˆ°å®ƒï¼Œæ¯”å¦‚ Activity çš„<code>runOnUiThread</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">runOnUiThread</span><span class="params">(Runnable action)</span> </span>&#123; </span><br><span class="line"><span class="keyword">if</span> (Thread.currentThread() != mUiThread) &#123; </span><br><span class="line">mHandler.post(action); </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">action.run(); </span><br><span class="line">&#125; </span><br><span class="line">...... </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ View çš„<code>post</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">post</span><span class="params">(Runnable action)</span> </span>&#123;</span><br><span class="line"><span class="keyword">final</span> AttachInfo attachInfo = mAttachInfo;</span><br><span class="line">    <span class="keyword">if</span> (attachInfo != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> attachInfo.mHandler.post(action);         â‘ </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Assume that post will succeed later</span></span><br><span class="line">        ViewRootImpl.getRunQueue().post(action);        â‘¡</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æœ€åç”¨ä¸€å¼ å›¾æ¥ç»“æŸæœ¬æ–‡</p><p><img src="/Android-æ¶ˆæ¯æœºåˆ¶è¯¦è§£/æ¶ˆæ¯æµç¨‹å›¾.jpg" alt="æµç¨‹å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;Android çš„æ¶ˆæ¯æœºåˆ¶ï¼Œä¸»è¦æ˜¯æŒ‡ Handler çš„è¿è¡Œæœºåˆ¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="Handler" scheme="http://yoursite.com/tags/Handler/"/>
    
  </entry>
  
  <entry>
    <title>Java æ’åºç®—æ³•</title>
    <link href="http://yoursite.com/Java-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
    <id>http://yoursite.com/Java-æ’åºç®—æ³•/</id>
    <published>2019-03-15T10:36:47.000Z</published>
    <updated>2019-03-15T15:53:18.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>æ’åºç®—æ³•ä¸€ç›´æ˜¯ç¨‹åºå‘˜å¼€å‘å’Œé¢è¯•çš„é‡ç‚¹ï¼Œæœ¬æ–‡å°†é‡ç‚¹è®²è§£å‡ ç§å¸¸ç”¨çš„æ’åºç®—æ³•ã€‚<a id="more"></a></p><h2 id="ç¨³å®šæ€§"><a href="#ç¨³å®šæ€§" class="headerlink" title="ç¨³å®šæ€§"></a>ç¨³å®šæ€§</h2><p>å¯¹äºä¸€ä¸ªæ•°ç»„<code>a {6,2,4,6,1}</code>ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªå€¼ä¸º 6ï¼Œä¸º a[0] å’Œ a[3]ï¼Œæ’åºä¹‹åçš„ç»“æœæœ‰ä¸¤ç§</p><table><thead><tr><th style="text-align:center">1</th><th style="text-align:center">2</th><th style="text-align:center">4</th><th style="text-align:center">6</th><th style="text-align:center">6</th></tr></thead><tbody><tr><td style="text-align:center">a[4]</td><td style="text-align:center">a[1]</td><td style="text-align:center">a[2]</td><td style="text-align:center"><b>a[0]</b></td><td style="text-align:center"><b>a[3]</b></td></tr><tr><td style="text-align:center">a[4]</td><td style="text-align:center">a[1]</td><td style="text-align:center">a[2]</td><td style="text-align:center"><b>a[3]</b></td><td style="text-align:center"><b>a[0]</b></td></tr></tbody></table><p>å¦‚æœæ’åºç»“æŸä¹‹åï¼Œa[0] å¯ä»¥ä¿è¯ä¸€å®šåœ¨ a[3] å‰é¢ï¼Œå³åŸæœ‰çš„é¡ºåºä¸å˜ï¼Œåˆ™è¯¥ç®—æ³•å±äºç¨³å®šçš„æ’åºç®—æ³•</p><blockquote><p>å†’æ³¡æ’åºã€åŸºæ•°æ’åºã€æ’å…¥æ’åºã€å½’å¹¶æ’åºã€æ¡¶æ’åºã€äºŒå‰æ ‘æ’åºç­‰</p></blockquote><p>å¦åˆ™ï¼Œå±äºä¸ç¨³å®šçš„æ’åºç®—æ³•</p><blockquote><p>é€‰æ‹©æ’åºï¼Œå¸Œå°”æ’åºï¼Œå †æ’åºï¼Œå¿«é€Ÿæ’åºç­‰</p></blockquote><h2 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å†’æ³¡æ’åºï¼ŒO(n^2)</span></span><br><span class="line"><span class="comment"> * æ¯ä¸€æ¬¡å†…å±‚å¾ªç¯ä¸­ï¼Œä¸¤ä¸¤æ¯”è¾ƒï¼Œå°†è¾ƒå¤§çš„æ•°æ”¾åˆ°åé¢</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a å¾…æ’åºæ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> length = a.length;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( ; i &lt; length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ( ; j &lt; length - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j] &gt; a[j+<span class="number">1</span>]) &#123;</span><br><span class="line">                temp = a[j];</span><br><span class="line">                a[j] = a[j+<span class="number">1</span>];</span><br><span class="line">                a[j+<span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h2><p>æ’å…¥æ’åºå¯ä»¥åˆ†ä¸ºç›´æ¥æ’å…¥æ’åºï¼Œä»¥åŠå…¶å˜ç§â€”â€”æŠ˜åŠæ’å…¥æ’åºã€å¸Œå°”æ’åº</p><h3 id="ç›´æ¥æ’å…¥æ’åº"><a href="#ç›´æ¥æ’å…¥æ’åº" class="headerlink" title="ç›´æ¥æ’å…¥æ’åº"></a>ç›´æ¥æ’å…¥æ’åº</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç›´æ¥æ’å…¥æ’åºï¼ŒO(n^2)</span></span><br><span class="line"><span class="comment"> * iä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œé»˜è®¤iå‰é¢çš„åºåˆ—å·²ç»æ’å¥½åº</span></span><br><span class="line"><span class="comment"> * å–å‡ºiçš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä»åå¾€å‰æ¯”è¾ƒï¼Œæ‰¾åˆ°é€‚åˆçš„ä½ç½®å°±æ’å…¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a å¾…æ’åºåºåˆ—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> length = a.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> temp = a[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt; <span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j] &lt; a[j-<span class="number">1</span>]) &#123;</span><br><span class="line">                a[j] = a[j-<span class="number">1</span>];</span><br><span class="line">                a[j-<span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŠ˜åŠæ’å…¥æ’åº"><a href="#æŠ˜åŠæ’å…¥æ’åº" class="headerlink" title="æŠ˜åŠæ’å…¥æ’åº"></a>æŠ˜åŠæ’å…¥æ’åº</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠ˜åŠæ’å…¥æ’åºï¼ŒO(n^2)</span></span><br><span class="line"><span class="comment"> * å¯¹ç›´æ¥æ’å…¥æ’åºç®—æ³•è¿›è¡Œäº†æ”¹è¿›</span></span><br><span class="line"><span class="comment"> * ç›´æ¥æ’å…¥ç®—æ³•é‡‡ç”¨éå†ä¸€ä¸ªæœ‰åºåºåˆ—çš„æ–¹å¼æ’å…¥å¾…æ’åºå…ƒç´ ï¼Œå®Œå…¨æ²¡å¿…è¦</span></span><br><span class="line"><span class="comment"> * æŠ˜åŠæ’å…¥æ’åºåˆ™ä½¿ç”¨äº†æŠ˜åŠæŸ¥æ‰¾/äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Arraysç±»çš„binarySearch()æ–¹æ³•ä¾¿æ˜¯æŠ˜åŠæŸ¥æ‰¾çš„å®ç°</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a å¾…æ’åºåºåˆ—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">binaryInsertSort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> length = a.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> temp = a[i];</span><br><span class="line">        <span class="keyword">int</span> low = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> high = i-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">            <span class="keyword">int</span> middle = (low+high) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (a[middle] &lt; temp) &#123;</span><br><span class="line">                low = middle+<span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                high = middle-<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i-<span class="number">1</span>; j &gt;= low; j--) &#123;</span><br><span class="line">             <span class="comment">//å…ƒç´ åç§»ï¼Œä¸ºæ’å…¥tempåšå‡†å¤‡</span></span><br><span class="line">            a[j+<span class="number">1</span>] = a[j];</span><br><span class="line">        &#125;</span><br><span class="line">        a[low] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸Œå°”æ’åºï¼Œä¹Ÿç§° é€’å‡å¢é‡æ’åºï¼ŒO(n*(logn)^2)</span></span><br><span class="line"><span class="comment"> * å¯¹äºnä¸ªå…ƒç´ çš„åºåˆ—ï¼Œå‡è®¾å¢é‡ä¸ºincrement</span></span><br><span class="line"><span class="comment"> * ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯éš”incrementå–ä¸€ä¸ªå…ƒç´ ç»„æˆä¸€ä¸ªå­åºåˆ—</span></span><br><span class="line"><span class="comment"> * å¯¹æ¯ä¸ªå­åºåˆ—è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œincrement /= 2</span></span><br><span class="line"><span class="comment"> * é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³incrementä¸º1</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a å¾…æ’åºåºåˆ—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">shellSort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> length = a.length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// incrementä¸ºå¢é‡ï¼Œæ¯æ¬¡å‡ä¸ºåŸæ¥çš„ä¸€åŠï¼Œç›´è‡³ä¸º1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> increment = length / <span class="number">2</span>; increment &gt; <span class="number">0</span>; increment /= <span class="number">2</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…±incrementä¸ªç»„ï¼Œå¯¹æ¯ä¸€ç»„éƒ½æ‰§è¡Œç›´æ¥æ’å…¥æ’åº</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; increment; i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + increment; j &lt; length; j += increment) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å¦‚æœa[j] &lt; a[j-increment]ï¼Œåˆ™å¯»æ‰¾a[j]ä½ç½®ï¼Œå¹¶å°†åé¢æ•°æ®çš„ä½ç½®éƒ½åç§»ã€‚</span></span><br><span class="line">                <span class="keyword">if</span> (a[j] &lt; a[j - increment]) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">int</span> temp = a[j];</span><br><span class="line">                    <span class="keyword">int</span> k = j - increment;</span><br><span class="line">                    <span class="keyword">while</span> (k &gt;= <span class="number">0</span> &amp;&amp; a[k] &gt; temp) &#123;</span><br><span class="line">                        a[k + increment] = a[k];</span><br><span class="line">                        k -= increment;</span><br><span class="line">                    &#125;</span><br><span class="line">                    a[k + increment] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¡¶æ’åºï¼ˆåŸºæ•°æ’åºï¼‰"><a href="#æ¡¶æ’åºï¼ˆåŸºæ•°æ’åºï¼‰" class="headerlink" title="æ¡¶æ’åºï¼ˆåŸºæ•°æ’åºï¼‰"></a>æ¡¶æ’åºï¼ˆåŸºæ•°æ’åºï¼‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŸºæ•°æ’åºï¼Œä¹Ÿç§°æ¡¶æ’åºï¼ŒO(d(k+n))</span></span><br><span class="line"><span class="comment"> * åŸºæœ¬æ€æƒ³ï¼šå°†æ•´æ•°æŒ‰ä½æ•°åˆ‡å‰²æˆä¸åŒçš„æ•°å­—ï¼Œç„¶åæŒ‰æ¯ä¸ªä½æ•°åˆ†åˆ«æ¯”è¾ƒã€‚</span></span><br><span class="line"><span class="comment"> * å…·ä½“åšæ³•ï¼šå°†æ‰€æœ‰å¾…æ¯”è¾ƒæ•°å€¼ç»Ÿä¸€ä¸ºåŒæ ·çš„æ•°ä½é•¿åº¦ï¼Œæ•°ä½è¾ƒçŸ­çš„æ•°å‰é¢è¡¥é›¶ã€‚ç„¶åï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è¿›è¡Œä¸€æ¬¡æ’åºã€‚è¿™æ ·ä»æœ€ä½ä½æ’åºä¸€ç›´åˆ°æœ€é«˜ä½æ’åºå®Œæˆä»¥å, æ•°åˆ—å°±å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a å¾…æ’åºæ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> d ä½æ•°ï¼Œå¦‚æœæœ€å¤§æ•°ä¸º9527ï¼Œåˆ™dä¸º10000ï¼Œå¦‚æœä¸º7ï¼Œåˆ™dä¸º10</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">radixSort</span><span class="params">(<span class="keyword">int</span>[] a,<span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">1</span>;  <span class="comment">//ä»£è¡¨ä½æ•°å¯¹åº”çš„æ•°ï¼š1,10,100...</span></span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;  <span class="comment">//ä¿å­˜æ¯ä¸€ä½æ’åºåçš„ç»“æœç”¨äºä¸‹ä¸€ä½çš„æ’åºè¾“å…¥</span></span><br><span class="line">    <span class="keyword">int</span> length = a.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>[][] bucket = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>][length];  <span class="comment">//æ’åºæ¡¶ç”¨äºä¿å­˜æ¯æ¬¡æ’åºåçš„ç»“æœï¼Œè¿™ä¸€ä½ä¸Šæ’åºç»“æœç›¸åŒçš„æ•°å­—æ”¾åœ¨åŒä¸€ä¸ªæ¡¶é‡Œ</span></span><br><span class="line">    <span class="keyword">int</span>[] order = <span class="keyword">new</span> <span class="keyword">int</span>[length];  <span class="comment">//ç”¨äºä¿å­˜æ¯ä¸ªæ¡¶é‡Œæœ‰å¤šå°‘ä¸ªæ•°å­—</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(n &lt; d) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num : a) &#123; <span class="comment">//å°†æ•°ç»„arrayé‡Œçš„æ¯ä¸ªæ•°å­—æ”¾åœ¨ç›¸åº”çš„æ¡¶é‡Œ</span></span><br><span class="line">            <span class="keyword">int</span> digit = (num/n)%<span class="number">10</span>;</span><br><span class="line">            bucket[digit][order[digit]] = num;</span><br><span class="line">            order[digit]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>( ; i&lt;length; i++) &#123; <span class="comment">//å°†å‰ä¸€ä¸ªå¾ªç¯ç”Ÿæˆçš„æ¡¶é‡Œçš„æ•°æ®è¦†ç›–åˆ°åŸæ•°ç»„ä¸­ç”¨äºä¿å­˜è¿™ä¸€ä½çš„æ’åºç»“æœ</span></span><br><span class="line">            <span class="keyword">if</span>(order[i] != <span class="number">0</span>) &#123;  <span class="comment">//è¿™ä¸ªæ¡¶é‡Œæœ‰æ•°æ®ï¼Œä»ä¸Šåˆ°ä¸‹éå†è¿™ä¸ªæ¡¶å¹¶å°†æ•°æ®ä¿å­˜åˆ°åŸæ•°ç»„ä¸­</span></span><br><span class="line">                <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>( ; j &lt; order[i]; j++) &#123;</span><br><span class="line">                    a[k] = bucket[i][j];</span><br><span class="line">                    k++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            order[i]=<span class="number">0</span>;  <span class="comment">//å°†æ¡¶é‡Œè®¡æ•°å™¨ç½®0ï¼Œç”¨äºä¸‹ä¸€æ¬¡ä½æ’åº</span></span><br><span class="line">        &#125;</span><br><span class="line">        n *= <span class="number">10</span>;</span><br><span class="line">        k = <span class="number">0</span>;  <span class="comment">//å°†kç½®0ï¼Œç”¨äºä¸‹ä¸€è½®ä¿å­˜ä½æ’åºç»“æœ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å½’å¹¶æ’åºï¼ŒO(nlog(n))</span></span><br><span class="line"><span class="comment"> * å…¸å‹çš„åˆ†æ²»ç®—æ³•ï¼ŒæŠŠä¸€ä¸ªåºåˆ—çš„æ’åºåˆ†æˆä¸¤ä¸ªå­åºåˆ—çš„æ’åºï¼Œå¯¹å­åºåˆ—é‡å¤ä»¥ä¸Šæ“ä½œç›´è‡³åºåˆ—é•¿åº¦ä¸º1</span></span><br><span class="line"><span class="comment"> * ç„¶åˆå¹¶ä»¥ä¸Šåºåˆ—</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> left</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> right</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (left &lt; right) &#123;</span><br><span class="line">       <span class="keyword">int</span> center = (left + right) / <span class="number">2</span>;</span><br><span class="line">       mergeSort(array, left, center);</span><br><span class="line">       mergeSort(array, center+<span class="number">1</span>, right);</span><br><span class="line">       merge(array, left, center, right);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> low, <span class="keyword">int</span> mid, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] tempArray = <span class="keyword">new</span> <span class="keyword">int</span>[high - low + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> temp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> i = low;</span><br><span class="line">    <span class="keyword">int</span> j = mid + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= high) &#123;</span><br><span class="line">        <span class="keyword">if</span> (array[i] &lt;= array[j]) &#123;</span><br><span class="line">            tempArray[temp++] = array[i++];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tempArray[temp++] = array[j++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= mid) &#123;  <span class="comment">//æ­¤æ—¶å³è¾¹å·²åˆ°åº•</span></span><br><span class="line">        tempArray[temp++] = array[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j &lt;= high) &#123; <span class="comment">//æ­¤æ—¶å·¦è¾¹å·²åˆ°åº•</span></span><br><span class="line">        tempArray[temp++] = array[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å°†æ–°æ•°ç»„ä¸­çš„æ•° è¦†ç›–åŸæ•°ç»„lowä¹‹åçš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; tempArray.length; k++) &#123;</span><br><span class="line">        array[k+low] = tempArray[k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * é€‰æ‹©æ’åºï¼ŒO(n^2)</span></span><br><span class="line"><span class="comment">  * éå†æ•´ä¸ªåºåˆ—ï¼Œå°†æœ€å°çš„æ•°æ”¾åœ¨æœ€å‰é¢</span></span><br><span class="line"><span class="comment">  * éå†å‰©ä¸‹çš„åºåˆ—ï¼Œå°†æœ€å°çš„æ•°æ”¾åœ¨æœ€å‰é¢ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> a å¾…æ’åºåºåˆ—</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">selectSort</span><span class="params">(<span class="keyword">int</span>[] a)</span></span>&#123;</span><br><span class="line">     <span class="keyword">int</span> length = a.length;</span><br><span class="line">     <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">for</span>( ; i &lt; length; i++)&#123;  <span class="comment">//å¤–å±‚å¾ªç¯</span></span><br><span class="line">         <span class="keyword">int</span> temp = a[i];</span><br><span class="line">         <span class="keyword">int</span> position = i;</span><br><span class="line">         <span class="keyword">int</span> j = i+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">for</span>( ; j &lt; length; j++) &#123;  <span class="comment">//å¾€åéå†ï¼Œæ‰¾åˆ°æœ€å°çš„å€¼ä»¥åŠå…¶ä½ç½®</span></span><br><span class="line">             <span class="keyword">if</span>(a[j] &lt; temp) &#123;</span><br><span class="line">                 temp = a[j];</span><br><span class="line">                 position = j;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         a[position]=a[i];  <span class="comment">//è¿›è¡Œäº¤æ¢</span></span><br><span class="line">         a[i] = temp;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><h2 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¿«é€Ÿæ’åºï¼ŒO(nlog(n))</span></span><br><span class="line"><span class="comment"> * å¯¹å†’æ³¡æ’åºçš„æ”¹è¿›ï¼Œé€‰å–ä¸€ä¸ªè®°å½•ä½œä¸ºåŸºå‡†ï¼Œç»è¿‡ä¸€è¶Ÿæ’åºåï¼Œå°†æ•´æ®µåºåˆ—åˆ†æˆä¸¤éƒ¨åˆ†</span></span><br><span class="line"><span class="comment"> * å‰åŠéƒ¨åˆ†å°äºåŸºå‡†å€¼ï¼ŒååŠéƒ¨åˆ†å¤§äºåŸºå‡†å€¼ï¼Œç„¶åé€’å½’å‰ã€åä¸¤éƒ¨åˆ†ï¼Œç»§ç»­æ’åº</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a å¾…æ’åºåºåˆ—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> start åºåˆ—å¼€å§‹å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> end åºåˆ—ç»“æŸå€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> baseNum = a[start];</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">int</span> left = start;</span><br><span class="line">    <span class="keyword">int</span> right = end;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (a[left] &lt; baseNum &amp;&amp; left &lt; end) &#123;</span><br><span class="line">            left++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (a[right] &gt; baseNum &amp;&amp; right &gt; start) &#123;</span><br><span class="line">            right--;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (left &lt;= right) &#123;  <span class="comment">//å·¦è¾¹å‡ºç°å¤§äºåŸºå‡†å€¼æˆ–è€…å³è¾¹å‡ºç°å°äºåŸºå‡†å€¼ï¼Œä¸”left&lt;=right</span></span><br><span class="line">            temp = a[left];</span><br><span class="line">            a[left] = a[right];</span><br><span class="line">            a[right] = temp;</span><br><span class="line">            left++; right--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (left &lt;= right);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (start &lt; right) &#123;</span><br><span class="line">        quickSort(a, start, right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (end &gt; left) &#123;</span><br><span class="line">        quickSort(a, left, end);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒå‰æ ‘æ’åº"><a href="#äºŒå‰æ ‘æ’åº" class="headerlink" title="äºŒå‰æ ‘æ’åº"></a>äºŒå‰æ ‘æ’åº</h2><p>é€šè¿‡äºŒå‰æ ‘çš„ä¸­åºéå†å®ç°ã€‚å¦‚æœäºŒå‰æ’åºæ ‘æ˜¯å¹³è¡¡çš„ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸º $O(\log_2 n)$<br>è¿‘ä¼¼äºæŠ˜åŠæŸ¥æ‰¾ã€‚</p><p>å¦‚æœäºŒå‰æ’åºæ ‘å®Œå…¨ä¸å¹³è¡¡ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BinarySortTree</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Comparable data;</span><br><span class="line">        <span class="keyword">private</span> Node left;</span><br><span class="line">        <span class="keyword">private</span> Node right;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(Comparable data)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(Node newNode)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (newNode.data.compareTo(<span class="keyword">this</span>.data) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (left == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    left = newNode;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    left.addNode(newNode);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (right == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    right = newNode;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    right.addNode(newNode);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printNode</span><span class="params">()</span> </span>&#123;   <span class="comment">//ä¸­åºéå†</span></span><br><span class="line">            <span class="keyword">if</span> (left != <span class="keyword">null</span>) &#123;</span><br><span class="line">                left.printNode();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.data);</span><br><span class="line">            <span class="keyword">if</span> (right != <span class="keyword">null</span>) &#123;</span><br><span class="line">                right.printNode();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node root;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Comparable data)</span> </span>&#123;  <span class="comment">//å‘äºŒå‰æ ‘ä¸­æ’å…¥å…ƒç´ </span></span><br><span class="line">        Node node = <span class="keyword">new</span> Node(data);</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">            root = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            root.addNode(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        root.printNode();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è°ƒç”¨å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] a = &#123;<span class="number">12</span>,<span class="number">0</span>,<span class="number">34</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">456</span>&#125;;</span><br><span class="line">    BinarySortTree tree = <span class="keyword">new</span> BinarySortTree();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i : a) &#123;            </span><br><span class="line">        tree.add(i);</span><br><span class="line">    &#125;</span><br><span class="line">    tree.print();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æŸ¥æ‰¾ç®—æ³•"><a href="#æŸ¥æ‰¾ç®—æ³•" class="headerlink" title="æŸ¥æ‰¾ç®—æ³•"></a>æŸ¥æ‰¾ç®—æ³•</h2><h3 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h3><p>åªèƒ½å¯¹æœ‰åºåºåˆ—è¿›è¡ŒæŸ¥æ‰¾<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> low, <span class="keyword">int</span> high, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (low &gt; high) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = low + (high - low) / <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (array[mid] &gt; target)</span><br><span class="line">        <span class="keyword">return</span> binarySearch(array, low, mid - <span class="number">1</span>, target);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (array[mid] &lt; target)</span><br><span class="line">        <span class="keyword">return</span> binarySearch(array, mid + <span class="number">1</span>, high, target);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">bSearchWithoutRecursion</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> low = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> high = a.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = low + (high - low) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (a[mid] &gt; key)</span><br><span class="line">            high = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[mid] &lt; key)</span><br><span class="line">            low = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="é¡ºåºæŸ¥æ‰¾"><a href="#é¡ºåºæŸ¥æ‰¾" class="headerlink" title="é¡ºåºæŸ¥æ‰¾"></a>é¡ºåºæŸ¥æ‰¾</h3><p>å®ç°è¾ƒç®€å•ï¼Œç•¥è¿‡</p><h3 id="äºŒå‰æ ‘æŸ¥æ‰¾"><a href="#äºŒå‰æ ‘æŸ¥æ‰¾" class="headerlink" title="äºŒå‰æ ‘æŸ¥æ‰¾"></a>äºŒå‰æ ‘æŸ¥æ‰¾</h3><p>å¯ä»¥é€šè¿‡æ„å»ºä¸€ä¸ªäºŒå‰æœç´¢æ ‘å®ç°</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;æ’åºç®—æ³•ä¸€ç›´æ˜¯ç¨‹åºå‘˜å¼€å‘å’Œé¢è¯•çš„é‡ç‚¹ï¼Œæœ¬æ–‡å°†é‡ç‚¹è®²è§£å‡ ç§å¸¸ç”¨çš„æ’åºç®—æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://yoursite.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="ç®—æ³•" scheme="http://yoursite.com/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Android View çš„å·¥ä½œåŸç†</title>
    <link href="http://yoursite.com/Android-View-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/"/>
    <id>http://yoursite.com/Android-View-çš„å·¥ä½œåŸç†/</id>
    <published>2019-03-01T05:10:14.000Z</published>
    <updated>2019-03-16T06:22:16.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><a id="more"></a><h2 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h2><h2 id="ViewRoot-å’Œ-DecorView"><a href="#ViewRoot-å’Œ-DecorView" class="headerlink" title="ViewRoot å’Œ DecorView"></a>ViewRoot å’Œ DecorView</h2><h2 id="MeasureSpec"><a href="#MeasureSpec" class="headerlink" title="MeasureSpec"></a>MeasureSpec</h2><h2 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h2><h3 id="measure-è¿‡ç¨‹"><a href="#measure-è¿‡ç¨‹" class="headerlink" title="measure è¿‡ç¨‹"></a>measure è¿‡ç¨‹</h3><h3 id="layout-è¿‡ç¨‹"><a href="#layout-è¿‡ç¨‹" class="headerlink" title="layout è¿‡ç¨‹"></a>layout è¿‡ç¨‹</h3><h3 id="draw-è¿‡ç¨‹"><a href="#draw-è¿‡ç¨‹" class="headerlink" title="draw è¿‡ç¨‹"></a>draw è¿‡ç¨‹</h3><h2 id="è‡ªå®šä¹‰-View"><a href="#è‡ªå®šä¹‰-View" class="headerlink" title="è‡ªå®šä¹‰ View"></a>è‡ªå®šä¹‰ View</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="View" scheme="http://yoursite.com/tags/View/"/>
    
  </entry>
  
  <entry>
    <title>Android IPC æœºåˆ¶è¯¦è§£</title>
    <link href="http://yoursite.com/Android-IPC-%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3/"/>
    <id>http://yoursite.com/Android-IPC-æœºåˆ¶è¯¦è§£/</id>
    <published>2019-02-23T11:12:35.000Z</published>
    <updated>2019-03-23T04:53:10.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>IPCï¼ˆInter-Process Communicationï¼‰ï¼Œè¿›ç¨‹é—´é€šä¿¡æˆ–è€…è·¨è¿›ç¨‹é€šä¿¡ï¼ŒæŒ‡ä¸åŒçš„è¿›ç¨‹ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢çš„è¿‡ç¨‹ã€‚æŒ‰ç…§æ“ä½œç³»ç»Ÿçš„æè¿°ï¼Œè¿›ç¨‹æ˜¯æŒ‡ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œåœ¨ PC æˆ–ç§»åŠ¨è®¾å¤‡ä¸ŠæŒ‡ä¸€ä¸ªç¨‹åº/åº”ç”¨ã€‚å®¹æ˜“æ··æ·†çš„å¦ä¸€ä¸ªæ¦‚å¿µæ˜¯çº¿ç¨‹ï¼Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•å…ƒï¼Œå±äºæœ‰é™çš„ç³»ç»Ÿèµ„æºã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ã€‚<a id="more"></a></p><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>åªæœ‰åœ¨å¤šè¿›ç¨‹åœºæ™¯ä¸‹æ‰éœ€è¦ IPC æœºåˆ¶ã€‚</p><p>å¤šè¿›ç¨‹çš„æƒ…å†µåˆ†ä¸ºä¸¤ç§ã€‚ç¬¬ä¸€ç§æƒ…å†µæ˜¯åº”ç”¨å› ä¸ºæŸäº›åŸå› éœ€è¦é‡‡ç”¨å¤šè¿›ç¨‹æ¨¡å¼æ¥å®ç°ï¼Œæ¯”å¦‚ä¸€äº›æ¨¡å—ç”±äºç‰¹æ®ŠåŸå› éœ€è¦è¿è¡Œåœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­ã€ä¸ºäº†åŠ å¤§å¯ä½¿ç”¨çš„å†…å­˜éœ€è¦å¤šè¿›ç¨‹æ¥è·å–å¤šä»½å†…å­˜ç©ºé—´ï¼ˆAndroid å¯¹å•ä¸ªåº”ç”¨å¯ä½¿ç”¨çš„å†…å­˜åšäº†é™åˆ¶ï¼Œæ—©æœŸä¸º16MBï¼‰ï¼›ç¬¬äºŒç§æƒ…å†µåˆ™æ˜¯å½“å‰åº”ç”¨éœ€è¦å‘å…¶ä»–åº”ç”¨è·å–æ•°æ®ï¼Œæ¯”å¦‚ä½¿ç”¨ ContentProvider å»æŸ¥è¯¢æ•°æ®ã€‚</p><p>ä½¿ç”¨å¤šè¿›ç¨‹ä¼šé€ æˆå¦‚ä¸‹çš„é—®é¢˜ï¼š</p><ul><li>é™æ€æˆå‘˜å’Œå•ä¾‹æ¨¡å¼å®Œå…¨å¤±æ•ˆ</li><li>çº¿ç¨‹åŒæ­¥æœºåˆ¶å®Œå…¨å¤±æ•ˆ</li><li>SharedPreferences å¯é æ€§ä¸‹é™</li><li>Application ä¼šå¤šæ¬¡åˆ›å»º</li></ul><p>å¯¹äºç¬¬å››ç‚¹ï¼Œå½“ä¸€ä¸ªç»„ä»¶è·‘åœ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ä¸­ï¼Œç”±äºç³»ç»Ÿè¦åœ¨åˆ›å»ºæ–°çš„çº¿ç¨‹åŒæ—¶åˆ†é…è™šæ‹Ÿæœºï¼Œè¿™ä¸€è¿‡ç¨‹ç›¸å½“äºå¯åŠ¨ä¸€ä¸ªåº”ç”¨ï¼Œæ‰€ä»¥ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Applicationã€‚</p><h2 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h2><h3 id="Serializable-æ¥å£"><a href="#Serializable-æ¥å£" class="headerlink" title="Serializable æ¥å£"></a>Serializable æ¥å£</h3><p>Java æä¾›çš„ä¸€ä¸ªåºåˆ—åŒ–æ¥å£ï¼Œæ˜¯ä¸€ä¸ªç©ºæ¥å£ï¼Œä¸ºå¯¹è±¡æä¾›æ ‡å‡†çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œã€‚ä½¿ç”¨ Serializable å®ç°åºåˆ—åŒ–å¾ˆç®€å•ï¼Œåªéœ€è¦å®ç°æ¥å£ï¼Œæä¾›ä¸€ä¸ª<code>seriaVersionUID</code>å³å¯ï¼ˆä¸æä¾›ä¼šå¯¹ååºåˆ—åŒ–è¿‡ç¨‹äº§ç”Ÿå½±å“ï¼‰ï¼Œç³»ç»Ÿä¾¿ä¼šè‡ªåŠ¨å®Œæˆé»˜è®¤çš„åºåˆ—åŒ–è¿‡ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> seriaVersionUID = <span class="number">519067123721295773L</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åºåˆ—åŒ–è¿‡ç¨‹</span></span><br><span class="line">User user = <span class="keyword">new</span> User(<span class="string">"name"</span>, <span class="number">18</span>);</span><br><span class="line">ObjectOutputStream out = <span class="keyword">new</span> ObjectOutputStream(</span><br><span class="line">        <span class="keyword">new</span> FileOutputStream(<span class="string">"file.txt"</span>));</span><br><span class="line">out.writeObject(user);</span><br><span class="line">out.close</span><br><span class="line"></span><br><span class="line"><span class="comment">//ååºåˆ—åŒ–è¿‡ç¨‹</span></span><br><span class="line">ObjectInputStream in = <span class="keyword">new</span> ObjectInputStream(</span><br><span class="line">        <span class="keyword">new</span> FileInputStream(<span class="string">"file.txt"</span>));</span><br><span class="line">User user = (User) in.readObject();</span><br><span class="line">in.close</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Serializable å®ç°åºåˆ—åŒ–éœ€è¦æ³¨æ„ï¼Œstatic å’Œ transient å…³é”®å­—ä¿®é¥°çš„å˜é‡ä¸ä¼šè¢«åºåˆ—åŒ–ã€‚ä½¿ç”¨ static ä¿®é¥°çš„å˜é‡çš„å€¼å­˜å‚¨åœ¨ JVM ä¸­ã€‚</p><p>Java è¿˜æä¾›äº†å¦ä¸€ç§åºåˆ—åŒ–çš„æ–¹å¼ï¼šExternalizableæ¥å£ï¼Œè¯¥æ¥å£ç»§æ‰¿è‡ª Serializable è€Œä¸”ä¼˜å…ˆçº§æ›´é«˜ï¼Œä½¿ç”¨ä¹‹ååºåˆ—åŒ–çš„ç»†èŠ‚éœ€è¦å¼€å‘äººå‘˜è‡ªå·±å®ç°ï¼ŒåŒæ—¶ transient å…³é”®å­—å°†å¤±å»ä½œç”¨ã€‚</p><h3 id="Parcelable-æ¥å£"><a href="#Parcelable-æ¥å£" class="headerlink" title="Parcelable æ¥å£"></a>Parcelable æ¥å£</h3><p>Android å®˜æ–¹æä¾›çš„åºåˆ—åŒ–æ¥å£ï¼Œå®ç°æ¥å£ä¹‹åï¼Œç±»çš„å¯¹è±¡å³å¯è¿›è¡Œä¸€ä¸ªâ€œä»å¯¹è±¡å­˜å‚¨ä¸º Parcel ï¼Œ ä» Parcel è¯»å–ä¸ºå¯¹è±¡â€çš„è¯»å†™è¿‡ç¨‹ã€‚Parcel åŒ…è£…äº†å¯åºåˆ—åŒ–çš„æ•°æ®ï¼Œå¯ä»¥åœ¨Binderä¸­è‡ªç”±ä¼ è¾“ã€‚</p><p>å…¶ä¸ Serializable çš„åŒºåˆ«åœ¨äº</p><ul><li>Parcelable ä½¿ç”¨æ›´å¤æ‚ï¼Œåè€…å¦‚ä¸Šé¢çš„ä»£ç ï¼Œè¶³å¤Ÿç®€æ´ã€‚</li><li>ä½¿ç”¨å†…å­˜æ—¶ï¼ŒParcelable æ¯” Serializable æ€§èƒ½é«˜ï¼Œå› ä¸º Serializable åºåˆ—åŒ–çš„æ—¶å€™ä¼šäº§ç”Ÿå¤§é‡ä¸´æ—¶å˜é‡ï¼Œå¼•èµ·é¢‘ç¹çš„GCã€‚</li><li>ä½¿ç”¨æœ¬åœ°å­˜å‚¨çš„æ—¶å€™ï¼ŒSerializable æ›´æœ‰ä¿éšœæ€§ï¼Œå› ä¸º Parcelable åœ¨å¤–ç•Œæœ‰å˜åŒ–çš„æƒ…å†µä¸‹ä¸èƒ½å¾ˆå¥½çš„ä¿è¯æ•°æ®çš„æŒç»­æ€§ã€‚</li></ul><p>æ ‡å‡†å†™æ³•å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Parcelable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">User</span><span class="params">(Parcel in)</span> </span>&#123;</span><br><span class="line">        name = in.readString();</span><br><span class="line">        id = in.readInt();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        å®ä¾‹åŒ–é™æ€å˜é‡CREATOR</span></span><br><span class="line"><span class="comment">        ä»Parcelä¸­æ„é€ ä¸€ä¸ªå®ç°äº†Parcelableçš„ç±»çš„å®ä¾‹,Parcelæ¥è‡ªwriteToParcelæ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Creator&lt;User&gt; CREATOR = <span class="keyword">new</span> Creator&lt;User&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> User <span class="title">createFromParcel</span><span class="params">(Parcel in)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> User(in);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> User[] newArray(<span class="keyword">int</span> size) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> User[size];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">describeContents</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span><span class="params">(Parcel dest, <span class="keyword">int</span> flags)</span> </span>&#123;</span><br><span class="line">        dest.writeString(name);</span><br><span class="line">        dest.writeInt(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡ Intent ä¼ é€’å’Œè·å–æ•°æ®<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¼ é€’</span></span><br><span class="line">User user = <span class="keyword">new</span> User(<span class="string">"Name"</span>, <span class="number">18</span>);</span><br><span class="line">Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">intent.putExtra(<span class="string">"data"</span>, user);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨</span></span><br><span class="line">User user = getIntent().getParcelableExtra(<span class="string">"data"</span>);</span><br></pre></td></tr></table></figure></p><h3 id="Binder"><a href="#Binder" class="headerlink" title="Binder"></a>Binder</h3><p>Binder æ˜¯ä¸€ä¸ªå®ç°äº† IBinder æ¥å£çš„ç±»ã€‚ä» IPC è§’åº¦ï¼ŒBinder æ˜¯ Android ä¸­çš„ä¸€ç§è·¨è¿›ç¨‹é€šä¿¡æ–¹å¼ï¼ŒBinder è¿˜å¯ä»¥ç†è§£ä¸ºä¸€ç§è™šæ‹Ÿçš„ç‰©ç†è®¾å¤‡ï¼Œå®ƒçš„è®¾å¤‡é©±åŠ¨æ˜¯/dev/binderï¼Œè¯¥é€šä¿¡æ–¹å¼åœ¨ Linux ä¸­æ²¡æœ‰ã€‚</p><ul><li>ä» Android Framework è§’åº¦ï¼ŒBinder æ˜¯ ServiceManager è¿æ¥å„ç§ Manager(ActivityManagerã€WindowManager ç­‰ç­‰)å’Œç›¸åº” ManagerService çš„æ¡¥æ¢ã€‚</li><li>ä» Android åº”ç”¨å±‚è§’åº¦ï¼ŒBinder æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿›è¡Œé€šä¿¡çš„åª’ä»‹ï¼Œå½“æˆ‘ä»¬ bindService çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›ä¸€ä¸ªåŒ…å«äº†æœåŠ¡ç«¯ä¸šåŠ¡è°ƒç”¨çš„ Binder å¯¹è±¡ï¼Œå®¢æˆ·ç«¯é€šè¿‡å®ƒè·å–æœåŠ¡ç«¯æä¾›çš„æœåŠ¡ï¼ˆæ™®é€šæœåŠ¡å’ŒåŸºäº AIDL çš„æœåŠ¡ï¼‰æˆ–è€…æ•°æ®ã€‚</li></ul><p>æ›´å¤šå…³äº Binderï¼š<a href="https://www.cnblogs.com/samchen2009/p/3316001.html" target="_blank" rel="noopener">å›¾è§£Android - Binder å’Œ Service</a></p><h2 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h2><h3 id="Bundle"><a href="#Bundle" class="headerlink" title="Bundle"></a>Bundle</h3><p>Bundle å¯ä»¥åœ¨å››å¤§ç»„ä»¶ä¹‹é—´é€šè¿‡ Intent ä¼ é€’æ•°æ®ï¼Œå®ƒæœ¬èº«å®ç°äº† Parcelable æ¥å£ï¼Œèƒ½å¤Ÿå­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹ã€Stringã€å®ç°äº† Parcelable çš„å¯¹è±¡ä»¥åŠä»¥ä¸Šç±»å‹çš„æ•°ç»„ã€‚</p><h3 id="æ–‡ä»¶å…±äº«"><a href="#æ–‡ä»¶å…±äº«" class="headerlink" title="æ–‡ä»¶å…±äº«"></a>æ–‡ä»¶å…±äº«</h3><p>åˆ©ç”¨å¤šè¿›ç¨‹åŒæ—¶è¯»å†™åŒä¸ªå¤–éƒ¨æ–‡ä»¶è¾¾åˆ°æ˜¯æ•°æ®äº¤äº’çš„ç›®çš„ã€‚å­˜å‚¨å½¢å¼æ²¡æœ‰é™åˆ¶ï¼Œå¯ä»¥æ˜¯ XMLã€æ–‡æœ¬ã€å¯¹è±¡åºåˆ—åŒ–ç­‰ç­‰ã€‚</p><p>ç¼ºç‚¹åœ¨äºï¼ŒLinux ç³»ç»Ÿå¯¹æ–‡ä»¶å¹¶å‘è¯»å†™æ²¡æœ‰é™åˆ¶ï¼Œä¼šå¯¼è‡´æ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ï¼Œæ‰€ä»¥è¯¥æ–¹å¼åªé€‚åˆäºå¯¹æ•°æ®åŒæ­¥è¦æ±‚ä¸é«˜çš„è¿›ç¨‹é—´é€šä¿¡ã€‚</p><h3 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h3><p>Socketä¹Ÿç§°ä¸ºâ€œå¥—æ¥å­—â€ï¼Œæ˜¯ç½‘ç»œé€šä¿¡ä¸­çš„æ¦‚å¿µï¼Œå®ƒåˆ†ä¸ºæµå¼å¥—æ¥å­—å’Œç”¨æˆ·æ•°æ®å¥—æ¥å­—ä¸¤ç§ï¼Œåˆ†åˆ«åº”äºç½‘ç»œçš„ä¼ è¾“æ§åˆ¶å±‚ä¸­çš„TCPå’ŒUDPåè®®ã€‚</p><h3 id="AIDL"><a href="#AIDL" class="headerlink" title="AIDL"></a>AIDL</h3><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>Android Interface Definition Languageï¼ŒAndroid æ¥å£å®šä¹‰è¯­è¨€ã€‚</p><ul><li><p>æ•°æ®ç±»å‹ï¼šä½œä¸ºä¸€é—¨â€œè¯­è¨€â€ï¼Œå®ƒæœ‰ä¸€äº›ä¸ Java ä¸åŒçš„åœ°æ–¹ã€‚é™¤äº†åŸºæœ¬æ•°æ®ç±»å‹ã€String å’Œ CharSequence ä¹‹å¤–ï¼Œä½¿ç”¨å…¶ä»–çš„æ•°æ®ç±»å‹éƒ½éœ€è¦æ˜¾å¼å¯¼å…¥ï¼Œæ— è®º aidl æ¥å£æ˜¯å¦ä¸ç›®æ ‡ç±»åœ¨åŒä¸€ä¸ªåŒ…ä¸­ã€‚å…¶æ”¯æŒçš„æ•°æ®ç±»å‹å¦‚ä¸‹</p><blockquote><p>Java ä¸­çš„å…«ç§åŸºæœ¬æ•°æ®ç±»å‹ã€Stringã€CharSequenceã€‚<br></p><p>Listç±»å‹ï¼šå…¶ä¸­çš„å…ƒç´ å¿…é¡»æ˜¯AIDLæ”¯æŒçš„ç±»å‹ä¹‹ä¸€ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå…¶ä»–AIDLç”Ÿæˆçš„æ¥å£ï¼Œæˆ–è€…æ˜¯å®šä¹‰çš„ Parcelable ç±»å‹ã€‚Listå¯ä»¥ä½¿ç”¨æ³›å‹ã€‚<br></p><p>Mapç±»å‹ï¼šå…¶ä¸­çš„å…ƒç´ å¿…é¡»æ˜¯AIDLæ”¯æŒçš„ç±»å‹ä¹‹ä¸€ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå…¶ä»–AIDLç”Ÿæˆçš„æ¥å£ï¼Œæˆ–è€…æ˜¯å®šä¹‰çš„parcelableã€‚Mapä¸æ”¯æŒæ³›å‹ã€‚<br></p></blockquote></li><li><p>å®šå‘tagï¼šAIDL ä¸­çš„å®šå‘ tag è¡¨ç¤ºäº†åœ¨è·¨è¿›ç¨‹é€šä¿¡ä¸­æ•°æ®çš„æµå‘ï¼Œå…¶ä¸­ in è¡¨ç¤ºæ•°æ®åªèƒ½ç”±å®¢æˆ·ç«¯æµå‘æœåŠ¡ç«¯ï¼Œ out è¡¨ç¤ºæ•°æ®åªèƒ½ç”±æœåŠ¡ç«¯æµå‘å®¢æˆ·ç«¯ï¼Œè€Œ inout åˆ™è¡¨ç¤ºæ•°æ®å¯åœ¨æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´åŒå‘æµé€šã€‚å…¶ä¸­ï¼Œæ•°æ®æµå‘æ˜¯é’ˆå¯¹åœ¨å®¢æˆ·ç«¯ä¸­çš„é‚£ä¸ªä¼ å…¥æ–¹æ³•çš„å¯¹è±¡è€Œè¨€çš„ã€‚</p><blockquote><p>in ä¸ºå®šå‘ tag æ—¶ï¼Œè¡¨ç°ä¸ºæœåŠ¡ç«¯å°†ä¼šæ¥æ”¶åˆ°ä¸€ä¸ªå¯¹è±¡çš„å®Œæ•´æ•°æ®ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çš„å¯¹è±¡ä¸ä¼šå› ä¸ºæœåŠ¡ç«¯å¯¹ä¼ å‚çš„ä¿®æ”¹è€Œå‘ç”Ÿå˜åŠ¨ï¼›<br>out ä¸ºå®šå‘ tag æ—¶ï¼Œè¡¨ç°ä¸ºæœåŠ¡ç«¯å°†ä¼šæ¥æ”¶åˆ°å¯¹è±¡çš„çš„ç©ºå¯¹è±¡ï¼Œä½†æ˜¯åœ¨æœåŠ¡ç«¯å¯¹æ¥æ”¶åˆ°çš„ç©ºå¯¹è±¡æœ‰ä»»ä½•ä¿®æ”¹ä¹‹åï¼Œå®¢æˆ·ç«¯å°†ä¼šåŒæ­¥å˜åŠ¨ï¼›<br>inout ä¸ºå®šå‘ tag æ—¶ï¼ŒæœåŠ¡ç«¯å°†ä¼šæ¥æ”¶åˆ°å®¢æˆ·ç«¯ä¼ æ¥å¯¹è±¡çš„å®Œæ•´ä¿¡æ¯ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å°†ä¼šåŒæ­¥æœåŠ¡ç«¯å¯¹è¯¥å¯¹è±¡çš„ä»»ä½•å˜åŠ¨ã€‚</p></blockquote></li></ul><p>å…³äºæ›´å¤šï¼š<a href="https://blog.csdn.net/luoyanglizi/article/details/51958091" target="_blank" rel="noopener">ä½ çœŸçš„ç†è§£AIDLä¸­çš„inï¼Œoutï¼Œinoutä¹ˆ?</a></p><ul><li>ä¸¤ç§ç±»å‹ï¼šæ‰€æœ‰çš„ AIDL æ–‡ä»¶å¯åˆ†ä¸ºä¸¤ç±»ã€‚ä¸€ç±»å®šä¹‰ Parcelable å¯¹è±¡ï¼Œä»¥ä¾›å…¶ä»– AIDL æ–‡ä»¶ä½¿ç”¨éé»˜è®¤æ”¯æŒçš„æ•°æ®ç±»å‹ã€‚ä¸€ç±»å®šä¹‰æ–¹æ³•æ¥å£ï¼Œä»¥ä¾›ç³»ç»Ÿå®Œæˆè·¨è¿›ç¨‹é€šä¿¡ã€‚<br>å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ç±»æ–‡ä»¶éƒ½æ˜¯åœ¨â€œå®šä¹‰â€ï¼Œè€Œä¸æ¶‰åŠå…·ä½“çš„å®ç°ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒå«åšâ€œAndroid æ¥å£å®šä¹‰è¯­è¨€â€ã€‚<br>æ³¨ï¼šæ‰€æœ‰çš„éé»˜è®¤æ”¯æŒæ•°æ®ç±»å‹å¿…é¡»é€šè¿‡ç¬¬ä¸€ç±» AIDL æ–‡ä»¶å®šä¹‰æ‰èƒ½è¢«ä½¿ç”¨ã€‚</li></ul><h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>ç¬¬ä¸€ç±» AIDL æ–‡ä»¶ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Book.aidl</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨æ˜¯å¼•å…¥äº†ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ Book ä¾›å…¶ä»–çš„AIDLæ–‡ä»¶ä½¿ç”¨</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šBook.aidl ä¸ Book.javaçš„åŒ…ååº”å½“æ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="keyword">package</span> com.febers.aidldemo;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„parcelableæ˜¯å°å†™</span></span><br><span class="line">parcelable Book;</span><br></pre></td></tr></table></figure></p><blockquote><p>è‡ªå®šä¹‰ Parcelable å¯¹è±¡åªæ”¯æŒä¸º in çš„å®šå‘ tag ã€‚åŸå› åœ¨äºç”Ÿæˆçš„ç±»ä¸­åªæœ‰ <code>writeToParcel</code>æ–¹æ³•ï¼Œè€Œå¦‚æœè¦æ”¯æŒä¸º out æˆ–è€… inout çš„å®šå‘ tagï¼Œè¿˜éœ€è¦å®ç°<code>readFromParcel</code>æ–¹æ³•ï¼Œè€Œè¯¥æ–¹æ³•å¹¶æ²¡æœ‰åœ¨ Parcelable æ¥å£ä¸­å®šä¹‰ï¼Œéœ€è¦æˆ‘ä»¬ä»å¤´å†™ã€‚</p></blockquote><p>ç¬¬äºŒç±» AIDL æ–‡ä»¶ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BookManager.aidl</span></span><br><span class="line"><span class="keyword">package</span> com.lypeer.ipcclient;</span><br><span class="line"><span class="comment">//å¯¼å…¥æ‰€éœ€è¦ä½¿ç”¨çš„éé»˜è®¤æ”¯æŒæ•°æ®ç±»å‹çš„åŒ…</span></span><br><span class="line"><span class="keyword">import</span> com.febers.aidldemo.Book;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">BookManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰€æœ‰çš„è¿”å›å€¼å‰éƒ½ä¸éœ€è¦åŠ ä»»ä½•ä¸œè¥¿ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹</span></span><br><span class="line">    <span class="function">List&lt;Book&gt; <span class="title">getBooks</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Book <span class="title">getBook</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getBookCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¼ å‚æ—¶ï¼ŒJavaåŸºæœ¬æ•°æ®ç±»å‹ã€String ä»¥åŠ CharSequence ä¹‹å¤–çš„ç±»å‹</span></span><br><span class="line">    <span class="comment">//éƒ½éœ€è¦åœ¨å‰é¢åŠ ä¸Šå®šå‘tagï¼Œå…·ä½“åŠ ä»€ä¹ˆé‡éœ€è€Œå®š</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setBookPrice</span><span class="params">(in Book book , <span class="keyword">int</span> price)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">void</span> <span class="title">setBookName</span><span class="params">(in Book book , String name)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">void</span> <span class="title">addBookIn</span><span class="params">(in Book book)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addBookOut</span><span class="params">(out Book book)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addBookInout</span><span class="params">(inout Book book)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®Œæˆä¸Šé¢çš„æ­¥éª¤ä¹‹åï¼Œ<code>build</code>é¡¹ç›®ï¼Œç¼–è¯‘å™¨å°±ä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆç›¸åº”çš„ BookManager ç±»ã€‚æ­¤æ—¶å°±å¯ä»¥å¼€å§‹æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯çš„ä»£ç ç¼–å†™ã€‚</p><p>æœåŠ¡ç«¯<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AIDLService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> String TAG = <span class="keyword">this</span>.getClass().getSimpleName();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åŒ…å«Bookå¯¹è±¡çš„list</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Book&gt; mBooks = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”±AIDLæ–‡ä»¶ç”Ÿæˆçš„BookManager</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BookManager.Stub mBookManager = <span class="keyword">new</span> BookManager.Stub() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">getBooks</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">                Log.e(TAG, <span class="string">"invoking getBooks() method , now the list is : "</span> + mBooks.toString());</span><br><span class="line">                <span class="keyword">if</span> (mBooks != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> mBooks;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">(Book book)</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mBooks == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    mBooks = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (book == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    Log.e(TAG, <span class="string">"Book is null in In"</span>);</span><br><span class="line">                    book = <span class="keyword">new</span> Book();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//å°è¯•ä¿®æ”¹bookçš„å‚æ•°ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§‚å¯Ÿå…¶åˆ°å®¢æˆ·ç«¯çš„åé¦ˆ</span></span><br><span class="line">                book.setPrice(<span class="number">2333</span>);</span><br><span class="line">                <span class="keyword">if</span> (!mBooks.contains(book)) &#123;</span><br><span class="line">                    mBooks.add(book);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//æ‰“å°mBooksåˆ—è¡¨ï¼Œè§‚å¯Ÿå®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„å€¼</span></span><br><span class="line">                Log.e(TAG, <span class="string">"invoking addBooks() method , now the list is : "</span> + mBooks.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        Book book = <span class="keyword">new</span> Book();</span><br><span class="line">        book.setName(<span class="string">"Androidå¼€å‘è‰ºæœ¯æ¢ç´¢"</span>);</span><br><span class="line">        book.setPrice(<span class="number">28</span>);</span><br><span class="line">        mBooks.add(book);   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        Log.e(getClass().getSimpleName(), String.format(<span class="string">"on bind,intent = %s"</span>, intent.toString()));</span><br><span class="line">        <span class="keyword">return</span> mBookManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®¢æˆ·ç«¯<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AIDLActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”±AIDLæ–‡ä»¶ç”Ÿæˆçš„ Java ç±»</span></span><br><span class="line">    <span class="keyword">private</span> BookManager mBookManager = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ‡å¿—å½“å‰ä¸æœåŠ¡ç«¯è¿æ¥çŠ¶å†µçš„å¸ƒå°”å€¼ï¼Œfalseä¸ºæœªè¿æ¥ï¼Œtrueä¸ºè¿æ¥ä¸­</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> mBound = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åŒ…å«Bookå¯¹è±¡çš„list</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Book&gt; mBooks;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_aidl);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»ä¹‹åè°ƒç”¨æœåŠ¡ç«¯çš„addBookInæ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> view</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¦‚æœä¸æœåŠ¡ç«¯çš„è¿æ¥å¤„äºæœªè¿æ¥çŠ¶æ€ï¼Œåˆ™å°è¯•è¿æ¥</span></span><br><span class="line">        <span class="keyword">if</span> (!mBound) &#123;</span><br><span class="line">            attemptToBindService();</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"å½“å‰ä¸æœåŠ¡ç«¯å¤„äºæœªè¿æ¥çŠ¶æ€ï¼Œæ­£åœ¨å°è¯•é‡è¿ï¼Œè¯·ç¨åå†è¯•"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mBookManager == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        Book book = <span class="keyword">new</span> Book();</span><br><span class="line">        book.setName(<span class="string">"APPç ”å‘å½•In"</span>);</span><br><span class="line">        book.setPrice(<span class="number">30</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mBookManager.addBook(book);</span><br><span class="line">            Log.e(getLocalClassName(), book.toString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°è¯•ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">attemptToBindService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">        intent.setAction(<span class="string">"com.febers.aidl"</span>);</span><br><span class="line">        intent.setPackage(<span class="string">"com.febers.aidldemo"</span>);</span><br><span class="line">        bindService(intent, mServiceConnection, Context.BIND_AUTO_CREATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart();</span><br><span class="line">        <span class="keyword">if</span> (!mBound) &#123;</span><br><span class="line">            attemptToBindService();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStop();</span><br><span class="line">        <span class="keyword">if</span> (mBound) &#123;</span><br><span class="line">            unbindService(mServiceConnection);</span><br><span class="line">            mBound = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ServiceConnection mServiceConnection = <span class="keyword">new</span> ServiceConnection() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceConnected</span><span class="params">(ComponentName name, IBinder service)</span> </span>&#123;</span><br><span class="line">            Log.e(getLocalClassName(), <span class="string">"service connected"</span>);</span><br><span class="line">            mBookManager = BookManager.Stub.asInterface(service);</span><br><span class="line">            mBound = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (mBookManager != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    mBooks = mBookManager.getBooks();</span><br><span class="line">                    Log.e(getLocalClassName(), mBooks.toString());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceDisconnected</span><span class="params">(ComponentName name)</span> </span>&#123;</span><br><span class="line">            Log.e(getLocalClassName(), <span class="string">"service disconnected"</span>);</span><br><span class="line">            mBound = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å½“ç„¶ä¸è¦å¿˜è®°åœ¨ Manifest æ–‡ä»¶ä¸­æ³¨å†Œ Serviceã€‚<br>æ§åˆ¶å°æ˜¾ç¤ºä¿¡æ¯å¦‚ä¸‹ï¼š</p><blockquote><p>//æœåŠ¡ç«¯çš„ log ä¿¡æ¯<br><br>1ï¼Œon bind,intent = Intent { act=com.lypeer.aidl pkg=com.lypeer.ipcserver }<br><br>2ï¼Œinvoking getBooks() method , now the list is : [name : Androidå¼€å‘è‰ºæœ¯æ¢ç´¢ , price : 28]<br><br>3ï¼Œinvoking addBooks() method , now the list is : [name : Androidå¼€å‘è‰ºæœ¯æ¢ç´¢ , price : 28, name : APPç ”å‘å½•In , price : 2333]</p></blockquote><blockquote><p>//å®¢æˆ·ç«¯çš„ log ä¿¡æ¯<br><br>1ï¼Œservice connected<br><br>2ï¼Œ[name : Androidå¼€å‘è‰ºæœ¯æ¢ç´¢ , price : 28]<br><br>3ï¼Œname : APPç ”å‘å½•In , price : 2333</p></blockquote><h3 id="Messager"><a href="#Messager" class="headerlink" title="Messager"></a>Messager</h3><p>Messager åº•å±‚ä½¿ç”¨äº† AIDL æ–¹å¼ã€‚å’Œ AIDL ä¸åŒçš„æ˜¯ï¼ŒMessager åˆ©ç”¨ Handler å½¢å¼å¤„ç†æ¶ˆæ¯çš„æ¥æ”¶å‘é€ï¼Œå› æ­¤æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™ä¹Ÿè¡¨ç¤ºå®ƒä¸æ”¯æŒå¹¶å‘å¤„ç†ï¼›è€Œ AIDL æ–¹å¼æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œæ”¯æŒå¹¶å‘å¤„ç†ï¼Œå› æ­¤ä½¿ç”¨ AIDL æ–¹å¼æ—¶éœ€è¦ä¿è¯ä»£ç çš„çº¿ç¨‹å®‰å…¨ã€‚</p><h4 id="æ¦‚å¿µ-1"><a href="#æ¦‚å¿µ-1" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>Messenger æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œåˆ†è´ä»¥ Handler å’Œ Binder ä¸ºå‚æ•°<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> IMessenger mTarget;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Messenger</span><span class="params">(Handler target)</span> </span>&#123;</span><br><span class="line">    mTarget = target.getIMessenger();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Messenger</span><span class="params">(IBinder target)</span> </span>&#123;</span><br><span class="line">    mTarget = IMessenger.Stub.asInterface(target);    <span class="comment">//å’Œå‰é¢çš„ AIDL å¾ˆç›¸ä¼¼å§</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>Handler.getIMessenger</code>æºç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> IMessenger <span class="title">getIMessenger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (mQueue) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mMessenger != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> mMessenger;</span><br><span class="line">        &#125;</span><br><span class="line">        mMessenger = <span class="keyword">new</span> MessengerImpl();</span><br><span class="line">        <span class="keyword">return</span> mMessenger;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>IMessenger æ˜¯ AIDL ç”Ÿæˆçš„è·¨è¿›ç¨‹æ¥å£ï¼Œé‡Œé¢å®šä¹‰äº†ä¸€ä¸ªå‘é€æ¶ˆæ¯çš„æ–¹æ³•<code>send(android.os.Message msg)</code>ã€‚Handler ä¸­ MessengerImpl å®ç°äº†è¯¥æ–¹æ³•ï¼Œä½¿ç”¨ Handler å°†æ¶ˆæ¯å‘å‡ºå»ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MessengerImpl</span> <span class="keyword">extends</span> <span class="title">IMessenger</span>.<span class="title">Stub</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">        msg.sendingUid = Binder.getCallingUid();</span><br><span class="line">        Handler.<span class="keyword">this</span>.sendMessage(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>Handler.handlerMessage</code>æ¥æ”¶æ¶ˆæ¯ã€‚Messenger ä¸­å¯¹<code>send</code>çš„å®ç°å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(Message message)</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">    mTarget.send(message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Messenger ä¸­æŒæœ‰ä¸€ä¸ª IMessenger çš„å¼•ç”¨ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­å¯ä»¥é€šè¿‡ Handler æˆ–è€… Binder çš„å½¢å¼è·å¾—æœ€ç»ˆçš„å®ç°ï¼Œå†…éƒ¨<code>send</code>æ–¹æ³•å®é™…ä¸Šæ˜¯è°ƒç”¨ IMessenger å®ç°çš„<code>send</code>æ–¹æ³•ã€‚</p><p>Messenger æ˜¯ AIDL çš„ç®€åŒ–ç‰ˆï¼ŒæŠŠæ¥å£éƒ½å°è£…å¥½ï¼Œå¼€å‘è€…åªéœ€åœ¨ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºä¸€ä¸ª Handler ä¼ é€’ç»™ Messengerï¼ŒMessenger çš†å¯ä»¥æŠŠæ¶ˆæ¯è·¨è¿›ç¨‹ä¼ é€’åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œåœ¨å¦ä¸€ä¸ªè¿›ç¨‹çš„ Handler åœ¨å¤„ç†æ¶ˆæ¯å°±å¯ä»¥ã€‚</p><h4 id="å®ç°-1"><a href="#å®ç°-1" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>æœåŠ¡ç«¯<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessengerService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String TAG = <span class="keyword">this</span>.getClass().getSimpleName();</span><br><span class="line"></span><br><span class="line">    Messenger mMessenger = <span class="keyword">new</span> Messenger(<span class="keyword">new</span> Handler() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(<span class="keyword">final</span> Message msg)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (msg != <span class="keyword">null</span> &amp;&amp; msg.arg1 == <span class="number">9527</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (msg.getData() == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                String content = (String) msg.getData().get(<span class="string">"MSG_CONTENT"</span>);  <span class="comment">//æ¥æ”¶å®¢æˆ·ç«¯çš„æ¶ˆæ¯</span></span><br><span class="line">                Log.e(TAG, <span class="string">"Message from client: "</span> + content);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å›å¤æ¶ˆæ¯ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">                Message replyMsg = Message.obtain();</span><br><span class="line">                replyMsg.arg1 = <span class="number">9528</span>;</span><br><span class="line">                Bundle bundle = <span class="keyword">new</span> Bundle();</span><br><span class="line">                bundle.putString(<span class="string">"MSG_CONTENT"</span>, <span class="string">"å·²æ”¶åˆ°æ¶ˆæ¯"</span>);</span><br><span class="line">                replyMsg.setData(bundle);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    msg.replyTo.send(replyMsg);     <span class="comment">//å›ä¿¡</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(<span class="keyword">final</span> Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mMessenger.getBinder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®¢æˆ·ç«¯ä»£ç ç‰‡æ®µ<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessagerActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Messenger mClientMessenger = <span class="keyword">new</span> Messenger(<span class="keyword">new</span> Handler() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(<span class="keyword">final</span> Message msg)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (msg != <span class="keyword">null</span> &amp;&amp; msg.arg1 == <span class="number">9528</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span> (msg.getData() == <span class="keyword">null</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String content = (String) msg.getData().get(<span class="string">"MSG_CONTENT"</span>);</span><br><span class="line">                Log.e(TAG, <span class="string">"Message from server: "</span> + content);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æœåŠ¡ç«¯çš„ Messenger</span></span><br><span class="line">    <span class="keyword">private</span> Messenger mServerMessenger;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ServiceConnection mMessengerConnection = <span class="keyword">new</span> ServiceConnection() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceConnected</span><span class="params">(<span class="keyword">final</span> ComponentName name, <span class="keyword">final</span> IBinder service)</span> </span>&#123;</span><br><span class="line">            mServerMessenger = <span class="keyword">new</span> Messenger(service);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceDisconnected</span><span class="params">(<span class="keyword">final</span> ComponentName name)</span> </span>&#123;</span><br><span class="line">            mServerMessenger = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String msgContent = <span class="string">"æ¶ˆæ¯"</span>ï¼›</span><br><span class="line"></span><br><span class="line">        Message message = Message.obtain();</span><br><span class="line">        message.arg1 = <span class="number">9527</span>;</span><br><span class="line">        Bundle bundle = <span class="keyword">new</span> Bundle();</span><br><span class="line">        bundle.putString(<span class="string">"MSG_CONTENT"</span>, msgContent);</span><br><span class="line">        message.setData(bundle);</span><br><span class="line">        message.replyTo = mClientMessenger;     <span class="comment">//æŒ‡å®šå›ä¿¡äººæ˜¯å®¢æˆ·ç«¯å®šä¹‰çš„</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mServerMessenger.send(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ContentProvider"><a href="#ContentProvider" class="headerlink" title="ContentProvider"></a>ContentProvider</h3><p>ä¸»è¦ç”¨äºä¸åŒçš„åº”ç”¨ç¨‹åºä¹‹é—´å®ç°æ•°æ®å…±äº«åŠŸèƒ½</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;IPCï¼ˆInter-Process Communicationï¼‰ï¼Œè¿›ç¨‹é—´é€šä¿¡æˆ–è€…è·¨è¿›ç¨‹é€šä¿¡ï¼ŒæŒ‡ä¸åŒçš„è¿›ç¨‹ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢çš„è¿‡ç¨‹ã€‚æŒ‰ç…§æ“ä½œç³»ç»Ÿçš„æè¿°ï¼Œè¿›ç¨‹æ˜¯æŒ‡ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œåœ¨ PC æˆ–ç§»åŠ¨è®¾å¤‡ä¸ŠæŒ‡ä¸€ä¸ªç¨‹åº/åº”ç”¨ã€‚å®¹æ˜“æ··æ·†çš„å¦ä¸€ä¸ªæ¦‚å¿µæ˜¯çº¿ç¨‹ï¼Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•å…ƒï¼Œå±äºæœ‰é™çš„ç³»ç»Ÿèµ„æºã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="å¤šè¿›ç¨‹é€šä¿¡" scheme="http://yoursite.com/tags/%E5%A4%9A%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>Android åŠ¨ç”»è¯¦è§£</title>
    <link href="http://yoursite.com/Android-%E5%8A%A8%E7%94%BB%E8%AF%A6%E8%A7%A3/"/>
    <id>http://yoursite.com/Android-åŠ¨ç”»è¯¦è§£/</id>
    <published>2019-02-18T11:12:22.000Z</published>
    <updated>2019-03-15T15:28:44.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>Android æä¾›äº†å¾ˆå¤šä¸°å¯Œçš„ API å»å®ç°åŠ¨ç”»æ•ˆæœï¼ŒåŠ ä¸Š SDK 25.3 æ—¶æ¨å‡ºçš„ SpringAnimationï¼Œæ€»å…±æœ‰ä¸‰å¤§ç±» Animation ä¾›å¼€å‘è€…ä½¿ç”¨ã€‚<a id="more"></a></p><h2 id="View-Animation"><a href="#View-Animation" class="headerlink" title="View Animation"></a>View Animation</h2><p>è§†å›¾åŠ¨ç”»çš„ä½œç”¨å¯¹è±¡æ˜¯ Viewï¼Œå¯åˆ†ä¸ºè¡¥é—´åŠ¨ç”»å’Œå¸§åŠ¨ç”»ã€‚</p><h3 id="è¡¥é—´åŠ¨ç”»"><a href="#è¡¥é—´åŠ¨ç”»" class="headerlink" title="è¡¥é—´åŠ¨ç”»"></a>è¡¥é—´åŠ¨ç”»</h3><p>åŠ¨ç”»å¼€å§‹å’Œç»“å°¾çš„ä¸­é—´è¿‡ç¨‹éƒ½æ˜¯å‡è±¡ï¼Œæ˜¯æ¸²æŸ“å‡ºæ¥çš„è¡¨è±¡ï¼Œåªæ˜¯æ˜¾ç¤ºçš„ä½ç½®å˜åŠ¨ï¼ŒViewçš„å®é™…ä½ç½®æœªæ”¹å˜ï¼Œè¡¨ç°ä¸ºViewç§»åŠ¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œç‚¹å‡»äº‹ä»¶ä»åœ¨åŸå¤„æ‰èƒ½å“åº”ã€‚åˆ©ç”¨è¡¥é—´åŠ¨ç”»ï¼ŒåŒä¸€ä¸ªå›¾å½¢åœ¨ç•Œé¢ä¸Šå¯ä»¥è¿›è¡Œé€æ˜åº¦ï¼ˆAlphaAnimationï¼‰ã€ç¼©æ”¾ï¼ˆScaleAnimationï¼‰ã€æ—‹è½¬ï¼ˆRotateAnimationï¼‰ã€å¹³ç§»ï¼ˆTranslateAnimationï¼‰çš„å˜åŒ–ã€‚</p><h4 id="XML-æ–¹å¼"><a href="#XML-æ–¹å¼" class="headerlink" title="XML æ–¹å¼"></a>XML æ–¹å¼</h4><p>åˆ›å»ºä¸€ä¸ª set.xml æ–‡ä»¶ï¼Œé€šè¿‡åŠ¨ç”»é›†åˆæ ‡ç­¾<code>&lt;set&gt;</code>å°†å››ç§æ•ˆæœç»“åˆèµ·æ¥<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">--åŠ¨ç”»é›†åˆ</span></span></span><br><span class="line"><span class="tag"><span class="attr">interpolator</span> è¡¨ç¤ºæ‰€é‡‡ç”¨çš„çš„å·®å€¼å™¨ï¼Œå…¶å½±å“åŠ¨ç”»çš„é€Ÿåº¦ï¼Œå¯ä»¥ä¸æŒ‡å®š</span></span><br><span class="line"><span class="tag"><span class="attr">shareInterpolator</span> è¡¨ç¤ºé›†åˆä¸­çš„åŠ¨ç”»æ˜¯å¦å’Œé›†åˆå…±äº«åŒä¸€ä¸ªå·®å€¼å™¨<span class="attr">--</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:duration</span>=<span class="string">"1000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fillAfter</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:shareInterpolator</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:repeatMode</span>=<span class="string">"reverse"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- ç¼©æ”¾åŠ¨ç”»</span></span><br><span class="line"><span class="comment">    fromXScale è¡¨ç¤ºæ°´å¹³æ–¹å‘ç¼©æ”¾çš„èµ·å§‹å€¼</span></span><br><span class="line"><span class="comment">    toXScale è¡¨ç¤ºæ°´å¹³æ–¹å‘çš„ç»“æŸå€¼</span></span><br><span class="line"><span class="comment">    fillAfter è¡¨ç¤ºåŠ¨ç”»æ˜¾ç¤ºç»“æŸä¿æŒæœ€åä¸€å¸§--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scale</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fillAfter</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXScale</span>=<span class="string">"0.5"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYScale</span>=<span class="string">"0.5"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXScale</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYScale</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:repeatCount</span>=<span class="string">"infinite"</span>/&gt;</span><span class="comment">&lt;!--æ¬¡æ•° ,infinite ä¸ºæ— çº¿å¾ªç¯æ’­æ”¾--&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">&lt;!-- é€æ˜åº¦åŠ¨ç”»</span></span><br><span class="line"><span class="comment">        fromAlpha è¡¨ç¤ºèµ·å§‹é€æ˜åº¦</span></span><br><span class="line"><span class="comment">        toAlpha è¡¨ç¤ºç»“æŸé€æ˜åº¦--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alpha</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"2000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fillAfter</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromAlpha</span>=<span class="string">"0.7"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toAlpha</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">&lt;!--æ—‹è½¬åŠ¨ç”»</span></span><br><span class="line"><span class="comment">    fromDegrees è¡¨ç¤ºèµ·å§‹è§’åº¦</span></span><br><span class="line"><span class="comment">    toDegrees è¡¨ç¤ºç»“æŸè§’åº¦--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rotate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromDegrees</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toDegrees</span>=<span class="string">"90"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fillAfter</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--å¹³ç§»åŠ¨ç”»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYDelta</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">"100%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYDelta</span>=<span class="string">"-100%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fillAfter</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"2000"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨ä»¥ä¸ŠåŠ¨ç”»çš„æ–¹å¼å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Animation anim = AnimationUtils.loadAnimation(context, R.anim.my_animation);</span><br><span class="line">view.startAnimation(anim);</span><br></pre></td></tr></table></figure></p><h4 id="Java-ä»£ç æ–¹å¼"><a href="#Java-ä»£ç æ–¹å¼" class="headerlink" title="Java ä»£ç æ–¹å¼"></a>Java ä»£ç æ–¹å¼</h4><p>ä½¿ç”¨ Java ä»£ç å®ç°åŠ¨ç”»çš„æ–¹å¼å¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startAnimationSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºåŠ¨ç”»ï¼Œå‚æ•°è¡¨ç¤ºä»–çš„å­åŠ¨ç”»æ˜¯å¦å…±ç”¨ä¸€ä¸ªæ’å€¼å™¨</span></span><br><span class="line">    AnimationSet animationSet = <span class="keyword">new</span> AnimationSet(<span class="keyword">true</span>);</span><br><span class="line">    <span class="comment">//æ·»åŠ åŠ¨ç”»</span></span><br><span class="line">    animationSet.addAnimation(<span class="keyword">new</span> AlphaAnimation(<span class="number">1.0f</span>, <span class="number">0.0f</span>));</span><br><span class="line">    <span class="comment">//è®¾ç½®æ’å€¼å™¨</span></span><br><span class="line">    animationSet.setInterpolator(<span class="keyword">new</span> LinearInterpolator());</span><br><span class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»æŒç»­æ—¶é•¿</span></span><br><span class="line">    animationSet.setDuration(<span class="number">3000</span>);</span><br><span class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»ç»“æŸä¹‹åæ˜¯å¦ä¿æŒåŠ¨ç”»çš„ç›®æ ‡çŠ¶æ€</span></span><br><span class="line">    animationSet.setFillAfter(<span class="keyword">true</span>);</span><br><span class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»ç»“æŸä¹‹åæ˜¯å¦ä¿æŒåŠ¨ç”»å¼€å§‹æ—¶çš„çŠ¶æ€</span></span><br><span class="line">    animationSet.setFillBefore(<span class="keyword">false</span>);</span><br><span class="line">    <span class="comment">//è®¾ç½®é‡å¤æ¨¡å¼</span></span><br><span class="line">    animationSet.setRepeatMode(AnimationSet.REVERSE);</span><br><span class="line">    <span class="comment">//è®¾ç½®é‡å¤æ¬¡æ•°</span></span><br><span class="line">    animationSet.setRepeatCount(AnimationSet.INFINITE);</span><br><span class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»å»¶æ—¶æ—¶é—´</span></span><br><span class="line">    animationSet.setStartOffset(<span class="number">2000</span>);</span><br><span class="line">    <span class="comment">//å–æ¶ˆåŠ¨ç”»</span></span><br><span class="line">    animationSet.cancel();</span><br><span class="line">    <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">    animationSet.reset();</span><br><span class="line">    <span class="comment">//å¼€å§‹åŠ¨ç”»</span></span><br><span class="line">    view.startAnimation(animationSet);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="è‡ªå®šä¹‰"><a href="#è‡ªå®šä¹‰" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h4><p>é™¤äº†ç³»ç»Ÿè‡ªå¸¦çš„å››ç§è¡¥é—´åŠ¨ç”»ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ View åŠ¨ç”»ã€‚æ´¾ç”Ÿä¸€ç§åŠ¨ç”»åªéœ€è¦ç»§æ‰¿æŠ½è±¡ç±» Animationï¼Œç„¶åé‡å†™å®ƒçš„<code>initialize</code>å’Œ<code>applyTransformation</code>æ–¹æ³•å³å¯ï¼Œåœ¨å‰ä¸€ä¸ªæ–¹æ³•ä¸­åšåˆå§‹åŒ–å·¥ä½œï¼Œåä¸€ä¸ªæ–¹æ³•ä¸­è¿›è¡Œç›¸åº”çš„çŸ©é˜µå˜æ¢ï¼Œæœ¬æ–‡ä¸å†è¯¦ç»†ä»‹ç»ã€‚ </p><h4 id="ç‰¹æ®Šä½¿ç”¨"><a href="#ç‰¹æ®Šä½¿ç”¨" class="headerlink" title="ç‰¹æ®Šä½¿ç”¨"></a>ç‰¹æ®Šä½¿ç”¨</h4><p>View åŠ¨ç”»è¿˜å¯ä»¥ç”¨åœ¨æ§åˆ¶ ViewGroup ä¸­å­å…ƒç´ çš„å‡ºåœºæ•ˆæœã€å®ç°ä¸åŒ Activity çš„åˆ‡æ¢æ•ˆæœç­‰åœºæ™¯ä¸­ã€‚</p><h3 id="å¸§åŠ¨ç”»"><a href="#å¸§åŠ¨ç”»" class="headerlink" title="å¸§åŠ¨ç”»"></a>å¸§åŠ¨ç”»</h3><p>å¸§åŠ¨ç”»æ˜¯é¡ºåºæ’­æ”¾ä¸€ç»„é¢„å…ˆå®šä¹‰å¥½çš„å›¾ç‰‡ï¼Œç±»ä¼¼äºç”µå½±æ’­æ”¾ã€‚ä¸åŒäºè¡¥é—´åŠ¨ç”»ï¼Œç³»ç»Ÿæä¾›äº†å¦å¤–ä¸€ä¸ªç±» AnimationDrawable æ¥ä½¿ç”¨å¸§åŠ¨ç”»ã€‚</p><p>é¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ª XML æ–‡ä»¶<code>frame_animation.xml</code><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">animation-list</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:oneshot</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:drawable</span>=<span class="string">"@mipmap/image1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:drawable</span>=<span class="string">"@mipmap/image2"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:drawable</span>=<span class="string">"@mipmap/iamge2"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">animation-list</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åå°†ä¸Šè¿°çš„ Drawable ä½œä¸º View çš„èƒŒæ™¯å¹¶é€šè¿‡ Drawable æ¥æ’­æ”¾åŠ¨ç”»å³å¯<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">view.setBackgroundResource(R.drawable.frame_animation)ï¼›</span><br><span class="line">AnimationDrawable drawable = (AnimationDrawable) view.getBackground();</span><br><span class="line">drawable.start();</span><br></pre></td></tr></table></figure></p><h2 id="Property-Animation"><a href="#Property-Animation" class="headerlink" title="Property Animation"></a>Property Animation</h2><p>å±æ€§åŠ¨ç”»åœ¨ API 11 å¼•å…¥ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å¢å¼ºç‰ˆçš„è¡¥é—´åŠ¨ç”»ï¼Œä¸è¡¥é—´åŠ¨ç”»çš„ä¸åŒä¹‹å¤„ä½“ç°åœ¨ï¼š</p><ul><li>è¡¥é—´åŠ¨ç”»åªèƒ½å®šä¹‰ä¸¤ä¸ªå…³é”®å¸§åœ¨é€æ˜ã€æ—‹è½¬ã€ä½ç§»å’Œå€¾æ–œè¿™å››ä¸ªå±æ€§çš„å˜æ¢ï¼Œä½†æ˜¯å±æ€§åŠ¨ç”»å¯ä»¥å®šä¹‰ä»»ä½•å±æ€§çš„å˜åŒ–ã€‚</li><li>è¡¥é—´åŠ¨ç”»åªèƒ½å¯¹ UI ç»„ä»¶æ‰§è¡ŒåŠ¨ç”»ï¼Œä½†å±æ€§åŠ¨ç”»å¯ä»¥å¯¹ä»»ä½•å¯¹è±¡æ‰§è¡ŒåŠ¨ç”»ã€‚</li></ul><p>ä¸è¡¥é—´åŠ¨ç”»ç±»ä¼¼ï¼Œå±æ€§åŠ¨ç”»ä¹Ÿéœ€è¦å®šä¹‰å‡ ä¸ªæ–¹é¢çš„å±æ€§ï¼š</p><ul><li>åŠ¨ç”»æŒç»­æ—¶é—´ã€‚é»˜è®¤ä¸º 300msï¼Œå¯ä»¥é€šè¿‡ android:duration å±æ€§æŒ‡å®šã€‚</li><li>åŠ¨ç”»æ’å€¼æ–¹å¼ã€‚é€šè¿‡ android:interploator æŒ‡å®šã€‚</li><li>åŠ¨ç”»é‡å¤æ¬¡æ•°ã€‚é€šè¿‡ android:repeatCount æŒ‡å®šã€‚</li><li>é‡å¤è¡Œä¸ºã€‚é€šè¿‡ android:repeatMode æŒ‡å®šã€‚</li><li>åŠ¨ç”»é›†ã€‚åœ¨å±æ€§èµ„æºæ–‡ä»¶ä¸­é€šè¿‡ <code>&lt;set&gt;</code> æ¥ç»„åˆã€‚</li><li>å¸§åˆ·æ–°ç‡ã€‚æŒ‡å®šå¤šé•¿æ—¶é—´æ’­æ”¾ä¸€å¸§ã€‚é»˜è®¤ä¸º 10 msã€‚</li></ul><h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><ul><li>ValueAnimatorï¼šå±æ€§åŠ¨ç”»ç”¨åˆ°çš„ä¸»è¦çš„æ—¶é—´å¼•æ“ï¼Œè´Ÿè´£è®¡ç®—å„ä¸ªå¸§çš„å±æ€§å€¼ã€‚</li><li>ObjectAnimatorï¼š ValueAnimator çš„å­ç±»ï¼Œå¯¹æŒ‡å®šå¯¹è±¡çš„å±æ€§æ‰§è¡ŒåŠ¨ç”»ã€‚</li><li>AnimatorSetï¼šAnimator çš„å­ç±»ï¼Œç”¨äºç»„åˆå¤šä¸ª Animatorã€‚</li></ul><p>å±æ€§åŠ¨ç”»è¿˜æä¾›äº†ä¸€ä¸ª Evaluator ï¼Œç”¨æ¥æ§åˆ¶å¦‚ä½•è®¡ç®—å±æ€§å€¼ã€‚</p><ul><li>IntEvaluatorï¼šè®¡ç®— int ç±»å‹å±æ€§å€¼çš„è®¡ç®—å™¨ã€‚</li><li>FloatEvaluatorï¼šç”¨äºè®¡ç®— float ç±»å‹å±æ€§å€¼çš„è®¡ç®—å™¨ã€‚</li><li>ArgbEvaluatorï¼šç”¨äºè®¡ç®—åå…­è¿›åˆ¶å½¢å¼è¡¨ç¤ºçš„é¢œè‰²å€¼çš„è®¡ç®—å™¨ã€‚</li><li>TypeEvaluatorï¼šå¯ä»¥è‡ªå®šä¹‰è®¡ç®—å™¨ã€‚</li></ul><h3 id="ValueAniamtor"><a href="#ValueAniamtor" class="headerlink" title="ValueAniamtor"></a>ValueAniamtor</h3><p>ValueAnimator ç±»ä¸­æœ‰3ä¸ªé‡è¦æ–¹æ³•ï¼š</p><blockquote><p>ValueAnimator.ofInt(int values)<br>ValueAnimator.ofFloat(float values)<br>ValueAnimator.ofObject(int values)</p></blockquote><h4 id="ofInt"><a href="#ofInt" class="headerlink" title="ofInt"></a>ofInt</h4><p>å°†åˆå§‹å€¼ä»¥æ•´å‹æ•°å€¼çš„å½¢å¼è¿‡æ¸¡åˆ°ç»“æŸå€¼,å³ä¼°å€¼å™¨æ˜¯æ•´å‹ä¼°å€¼å™¨ â€”â€” IntEvaluator</p><p>ä¸‹é¢çš„ä»£ç å°†å®ç°æŒ‰é’®çš„å®½åº¦ä» 150px æ”¾å¤§åˆ° 500px<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">    Button mButton = (Button) findViewById(R.id.Button);</span><br><span class="line">    <span class="comment">// è®¾ç½®å±æ€§æ•°å€¼çš„åˆå§‹å€¼ &amp; ç»“æŸå€¼</span></span><br><span class="line">    <span class="comment">// ValueAnimator.ofInt()å†…ç½®äº†æ•´å‹ä¼°å€¼å™¨ï¼Œé»˜è®¤è®¾ç½®äº†å¦‚ä½•ä»åˆå§‹å€¼150 è¿‡æ¸¡åˆ° ç»“æŸå€¼500</span></span><br><span class="line">    ValueAnimator valueAnimator = ValueAnimator.ofInt(mButton.getLayoutParams().width, <span class="number">500</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// è®¾ç½®åŠ¨ç”»çš„æ’­æ”¾å„ç§å±æ€§</span></span><br><span class="line">    valueAnimator.setDuration(<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å±æ€§æ•°å€¼æ‰‹åŠ¨èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§ï¼Œæ­¤å¤„æ˜¯å°†å€¼èµ‹ç»™æŒ‰é’®çš„å®½åº¦</span></span><br><span class="line">    <span class="comment">// è®¾ç½®æ›´æ–°ç›‘å¬å™¨ï¼Œæ•°å€¼æ¯æ¬¡å˜åŒ–æ›´æ–°éƒ½ä¼šè°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">    valueAnimator.addUpdateListener(<span class="keyword">new</span> AnimatorUpdateListener() &#123;</span><br><span class="line">    </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animator)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// è·å¾—æ¯æ¬¡å˜åŒ–åçš„å±æ€§å€¼</span></span><br><span class="line">            <span class="keyword">int</span> currentValue = (Integer) animator.getAnimatedValue();</span><br><span class="line">            <span class="comment">// å°†å€¼æ‰‹åŠ¨èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§ï¼Œå®ç°æŒ‰é’®å®½åº¦å±æ€§çš„åŠ¨æ€å˜åŒ–</span></span><br><span class="line">            mButton.getLayoutParams().width = currentValue;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// åˆ·æ–°è§†å›¾ï¼Œå³é‡æ–°ç»˜åˆ¶</span></span><br><span class="line">            mButton.requestLayout();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    valueAnimator.start();  <span class="comment">// å¯åŠ¨åŠ¨ç”»</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ofFloat"><a href="#ofFloat" class="headerlink" title="ofFloat"></a>ofFloat</h4><p>å…¶ä¸ ofInt çš„åŒºåˆ«ä»…åœ¨äºé‡‡ç”¨äº†æµ®ç‚¹ä¼°å€¼å™¨ï¼ˆFloatEvaluatorï¼‰<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FloatEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡å†™evaluate()</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fraction åŠ¨ç”»å®Œæˆåº¦ï¼ˆæ ¹æ®å®ƒæ¥è®¡ç®—å½“å‰åŠ¨ç”»çš„å€¼ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> startValue åŠ¨ç”»çš„åˆå§‹å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endValue åŠ¨ç”»çš„ç»“æŸå€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Object startValue, Object endValue)</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> startFloat = ((Number) startValue).floatValue();  </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆå§‹å€¼è¿‡æ¸¡åˆ°ç»“æŸå€¼çš„ç®—æ³•</span></span><br><span class="line">        <span class="comment">// 1. ç”¨ç»“æŸå€¼å‡å»åˆå§‹å€¼ï¼Œç®—å‡ºå®ƒä»¬ä¹‹é—´çš„å·®å€¼</span></span><br><span class="line">        <span class="comment">// 2. ç”¨ä¸Šè¿°å·®å€¼ä¹˜ä»¥ fraction ç³»æ•°</span></span><br><span class="line">        <span class="comment">// 3. åŠ ä¸Šåˆå§‹å€¼ï¼Œå¾—åˆ°å½“å‰åŠ¨ç”»çš„å€¼</span></span><br><span class="line">        <span class="keyword">return</span> startFloat + fraction * (((Number) endValue).floatValue() - startFloat);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ofObject"><a href="#ofObject" class="headerlink" title="ofObject"></a>ofObject</h4><p>å¯¹äº ValueAnimator.ofInt å’Œ ValueAnimator.ofFloat æ¥è¯´ï¼Œç”±äºä½¿ç”¨äº†ç³»ç»Ÿå†…ç½®çš„ä¼°å€¼å™¨ â€”â€” FloatEvaluator å’Œ IntEvaluatorï¼Œæ‰€ä»¥å·²ç»é»˜è®¤å®ç°äº†ä»åˆå§‹å€¼åˆ°ç»“æŸå€¼çš„é€»è¾‘ã€‚</p><p>ä½†å¯¹äº ValueAnimator.ofObjectï¼Œå¹¶æ²¡æœ‰ç³»ç»Ÿé»˜è®¤å®ç°ï¼Œå› ä¸ºå¯¹è±¡çš„åŠ¨ç”»æ“ä½œå¤æ‚å¤šæ ·ï¼Œç³»ç»Ÿæ— æ³•çŸ¥é“å¦‚ä½•ä»åˆå§‹å¯¹è±¡è¿‡åº¦åˆ°ç»“æŸå¯¹è±¡ï¼Œå› æ­¤éœ€è¦è‡ªå®šä¹‰ä¼°å€¼å™¨ï¼ˆTypeEvaluatorï¼‰æ¥å‘ŠçŸ¥ç³»ç»Ÿå…·ä½“çš„é€»è¾‘ã€‚</p><p>è‡ªå®šä¹‰ä¸€ä¸ªä¼°å€¼å™¨ PointEvaluatorï¼Œå®ç°ä¸€ä¸ªåœ†ä»ä¸€ä¸ªç‚¹ç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªç‚¹ã€‚é»˜è®¤å·²ç»æœ‰äº†ä¸€ä¸ªç‚¹åæ ‡ç±»ï¼šPointï¼Œå…¶å…·æœ‰ x å’Œ y ä¸¤ä¸ªæµ®ç‚¹å±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PointEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Object startValue, Object endValue)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†åŠ¨ç”»åˆå§‹å€¼startValue å’Œ åŠ¨ç”»ç»“æŸå€¼endValue ç±»å‹è½¬æ¢æˆPointå¯¹è±¡</span></span><br><span class="line">        Point startPoint = (Point) startValue;</span><br><span class="line">        Point endPoint = (Point) endValue;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ¹æ®fractionæ¥è®¡ç®—å½“å‰åŠ¨ç”»çš„xå’Œyçš„å€¼</span></span><br><span class="line">        <span class="keyword">float</span> x = startPoint.getX() + fraction * (endPoint.getX() - startPoint.getX());</span><br><span class="line">        <span class="keyword">float</span> y = startPoint.getY() + fraction * (endPoint.getY() - startPoint.getY());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°†è®¡ç®—åçš„åæ ‡å°è£…åˆ°ä¸€ä¸ªæ–°çš„Pointå¯¹è±¡ä¸­å¹¶è¿”å›</span></span><br><span class="line">        Point point = <span class="keyword">new</span> Point(x, y);</span><br><span class="line">        <span class="keyword">return</span> point;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†å±æ€§åŠ¨ç”»ä½œç”¨åˆ°è‡ªå®šä¹‰Viewå½“ä¸­<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> RADIUS = <span class="number">70f</span>;<span class="comment">// åœ†çš„åŠå¾„</span></span><br><span class="line">    <span class="keyword">private</span> Point currentPoint;<span class="comment">// å½“å‰ç‚¹åæ ‡</span></span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;<span class="comment">// ç»˜å›¾ç”»ç¬”</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–ç”»ç¬”</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        mPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</span><br><span class="line">        mPaint.setColor(Color.BLUE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ç°ç»˜åˆ¶é€»è¾‘</span></span><br><span class="line">    <span class="comment">// å…ˆåœ¨åˆå§‹ç‚¹ç”»åœ†ï¼Œç›‘å¬å½“å‰åæ ‡å€¼çš„å˜åŒ–ï¼Œæ¯æ¬¡å˜åŒ–éƒ½è°ƒç”¨onDraw()é‡æ–°ç»˜åˆ¶åœ†ï¼Œå®ç°åœ†çš„å¹³ç§»åŠ¨ç”»æ•ˆæœ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰ç‚¹åæ ‡ä¸ºç©º(å³ç¬¬ä¸€æ¬¡)</span></span><br><span class="line">        <span class="keyword">if</span> (currentPoint == <span class="keyword">null</span>) &#123;</span><br><span class="line">            currentPoint = <span class="keyword">new</span> Point(RADIUS, RADIUS);  <span class="comment">// åˆ›å»ºä¸€ä¸ªç‚¹å¯¹è±¡(åæ ‡æ˜¯(70,70))</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">float</span> x = currentPoint.getX();</span><br><span class="line">            <span class="keyword">float</span> y = currentPoint.getY();</span><br><span class="line">            canvas.drawCircle(x, y, RADIUS, mPaint);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†å±æ€§åŠ¨ç”»ä½œç”¨åˆ°Viewä¸­</span></span><br><span class="line">            Point startPoint = <span class="keyword">new</span> Point(RADIUS, RADIUS);<span class="comment">// åˆå§‹ç‚¹ä¸ºåœ†å¿ƒ(70,70)</span></span><br><span class="line">            Point endPoint = <span class="keyword">new</span> Point(<span class="number">700</span>, <span class="number">1000</span>);<span class="comment">// ç»“æŸç‚¹ä¸º(700,1000)</span></span><br><span class="line"></span><br><span class="line">            ValueAnimator anim = ValueAnimator.ofObject(<span class="keyword">new</span> PointEvaluator(), startPoint, endPoint);</span><br><span class="line">            anim.setDuration(<span class="number">5000</span>);</span><br><span class="line">    </span><br><span class="line">            anim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</span><br><span class="line">                    currentPoint = (Point) animation.getAnimatedValue();</span><br><span class="line">                    <span class="comment">// æ¯æ¬¡èµ‹å€¼åå°±é‡æ–°ç»˜åˆ¶ï¼Œä»è€Œå®ç°åŠ¨ç”»æ•ˆæœ</span></span><br><span class="line">                    <span class="comment">// è°ƒç”¨invalidate()å,å°±ä¼šåˆ·æ–°View,å³æ‰èƒ½çœ‹åˆ°é‡æ–°ç»˜åˆ¶çš„ç•Œé¢,å³onDraw()ä¼šè¢«é‡æ–°è°ƒç”¨ä¸€æ¬¡</span></span><br><span class="line">                    invalidate();  </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            anim.start();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœåæ ‡å€¼ä¸ä¸º0,åˆ™ç”»åœ†</span></span><br><span class="line">            <span class="keyword">float</span> x = currentPoint.getX();</span><br><span class="line">            <span class="keyword">float</span> y = currentPoint.getY();</span><br><span class="line">            canvas.drawCircle(x, y, RADIUS, mPaint);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ObjectAnimator"><a href="#ObjectAnimator" class="headerlink" title="ObjectAnimator"></a>ObjectAnimator</h3><p>ç»§æ‰¿è‡ª ValueAnimator ç±»ï¼Œå³åº•å±‚çš„åŠ¨ç”»å®ç°æœºåˆ¶åŸºäº ValueAnimatorã€‚<br>ObjectAnimator ä¸ ValueAnimatorç±»çš„åŒºåˆ«åœ¨äº</p><ul><li>ValueAnimator ç±»æ˜¯å…ˆæ”¹å˜å€¼ï¼Œç„¶å<strong>æ‰‹åŠ¨èµ‹å€¼</strong>ç»™å¯¹è±¡çš„å±æ€§ä»è€Œå®ç°åŠ¨ç”»ï¼Œå±äº<strong>é—´æ¥</strong>å¯¹å¯¹è±¡å±æ€§è¿›è¡Œæ“ä½œ</li><li>ObjectAnimator ç±»æ˜¯å…ˆæ”¹å˜å€¼ï¼Œç„¶å<strong>è‡ªåŠ¨èµ‹å€¼</strong>ç»™å¯¹è±¡çš„å±æ€§ä»è€Œå®ç°åŠ¨ç”»ï¼Œå±äº<strong>ç›´æ¥</strong>å¯¹å¯¹è±¡å±æ€§è¿›è¡Œæ“ä½œ</li></ul><h4 id="å…·ä½“ä½¿ç”¨"><a href="#å…·ä½“ä½¿ç”¨" class="headerlink" title="å…·ä½“ä½¿ç”¨"></a>å…·ä½“ä½¿ç”¨</h4><p>å¯¹äº</p><blockquote><p>ObjectAnimator animator = ObjectAnimator.ofFloat(Object object, String property, float â€¦.values); </p></blockquote><p>å…¶ä¸­ values å‚æ•°ä¸å®šï¼Œè¡¨ç¤ºåŠ¨ç”»åˆå§‹å€¼å’Œç»“æŸå€¼ï¼Œå¦‚æœæ˜¯ä¸¤ä¸ªå‚æ•°a,bï¼Œåˆ™åŠ¨ç”»æ•ˆæœæ˜¯ä»å±æ€§çš„aå€¼åˆ°bå€¼ï¼›å¦‚æœæ˜¯ä¸‰ä¸ªå‚æ•°a,b,cï¼Œåˆ™åŠ¨ç”»æ•ˆæœæ˜¯ä»å±æ€§çš„aå€¼åˆ°bå€¼å†åˆ°cå€¼</p><p>å¯¹ Button è¿›è¡Œå˜æ¢<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ObjectAnimator animator = ObjectAnimator.ofFloat(mButton, <span class="string">"alpha"</span>, <span class="number">1f</span>, <span class="number">0f</span>, <span class="number">1f</span>);  <span class="comment">// æ•ˆæœ:å¸¸è§„-&gt;å…¨é€æ˜-&gt;å¸¸è§„</span></span><br><span class="line">ObjectAnimator animator = ObjectAnimator.ofFloat(mButton, <span class="string">"rotation"</span>, <span class="number">0f</span>, <span class="number">360f</span>);</span><br><span class="line">......</span><br><span class="line">animator.setDuration(<span class="number">5000</span>);</span><br><span class="line">animator.start();</span><br></pre></td></tr></table></figure></p><h4 id="è‡ªå®šä¹‰-1"><a href="#è‡ªå®šä¹‰-1" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h4><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç»™<code>ObjectAnimator.ofFloat</code>çš„ç¬¬äºŒä¸ªå‚æ•°<code>String property</code>ä¼ å…¥<code>alpha</code>ã€<code>rotation</code>ã€<code>translationX</code> å’Œ<code>scaleY</code>ç­‰å€¼ï¼Œå®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä¼ ä»»æ„å±æ€§å€¼ï¼Œå› ä¸º ObjectAnimator ç±»å®ç°åŠ¨ç”»æ•ˆæœçš„æœ¬è´¨æ˜¯ï¼šä¸æ–­æ§åˆ¶å€¼çš„å˜åŒ–ï¼Œå†ä¸æ–­è‡ªåŠ¨èµ‹ç»™å¯¹è±¡çš„å±æ€§ï¼Œèµ‹å€¼çš„è¿‡ç¨‹æ˜¯é€šè¿‡è°ƒç”¨å¯¹è±¡çš„<code>get/set</code>æ–¹æ³•è¿›è¡Œçš„ã€‚</p><p>æ‰€ä»¥è‡ªå®šä¹‰å±æ€§å°±å¯ä»¥é€šè¿‡ä¸ºå¯¹è±¡è®¾ç½®éœ€è¦æ“ä½œå±æ€§çš„<code>set/get</code>æ–¹æ³•ï¼Œå†å®ç° TypeEvaluator å®šä¹‰å±æ€§å˜åŒ–çš„é€»è¾‘å®Œæˆã€‚</p><p>è¿˜æ˜¯å¯¹ä¸€ä¸ªçƒåšå˜æ¢<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyView2</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> RADIUS = <span class="number">100f</span>;</span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String color;  <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²å±æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®èƒŒæ™¯é¢œè‰²çš„get() &amp; set()æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getColor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColor</span><span class="params">(String color)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.color = color;</span><br><span class="line">        mPaint.setColor(Color.parseColor(color));  <span class="comment">// å°†ç”»ç¬”çš„é¢œè‰²è®¾ç½®æˆæ–¹æ³•å‚æ•°ä¼ å…¥çš„é¢œè‰²</span></span><br><span class="line">        invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyView2</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        mPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</span><br><span class="line">        mPaint.setColor(Color.BLUE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        canvas.drawCircle(<span class="number">500</span>, <span class="number">500</span>, RADIUS, mPaint);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®ç°è‡ªå®šä¹‰ä¼°å€¼å™¨ï¼Œå®Œæˆé¢œè‰²è¿‡æ¸¡çš„é€»è¾‘<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColorEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCurrentRed;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCurrentGreen ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCurrentBlue ;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡å†™evaluateï¼Œå†™å…¥å¯¹è±¡åŠ¨ç”»è¿‡æ¸¡çš„é€»è¾‘ï¼Œæ­¤å¤„ä¸ºé¢œè‰²è¿‡æ¸¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Object startValue, Object endValue)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String startColor = (String) startValue;</span><br><span class="line">        String endColor = (String) endValue;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡å­—ç¬¦ä¸²æˆªå–çš„æ–¹å¼å°†åˆå§‹åŒ–é¢œè‰²åˆ†ä¸ºRGBä¸‰ä¸ªéƒ¨åˆ†ï¼Œå¹¶å°†RGBçš„å€¼è½¬æ¢æˆåè¿›åˆ¶æ•°å­—</span></span><br><span class="line">        <span class="comment">// é‚£ä¹ˆæ¯ä¸ªé¢œè‰²çš„å–å€¼èŒƒå›´æ˜¯0-255</span></span><br><span class="line">        <span class="keyword">int</span> startRed = Integer.parseInt(startColor.substring(<span class="number">1</span>, <span class="number">3</span>), <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">int</span> startGreen = Integer.parseInt(startColor.substring(<span class="number">3</span>, <span class="number">5</span>), <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">int</span> startBlue = Integer.parseInt(startColor.substring(<span class="number">5</span>, <span class="number">7</span>), <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> endRed = Integer.parseInt(endColor.substring(<span class="number">1</span>, <span class="number">3</span>), <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">int</span> endGreen = Integer.parseInt(endColor.substring(<span class="number">3</span>, <span class="number">5</span>), <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">int</span> endBlue = Integer.parseInt(endColor.substring(<span class="number">5</span>, <span class="number">7</span>), <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†åˆå§‹åŒ–é¢œè‰²çš„å€¼å®šä¹‰ä¸ºå½“å‰éœ€è¦æ“ä½œçš„é¢œè‰²å€¼</span></span><br><span class="line">        mCurrentRed = startRed;</span><br><span class="line">        mCurrentGreen = startGreen;</span><br><span class="line">        mCurrentBlue = startBlue;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¡ç®—åˆå§‹é¢œè‰²å’Œç»“æŸé¢œè‰²ä¹‹é—´çš„å·®å€¼</span></span><br><span class="line">        <span class="comment">// è¯¥å·®å€¼å†³å®šç€é¢œè‰²å˜åŒ–çš„å¿«æ…¢ï¼Œå¦‚æœåˆå§‹é¢œè‰²å€¼å’Œç»“æŸé¢œè‰²å€¼ç›¸è¿‘ï¼Œå˜åŒ–ä¼šæ¯”è¾ƒç¼“æ…¢</span></span><br><span class="line">        <span class="keyword">int</span> redDiff = Math.abs(startRed - endRed);</span><br><span class="line">        <span class="keyword">int</span> greenDiff = Math.abs(startGreen - endGreen);</span><br><span class="line">        <span class="keyword">int</span> blueDiff = Math.abs(startBlue - endBlue);</span><br><span class="line">        <span class="keyword">int</span> colorDiff = redDiff + greenDiff + blueDiff;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (mCurrentRed != endRed) &#123;</span><br><span class="line">            <span class="comment">// getCurrentColor()å†³å®šå¦‚ä½•æ ¹æ®å·®å€¼æ¥å†³å®šé¢œè‰²å˜åŒ–çš„å¿«æ…¢ -&gt;&gt;å…³æ³¨1</span></span><br><span class="line">            mCurrentRed = getCurrentColor(startRed, endRed, colorDiff, <span class="number">0</span>, fraction);</span><br><span class="line">        </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mCurrentGreen != endGreen) &#123;</span><br><span class="line">            mCurrentGreen = getCurrentColor(startGreen, endGreen, colorDiff, redDiff, fraction);</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mCurrentBlue != endBlue) &#123;</span><br><span class="line">            mCurrentBlue = getCurrentColor(startBlue, endBlue, colorDiff, redDiff + greenDiff, fraction);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†è®¡ç®—å‡ºçš„å½“å‰é¢œè‰²çš„å€¼ç»„è£…è¿”å›</span></span><br><span class="line">        String currentColor = <span class="string">"#"</span> + getHexString(mCurrentRed)</span><br><span class="line">                + getHexString(mCurrentGreen) + getHexString(mCurrentBlue);</span><br><span class="line">        <span class="keyword">return</span> currentColor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®fractionå€¼æ¥è®¡ç®—å½“å‰çš„é¢œè‰²ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getCurrentColor</span><span class="params">(<span class="keyword">int</span> startColor, <span class="keyword">int</span> endColor, <span class="keyword">int</span> colorDiff,</span></span></span><br><span class="line"><span class="function"><span class="params">                                <span class="keyword">int</span> offset, <span class="keyword">float</span> fraction)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> currentColor;</span><br><span class="line">        <span class="keyword">if</span> (startColor &gt; endColor) &#123;</span><br><span class="line">            currentColor = (<span class="keyword">int</span>) (startColor - (fraction * colorDiff - offset));</span><br><span class="line">            <span class="keyword">if</span> (currentColor &lt; endColor) &#123;</span><br><span class="line">                currentColor = endColor;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            currentColor = (<span class="keyword">int</span>) (startColor + (fraction * colorDiff - offset));</span><br><span class="line">            <span class="keyword">if</span> (currentColor &gt; endColor) &#123;</span><br><span class="line">                currentColor = endColor;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> currentColor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†10è¿›åˆ¶é¢œè‰²å€¼è½¬æ¢æˆ16è¿›åˆ¶ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">getHexString</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        String hexString = Integer.toHexString(value);</span><br><span class="line">        <span class="keyword">if</span> (hexString.length() == <span class="number">1</span>) &#123;</span><br><span class="line">            hexString = <span class="string">"0"</span> + hexString;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hexString;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…·ä½“è°ƒç”¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ObjectAnimator anim = ObjectAnimator.ofObject(myView2, <span class="string">"color"</span>, <span class="keyword">new</span> ColorEvaluator(), <span class="string">"#0000FF"</span>, <span class="string">"#FF0000"</span>);</span><br><span class="line">anim.setDuration(<span class="number">2000</span>);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure></p><p>æ­¤æ—¶è¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦æˆ‘ä»¬è§£å†³ï¼šå¦‚æœéœ€è¦å¯¹ view æ§ä»¶ï¼ˆæ¯”å¦‚ buttonï¼‰çš„å®½é«˜åšå˜æ¢ï¼Œä½†æ˜¯ç”±äºå› ä¸º View ä¸­<code>setWidth</code>å¹¶ä¸æ˜¯è®¾ç½® View çš„å®½åº¦ï¼Œè€Œæ˜¯è®¾ç½®æ§ä»¶çš„æœ€å¤§å’Œæœ€å°å®½åº¦ï¼Œæ‰€ä»¥é€šè¿‡<code>get/set</code>æ— æ³•æ”¹å˜æ§ä»¶çš„å®½åº¦ï¼Œä¹Ÿå°±æ— æ³•å®ç°åŠ¨ç”»æ•ˆæœã€‚</p><p>è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼ï¼ŒåŒ…è£…åŸå§‹åŠ¨ç”»å¯¹è±¡ï¼Œé—´æ¥ç»™å¯¹è±¡åŠ ä¸Šè¯¥å±æ€§çš„<code>get/set</code>æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ButtonWrapper wrapper = <span class="keyword">new</span> ViewWrapper(button);</span><br><span class="line">ObjectAnimator.ofInt(wrapper, <span class="string">"width"</span>, <span class="number">500</span>)</span><br><span class="line">        .setDuration(<span class="number">3000</span>)</span><br><span class="line">        .start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewWrapper</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> View mTarget;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ViewWrapper</span><span class="params">(View target)</span> </span>&#123;</span><br><span class="line">        mTarget = target;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¸ºå®½åº¦è®¾ç½®get/set</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getWidth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> mTarget.getLayoutParams().width;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> width)</span> </span>&#123;</span><br><span class="line">        mTarget.getLayoutParams().width = width;</span><br><span class="line">        mTarget.requestLayout();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="AnimatorSet"><a href="#AnimatorSet" class="headerlink" title="AnimatorSet"></a>AnimatorSet</h3><p>æœ€åä»‹ç»ç»„åˆåŠ¨ç”»ç±»ï¼Œä»…å±•ç¤ºç”¨æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ObjectAnimator translation = ObjectAnimator.ofFloat(mButton, <span class="string">"translationX"</span>, curTranslationX, <span class="number">300</span>,curTranslationX);  </span><br><span class="line">ObjectAnimator rotate = ObjectAnimator.ofFloat(mButton, <span class="string">"rotation"</span>, <span class="number">0f</span>, <span class="number">360f</span>);  </span><br><span class="line">ObjectAnimator alpha = ObjectAnimator.ofFloat(mButton, <span class="string">"alpha"</span>, <span class="number">1f</span>, <span class="number">0f</span>, <span class="number">1f</span>);  </span><br><span class="line"></span><br><span class="line">AnimatorSet animSet = <span class="keyword">new</span> AnimatorSet();  </span><br><span class="line"></span><br><span class="line">animSet.play(translation).with(rotate).before(alpha);  </span><br><span class="line">animSet.setDuration(<span class="number">5000</span>);  </span><br><span class="line">animSet.start();</span><br></pre></td></tr></table></figure></p><h2 id="Spring-Animation"><a href="#Spring-Animation" class="headerlink" title="Spring Animation"></a>Spring Animation</h2><p>SpringAnimationï¼Œå¼¹ç°§åŠ¨ç”»ï¼Œä½äº<code>android.support.animation</code>åŒ…ä¸­ï¼Œå±æ€§åŠ¨ç”»ä½äº<code>android.animation.Animator</code>åŒ…ä¸­ï¼Œå…¶å®é€šè¿‡ <a href="https://developer.android.com/reference/android/view/animation/BounceInterpolator.html" target="_blank" rel="noopener">BounceInterpolator</a> æˆ–è€… <a href="https://developer.android.com/reference/android/view/animation/OvershootInterpolator.html" target="_blank" rel="noopener">OvershootInterpolator</a> ä½œä¸ºæ’å€¼å™¨ï¼ŒåŒæ ·å¯ä»¥å®ç°å¼¹æ€§åŠ¨ç”»æ•ˆæœï¼Œå¼•å…¥ SpringAnimation æ˜¯å› ä¸ºå®ƒä½¿ç”¨æ›´ç®€å•ï¼Œè€Œä¸”ä¸Šä¸¤ä¸ªå·®å€¼å™¨å®ç°çš„è½¨è¿¹å¹¶ä¸ç¬¦åˆç‰©ç†å­¦ä¸Šçš„å¼¹è·³æ•ˆæœã€‚</p><p>ä½¿ç”¨ä¹‹å‰éœ€è¦å¯¼å…¥<code>com.android.support:support-dynamic-animation</code>åŒ…</p><h3 id="API-1"><a href="#API-1" class="headerlink" title="API"></a>API</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringAnimation</span><span class="params">(View v, ViewProperty property)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringAnimation</span><span class="params">(View v, ViewProperty property, <span class="keyword">float</span> finalPosition)</span></span></span><br></pre></td></tr></table></figure><p>å‚æ•°åˆ†åˆ«æ˜¯æ“ä½œå¯¹åº”çš„Viewï¼Œå¯¹åº”çš„å˜åŒ–å±æ€§åŠæœ€ç»ˆçš„ä½ç½®ã€‚</p><p>ViewProperty åŒ…æ‹¬(Zè½´æ”¯æŒéœ€è¦API &gt;= 21)ï¼š</p><blockquote><p>TRANSLATION_X<br>TRANSLATION_Y<br>TRANSLATION_Z<br>SCALE_X<br>SCALE_Y<br>ROTATION<br>ROTATION_X<br>ROTATION_Y<br>X<br>Y<br>Z<br>ALPHA<br>SCROLL_X<br>SCROLL_Y</p></blockquote><p>åœ¨ SpringAnimation ä¸­æœ‰ä¸€ä¸ª SpringForce å¯¹è±¡ï¼Œè´Ÿè´£å¯¹åº”çš„å˜é‡è®¾ç½®åŠä½ç½®è®¡ç®—ã€‚å…¶ä¸­åŒ…æ‹¬ä¸¤ä¸ªä¸ªå…³é”®å˜é‡</p><ul><li>Stiffness åˆšåº¦(åŠ²åº¦/å¼¹æ€§)ï¼Œåˆšåº¦è¶Šå¤§ï¼Œå½¢å˜äº§ç”Ÿçš„é‡Œä¹Ÿå°±è¶Šå¤§ï¼Œä½“ç°åœ¨æ•ˆæœä¸Šå°±æ˜¯è¿åŠ¨è¶Šå¿«</li><li>DampingRatio é˜»å°¼ç³»æ•°ï¼Œç³»æ•°è¶Šå¤§ï¼ŒåŠ¨ç”»åœæ­¢çš„è¶Šå¿«ã€‚ä»ç†è®ºä¸Šè®²åˆ†ä¸ºä¸‰ç§æƒ…å†µ Overdampedè¿‡é˜»å°¼ï¼ˆÎ¶ &gt; 1ï¼‰ã€Critically dampedä¸´ç•Œé˜»å°¼(Î¶ = 1)ã€Underdampedæ¬ é˜»å°¼çŠ¶æ€(0 &lt; Î¶ &lt;1)ã€‚</li></ul><h3 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SpringAnimation btnAnim = <span class="keyword">new</span> SpringAnimation(mButton, SpringAnimation.TRANSLATION_Y, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">btnAnim.getSpring().setStiffness(SpringForce.STIFFNESS_VERY_LOW);</span><br><span class="line">btnAnim.getSpring().setDampingRatio(SpringForce.DAMPING_RATIO_LOW_BOUNCY);</span><br><span class="line"></span><br><span class="line">btnAnim.setStartVelocity(<span class="number">10000</span>);  <span class="comment">//å¼€å§‹é€Ÿåº¦ï¼Œå•ä½æ˜¯px/second. æ­£æ•°æ˜¯å¼¹ç°§æ”¶ç¼©çš„æ–¹å‘ï¼Œè´Ÿæ•°ç›¸å</span></span><br><span class="line">btnAnim.start();</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;Android æä¾›äº†å¾ˆå¤šä¸°å¯Œçš„ API å»å®ç°åŠ¨ç”»æ•ˆæœï¼ŒåŠ ä¸Š SDK 25.3 æ—¶æ¨å‡ºçš„ SpringAnimationï¼Œæ€»å…±æœ‰ä¸‰å¤§ç±» Animation ä¾›å¼€å‘è€…ä½¿ç”¨ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="åŠ¨ç”»å¼€å‘" scheme="http://yoursite.com/tags/%E5%8A%A8%E7%94%BB%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>LeakCanaryæºç è§£æ</title>
    <link href="http://yoursite.com/LeakCanary%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <id>http://yoursite.com/LeakCanaryæºç è§£æ/</id>
    <published>2019-02-13T05:28:31.000Z</published>
    <updated>2019-03-15T15:27:06.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>å†…å­˜æ³„æ¼æ˜¯ Android å¼€å‘ä¸­æ— æ³•é¿å…çš„é—®é¢˜ï¼Œ<a href="https://github.com/square/leakcanary" target="_blank" rel="noopener">LeakCanary</a> æ¡†æ¶æ˜¯ Square å…¬å¸å¼€æºçš„å†…å­˜æ³„æ¼åˆ†æå·¥å…·ï¼Œå…¶é›†æˆæ–¹ä¾¿ï¼Œä½¿ç”¨ä¾¿æ·ã€‚<a id="more"></a></p><h2 id="ActivityLifecycleCallbacks"><a href="#ActivityLifecycleCallbacks" class="headerlink" title="ActivityLifecycleCallbacks"></a>ActivityLifecycleCallbacks</h2><p>LeakCanary çš„å®ç°åŸºç¡€ä¹‹ä¸€ï¼Œæ˜¯ Android å®˜æ–¹åœ¨4.0ï¼ˆAPI 14ï¼‰ä¹‹åå¼•å…¥çš„ ActivityLifecycleCallbacksï¼Œå®ƒæ˜¯ Application ç±»çš„å†…éƒ¨æ¥å£ï¼Œæä¾›åº”ç”¨ç”Ÿå‘½å‘¨æœŸå›è°ƒçš„æ³¨å†Œæ–¹æ³•ï¼Œä»¥é›†ä¸­ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><h3 id="æ¥å£æ–¹æ³•"><a href="#æ¥å£æ–¹æ³•" class="headerlink" title="æ¥å£æ–¹æ³•"></a>æ¥å£æ–¹æ³•</h3><p>å¯ä»¥çœ‹åˆ°è¯¥æ¥å£å®šä¹‰äº†å¦‚ä¸‹çš„ Activity çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•ï¼Œå…¶ä¸ Activity çš„å®Œæ•´å£°æ˜å‘¨æœŸå‡ ä¹æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ActivityLifecycleCallbacks</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(Activity activity, Bundle savedInstanceState)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onActivityStarted</span><span class="params">(Activity activity)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onActivityResumed</span><span class="params">(Activity activity)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onActivityPaused</span><span class="params">(Activity activity)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onActivityStopped</span><span class="params">(Activity activity)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onActivitySaveInstanceState</span><span class="params">(Activity activity, Bundle outState)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onActivityDestroyed</span><span class="params">(Activity activity)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç®€å•ç”¨æ³•"><a href="#ç®€å•ç”¨æ³•" class="headerlink" title="ç®€å•ç”¨æ³•"></a>ç®€å•ç”¨æ³•</h3><p>å¼€å‘ä¸­å¦‚æœæˆ‘ä»¬æƒ³è¦ç»Ÿä¸€ç®¡ç†é¡¹ç›®ä¸­æ‰€æœ‰çš„ Activityï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ ActivityManager å®ç°ï¼Œç„¶ååœ¨ BaseActivity ä¸­å¯¹æ¯ä¸€ä¸ª Activity åš put/get æ“ä½œï¼Œè¯¥åšæ³•çš„ç¼ºé™·æ˜¯æ— æ³•æ§åˆ¶ä¸€äº›ç¬¬ä¸‰æ–¹æ¡†æ¶çš„ Activityã€‚<br>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ActivityLifecycleCallbacks ï¼Œåœ¨è‡ªå®šä¹‰çš„ Application ä¸­ç»´æŠ¤ä¸€ä¸ª Activityé“¾è¡¨ï¼Œ ç”±äºæ‰€æœ‰çš„ Activity çš„ç”Ÿå‘½å‘¨æœŸéƒ½ä¼šå›è°ƒè¯¥æ¥å£ï¼Œå°±èƒ½å¤Ÿå®ç°å¯¹æ‰€æœ‰ Activity çš„ç»Ÿä¸€æ§åˆ¶å’Œç®¡ç†ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Activity&gt; activityList;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ACTIVITY_MAX_NUM = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        activityList = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        registerActivityLifecycleCallbacks(<span class="keyword">new</span> MyActivityCallbacks());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyActivityCallbacks</span> <span class="keyword">implements</span> <span class="title">ActivityLifecycleCallbacks</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(Activity activity, Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (activityList.size() &gt;= ACTIVITY_MAX_NUM) &#123;</span><br><span class="line">                activityList.remove(activityList.size()-<span class="number">1</span>).finish();</span><br><span class="line">            &#125;</span><br><span class="line">            activityList.add(activity);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityStarted</span><span class="params">(Activity activity)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityResumed</span><span class="params">(Activity activity)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityPaused</span><span class="params">(Activity activity)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityStopped</span><span class="params">(Activity activity)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivitySaveInstanceState</span><span class="params">(Activity activity, Bundle outState)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityDestroyed</span><span class="params">(Activity activity)</span> </span>&#123;</span><br><span class="line">            activityList.remove(activity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Activity <span class="title">getCurrentActivity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> activityList.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h2><p>åœ¨JDK 1.2ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè‹¥ä¸€ä¸ªå¯¹è±¡ä¸è¢«ä»»ä½•å˜é‡å¼•ç”¨ï¼Œé‚£ä¹ˆç¨‹åºå°±æ— æ³•å†ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å¯¹è±¡å¤„äºå¯è§¦åŠï¼ˆreachableï¼‰çŠ¶æ€ï¼Œç¨‹åºæ‰èƒ½ä½¿ç”¨å®ƒã€‚ä»JDK 1.2ç‰ˆæœ¬å¼€å§‹ï¼ŒæŠŠå¯¹è±¡çš„å¼•ç”¨åˆ†ä¸º4ç§çº§åˆ«ï¼Œä»è€Œä½¿ç¨‹åºèƒ½æ›´åŠ çµæ´»åœ°æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™4ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼šå¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨ã€‚</p><h3 id="å¼ºå¼•ç”¨"><a href="#å¼ºå¼•ç”¨" class="headerlink" title="å¼ºå¼•ç”¨"></a>å¼ºå¼•ç”¨</h3><p>å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰æ˜¯ä½¿ç”¨æœ€æ™®éçš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œé‚£åƒåœ¾å›æ”¶å™¨ç»ä¸ä¼šå›æ”¶å®ƒã€‚å½“å†…å­˜ç©ºé—´ä¸è¶³ï¼ŒJava è™šæ‹Ÿæœºå®æ„¿æŠ›å‡º OutOfMemoryError é”™è¯¯ï¼Œä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼Œä¹Ÿä¸ä¼šé éšæ„å›æ”¶å…·æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡æ¥è§£å†³å†…å­˜ä¸è¶³çš„é—®é¢˜ã€‚æ¯”å¦‚ç»å¸¸ä½¿ç”¨çš„<code>A a = new A()</code>ä¸­çš„å¼•ç”¨aã€‚</p><h3 id="è½¯å¼•ç”¨"><a href="#è½¯å¼•ç”¨" class="headerlink" title="è½¯å¼•ç”¨"></a>è½¯å¼•ç”¨</h3><p>è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰ç”¨æ¥æè¿°ä¸€äº›æœ‰ç”¨ä½†å¹¶ä¸æ˜¯å¿…éœ€çš„å¯¹è±¡ï¼Œåªæœ‰åœ¨å†…å­˜ä¸è¶³çš„æ—¶å€™ JVM æ‰ä¼šå›æ”¶è¯¥å¯¹è±¡ã€‚å› æ­¤ï¼Œè¿™ä¸€ç‚¹å¯ä»¥å¾ˆå¥½åœ°ç”¨æ¥è§£å†³OOMçš„é—®é¢˜ï¼Œå¹¶ä¸”è¿™ä¸ªç‰¹æ€§å¾ˆé€‚åˆç”¨æ¥å®ç°ç¼“å­˜ï¼šæ¯”å¦‚ç½‘é¡µç¼“å­˜ã€å›¾ç‰‡ç¼“å­˜ç­‰ã€‚</p><p>è½¯å¼•ç”¨å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå¦‚æœè½¯å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«JVMå›æ”¶ï¼Œè¿™ä¸ªè½¯å¼•ç”¨å°±ä¼šè¢«åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SoftReference&lt;String&gt; sr = <span class="keyword">new</span> SoftReference&lt;String&gt;(<span class="keyword">new</span> String(<span class="string">"hello"</span>));</span><br><span class="line">System.out.println(sr.get());</span><br></pre></td></tr></table></figure></p><h3 id="å¼±å¼•ç”¨"><a href="#å¼±å¼•ç”¨" class="headerlink" title="å¼±å¼•ç”¨"></a>å¼±å¼•ç”¨</h3><p>å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰ä¸è½¯å¼•ç”¨çš„åŒºåˆ«åœ¨äºï¼šåªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§ä½çš„çº¿ç¨‹ï¼Œå› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">WeakReference&lt;String&gt; sr = <span class="keyword">new</span> WeakReference&lt;String&gt;(<span class="keyword">new</span> String(<span class="string">"hello"</span>));</span><br><span class="line">         </span><br><span class="line">System.out.println(sr.get());</span><br><span class="line">System.gc();                <span class="comment">//é€šçŸ¥JVMçš„gcè¿›è¡Œåƒåœ¾å›æ”¶</span></span><br><span class="line">System.out.println(sr.get());</span><br></pre></td></tr></table></figure></p><p>æ‰“å°çš„ç»“æœä¸º</p><blockquote><p>hello<br><br>null</p></blockquote><p>å¼±å¼•ç”¨å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå½“å¼±å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼ŒJava è™šæ‹Ÿæœºå°±ä¼šæŠŠè¿™ä¸ªå¼±å¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ReferenceQueue queue = <span class="keyword">new</span> ReferenceQueue();</span><br><span class="line">WeakReference pr = <span class="keyword">new</span> WeakReference(object, queue);</span><br></pre></td></tr></table></figure></p><h3 id="è™šå¼•ç”¨"><a href="#è™šå¼•ç”¨" class="headerlink" title="è™šå¼•ç”¨"></a>è™šå¼•ç”¨</h3><p>PhantomReferenceï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å½¢åŒè™šè®¾ã€‚ä¸å…¶ä»–å‡ ç§å¼•ç”¨éƒ½ä¸åŒï¼Œè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼ŒæŸ¥çœ‹æºç å¯ä»¥å‘ç°ï¼Œå…¶<code>get()</code>æ°¸è¿œè¿”å›<code>null</code></p><p>è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ´»åŠ¨ã€‚è™šå¼•ç”¨ä¸è½¯å¼•ç”¨ã€å¼±å¼•ç”¨çš„ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼šè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ— ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhantomReference</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Reference</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PhantomReference</span><span class="params">(T referent, ReferenceQueue&lt;? <span class="keyword">super</span> T&gt; q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(referent, q);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LeakCanaryæºç "><a href="#LeakCanaryæºç " class="headerlink" title="LeakCanaryæºç "></a>LeakCanaryæºç </h2><p>å®é™…ä¸Š LeakCanary æ­£æ˜¯åˆ©ç”¨ Activity çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œé…åˆå¼±å¼•ç”¨æ£€æµ‹å®ç°å†…å­˜æ³„æ¼çš„åˆ†æã€‚</p><h3 id="æ‰§è¡Œæµç¨‹"><a href="#æ‰§è¡Œæµç¨‹" class="headerlink" title="æ‰§è¡Œæµç¨‹"></a>æ‰§è¡Œæµç¨‹</h3><p>è·Ÿè¸ªè°ƒç”¨çš„å…¥å£æ–¹æ³•<code>install</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="meta">@NonNull</span> <span class="function">RefWatcher <span class="title">install</span><span class="params">(@NonNull Application application)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> refWatcher(application).listenerServiceClass(DisplayLeakService.class)</span><br><span class="line">        .excludedRefs(AndroidExcludedRefs.createAppDefaults().build())</span><br><span class="line">        .buildAndInstall();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>listenerServiceClass</code>æ–¹æ³•ä½äº AndroidRefWatcherBuilder</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@NonNull</span> <span class="function">AndroidRefWatcherBuilder <span class="title">listenerServiceClass</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">      @NonNull Class&lt;? extends AbstractAnalysisResultService&gt; listenerServiceClass)</span> </span>&#123;</span><br><span class="line">      </span><br><span class="line">    enableDisplayLeakActivity = DisplayLeakService.class.isAssignableFrom(listenerServiceClass);</span><br><span class="line">    <span class="keyword">return</span> heapDumpListener(<span class="keyword">new</span> ServiceHeapDumpListener(context, listenerServiceClass));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥ç±»çš„çˆ¶ç±»ï¼ˆRefWatcherBuilderï¼‰å·²ç»é»˜è®¤å®ç° heapDumpListener å’Œ<code>excludedRefs</code>æ–¹æ³•ï¼ˆå®šä¹‰ä¸€äº›å¼€å‘è€…å¯ä»¥å¿½ç•¥çš„è·¯å¾„ï¼Œå³ä½¿å‘ç”Ÿäº†å†…å­˜æ³„æ¼ï¼ŒLeakCanary ä¹Ÿä¸ä¼šå¼¹å‡ºé€šçŸ¥ã€‚å¤§å¤šæ˜¯ç³»ç»Ÿ Bug å¯¼è‡´ï¼‰ã€‚ä¸‹é¢æ¥çœ‹æœ€ç»ˆè°ƒç”¨çš„æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@NonNull</span> <span class="function">RefWatcher <span class="title">buildAndInstall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (LeakCanaryInternals.installedRefWatcher != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"buildAndInstall() should only be called once."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    RefWatcher refWatcher = build();</span><br><span class="line">    <span class="keyword">if</span> (refWatcher != DISABLED) &#123;</span><br><span class="line">        <span class="keyword">if</span> (enableDisplayLeakActivity) &#123;</span><br><span class="line">            LeakCanaryInternals.setEnabledAsync(context, DisplayLeakActivity.class, <span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (watchActivities) &#123;</span><br><span class="line">            ActivityRefWatcher.install(context, refWatcher);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (watchFragments) &#123;</span><br><span class="line">            FragmentRefWatcher.Helper.install(context, refWatcher);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    LeakCanaryInternals.installedRefWatcher = refWatcher;</span><br><span class="line">    <span class="keyword">return</span> refWatcher;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸»è¦åšäº†ä¸‰ä»¶äº‹ï¼šBuild RefWatcherï¼›å¯ç”¨ DisplayLeakActivityï¼Œ ç”¨äºæ˜¾ç¤ºæ€§èƒ½ç»Ÿè®¡ç»“æœï¼›install ActivityRefWatcherã€‚ç»§ç»­è·Ÿè¸ª<code>install</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">install</span><span class="params">(@NonNull Context context, @NonNull RefWatcher refWatcher)</span> </span>&#123;</span><br><span class="line">    Application application = (Application) context.getApplicationContext();</span><br><span class="line">    ActivityRefWatcher activityRefWatcher = <span class="keyword">new</span> ActivityRefWatcher(application, refWatcher);</span><br><span class="line"></span><br><span class="line">    application.registerActivityLifecycleCallbacks(activityRefWatcher.lifecycleCallbacks);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆå‘˜å˜é‡ lifecycleCallbacks</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Application.ActivityLifecycleCallbacks lifecycleCallbacks =</span><br><span class="line">    <span class="keyword">new</span> ActivityLifecycleCallbacksAdapter  &#123;</span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityDestroyed</span><span class="params">(Activity activity)</span> </span>&#123;</span><br><span class="line">            refWatcher.watch(activity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯çŸ¥ LeakCanary å†…éƒ¨å®ç°äº†å¯¹ Activity ç”Ÿå‘½å‘¨æœŸçš„ç›‘å¬ï¼ŒActivityLifecycleCallbacksAdapter å…¶å®æ˜¯å¯¹  Application.ActivityLifecycleCallbacks ä¸­æ‰€æœ‰æ–¹æ³•éƒ½åšäº†ç©ºå®ç°çš„æŠ½è±¡ç±»ã€‚</p><p><code>watch</code>æ–¹æ³•ç”± RefWatcher é»˜è®¤å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">watch</span><span class="params">(Object watchedReference, String referenceName)</span> </span>&#123;</span><br><span class="line">    ......  </span><br><span class="line">    retainedKeys.add(key);</span><br><span class="line">    <span class="keyword">final</span> KeyedWeakReference reference =</span><br><span class="line">            <span class="keyword">new</span> KeyedWeakReference(watchedReference, key, referenceName, queue);</span><br><span class="line"></span><br><span class="line">    ensureGoneAsync(watchStartNanoTime, reference);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ retainedKeys æ˜¯ä¸€ä¸ª Set<string> é›†åˆï¼Œæ¯ä¸ªæ£€æµ‹çš„å¯¹è±¡éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„ keyï¼Œå­˜å‚¨åœ¨ retainedKeys ä¸­ã€‚<br>KeyedWeakReference æ˜¯ WeakReference çš„å­ç±»ï¼Œåœ¨å…¶åŸºç¡€ä¸Šæ·»åŠ äº† key å’Œ name ä¸¤ä¸ªå±æ€§ç”¨ä»¥è·Ÿè¸ªè®°å½•ã€‚å…¶ä¸­ä¼ å…¥äº†ä¸€ä¸ª queue å‚æ•°ï¼Œæ˜æ˜¾æ˜¯å¼•ç”¨é˜Ÿåˆ—ã€‚</string></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureGoneAsync</span><span class="params">(<span class="keyword">final</span> <span class="keyword">long</span> watchStartNanoTime, <span class="keyword">final</span> KeyedWeakReference reference)</span> </span>&#123;</span><br><span class="line">    watchExecutor.execute(<span class="keyword">new</span> Retryable() &#123;</span><br><span class="line">        <span class="meta">@Override</span> <span class="keyword">public</span> Retryable.<span class="function">Result <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> ensureGone(reference, watchStartNanoTime);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>watchExecutor ä¸º AndroidWatchExecutor å¯¹è±¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public AndroidWatchExecutor(long initialDelayMillis) &#123;</span><br><span class="line">    mainHandler = new Handler(Looper.getMainLooper());</span><br><span class="line">    HandlerThread handlerThread = new HandlerThread(LEAK_CANARY_THREAD_NAME);</span><br><span class="line">    handlerThread.start();</span><br><span class="line">    backgroundHandler = new Handler(handlerThread.getLooper());</span><br><span class="line">    this.initialDelayMillis = initialDelayMillis;</span><br><span class="line">    maxBackoffFactor = Long.MAX_VALUE / initialDelayMillis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override public void execute(@NonNull Retryable retryable) &#123;</span><br><span class="line">    if (Looper.getMainLooper().getThread() == Thread.currentThread()) &#123;</span><br><span class="line">        waitForIdle(retryable, 0);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        postWaitForIdle(retryable, 0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨<code>execute</code>ä¸­ï¼Œä¸ç®¡æ˜¯<code>waitForIdle</code>è¿˜æ˜¯<code>postWaitForIdle</code>éƒ½ä¼šåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œæœ€ç»ˆä¼šè°ƒç”¨ä»¥ä¸‹ä»£ç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Looper.myQueue().addIdleHandler(<span class="keyword">new</span> MessageQueue.IdleHandler() &#123;</span><br><span class="line">      <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">queueIdle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        postToBackgroundWithDelay(retryable, failedAttempts);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></p><p>é‚£ä¹ˆ IdleHandler åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ Handler æ˜¯å¾ªç¯å¤„ç† MessageQueue ä¸­çš„æ¶ˆæ¯çš„ï¼Œå½“æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ²¡æœ‰æ›´å¤šæ¶ˆæ¯éœ€è¦å¤„ç†ï¼Œä¸”å£°æ˜äº† IdleHandler æ¥å£çš„æ—¶å€™ï¼Œå°±ä¼šå»å¤„ç†è¿™é‡Œçš„æ“ä½œã€‚å³æŒ‡å®šä¸€äº›æ“ä½œï¼Œå½“çº¿ç¨‹ç©ºé—²çš„æ—¶å€™æ¥å¤„ç†ï¼Œæ­¤å¤„æ‰§è¡Œçš„ä¾¿æ˜¯å†…å­˜æ³„æ¼æ£€æµ‹å·¥ä½œã€‚</p><p><code>ensureGoneAsync</code>æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨<code>ensureGone</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Retryable.<span class="function">Result <span class="title">ensureGone</span><span class="params">(<span class="keyword">final</span> KeyedWeakReference reference, <span class="keyword">final</span> <span class="keyword">long</span> watchStartNanoTime)</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">    removeWeaklyReachableReferences();</span><br><span class="line">    ......</span><br><span class="line">    gcTrigger.runGc();</span><br><span class="line">    removeWeaklyReachableReferences();</span><br><span class="line">    <span class="keyword">if</span> (!gone(reference)) &#123;</span><br><span class="line">        ......</span><br><span class="line">        File heapDumpFile = heapDumper.dumpHeap();</span><br><span class="line">        ......</span><br><span class="line">        HeapDump heapDump = heapDumpBuilder.heapDumpFile(heapDumpFile).referenceKey(reference.key)</span><br><span class="line">            .referenceName(reference.name)</span><br><span class="line">            .watchDurationMs(watchDurationMs)</span><br><span class="line">            .gcDurationMs(gcDurationMs)</span><br><span class="line">            .heapDumpDurationMs(heapDumpDurationMs)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        heapdumpListener.analyze(heapDump);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> DONE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>removeWeaklyReachableReferences</code>éå†å¼•ç”¨é˜Ÿåˆ— queueï¼Œåˆ¤æ–­é˜Ÿåˆ—ä¸­æ˜¯å¦å­˜åœ¨å½“å‰ Activity çš„å¼±å¼•ç”¨ï¼Œå­˜åœ¨åˆ™åˆ é™¤ retainedKeys ä¸­å¯¹åº”å¼•ç”¨çš„ keyå€¼ã€‚</li><li>è°ƒç”¨<code>gcTrigger.runGc</code>å»è¿›è¡Œå†…å­˜å›æ”¶ï¼Œè¿™é‡Œæ²¡æœ‰ä½¿ç”¨<code>System.gc</code>ï¼Œæ˜¯å› ä¸ºå®ƒä»…ä»…æ˜¯é€šçŸ¥ç³»ç»Ÿåœ¨åˆé€‚çš„æ—¶é—´è¿›è¡Œä¸€æ¬¡åƒåœ¾å›æ”¶æ“ä½œï¼Œå¹¶ä¸èƒ½ä¿è¯ä¸€å®šæ‰§è¡Œã€‚</li><li>ä¸»åŠ¨è¿›è¡Œ GC ä¹‹åä¼šå†æ¬¡è°ƒç”¨<code>removeWeaklyReachableReferences</code>æ¸…é™¤ retainedKeys ä¸­å¼±å¼•ç”¨çš„ key å€¼ï¼Œå†åˆ¤æ–­æ˜¯å¦ç§»é™¤ã€‚å¦‚æœä»ç„¶æ²¡æœ‰ç§»é™¤ï¼Œåˆ¤å®šä¸ºå†…å­˜æ³„æ¼ã€‚</li><li>ç”Ÿæˆæ€§èƒ½ç»Ÿè®¡æ–‡ä»¶.hprofï¼Œè¿›è¡Œå†…å­˜æ³„æ¼çš„åˆ†æã€‚</li></ul><p>é‚£ä¹ˆ hprof æ–‡ä»¶æ˜¯è¢«è§£ææˆä¿¡æ¯çš„å‘¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AnalysisResult result = heapAnalyzer.checkForLeak(heapDump.heapDumpFile, heapDump.referenceKey);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> AnalysisResult <span class="title">checkForLeak</span><span class="params">(File heapDumpFile, String referenceKey)</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">    MemoryMappedFileBuffer e = <span class="keyword">new</span> MemoryMappedFileBuffer(heapDumpFile);</span><br><span class="line">    HprofParser parser = <span class="keyword">new</span> HprofParser(e);</span><br><span class="line">    Snapshot snapshot = parser.parse();</span><br><span class="line">    <span class="keyword">this</span>.deduplicateGcRoots(snapshot);</span><br><span class="line">    Instance leakingRef = <span class="keyword">this</span>.findLeakingReference(referenceKey, snapshot);</span><br><span class="line">    <span class="keyword">return</span> leakingRef == <span class="keyword">null</span> ? AnalysisResult.noLeak(<span class="keyword">this</span>.since(analysisStartNanoTime)) ï¼š</span><br><span class="line">        <span class="keyword">this</span>.findLeakTrace(analysisStartNanoTime, snapshot, leakingRef);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>checkForLeak</code>æ–¹æ³•ä½¿ç”¨äº† Square å…¬å¸çš„å¦ä¸€ä¸ªåº“ haha æ¥åˆ†æ Android heap dumpï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ‰§è¡Œè½¬åŒ–çš„æ–¹æ³•ä¸º HprofParser çš„<code>parse</code>æ–¹æ³•ï¼Œç„¶åå†å°†è½¬åŒ–çš„ä¿¡æ¯å°è£…æˆ AnalysisResult å¯¹è±¡ï¼Œå…¶ä¸­ HprofParser æ˜¯è‡ªå®šä¹‰çš„ç±»ï¼Œé‡Œé¢æœ‰ä¸€å®šçš„ç¯‡å¹…è§£æ .hprof æ–‡ä»¶ã€‚</p><p>å¾—åˆ°ç»“æœåå›è°ƒç»™ DisplayLeakServiceï¼Œè¯¥ Service ä¼šæ ¹æ®ä¼ å…¥è¿›æ¥çš„æ•°æ®å‘é€é€šçŸ¥ï¼Œå­˜å…¥æ•°æ®ã€‚ç‚¹å‡»å¯¹åº”çš„é€šçŸ¥è¿›å…¥ DisplayLeakActivity ç•Œé¢ï¼Œå°±èƒ½æŸ¥çœ‹æ³„æ¼æ—¥å¿—ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>LeakCanary æ£€æµ‹å†…å­˜æ³„æ¼çš„è®¾è®¡æ€è·¯ååˆ†å·§å¦™ã€æ¸…æ™°ã€‚æ•´ä¸ªæ¡†æ¶å¯¹äº ActivityLifecycleCallbacksã€WeakReferenceã€ReferenceQueue å’Œ IdleHandler çš„ä½¿ç”¨ï¼Œå››å¤§ç»„ä»¶çš„å¼€å¯å’Œå…³é—­ç­‰ç­‰ï¼Œéƒ½å¾ˆæœ‰æ„æ€ï¼Œå€¼å¾—æ·±å’Œå€Ÿé‰´ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;å†…å­˜æ³„æ¼æ˜¯ Android å¼€å‘ä¸­æ— æ³•é¿å…çš„é—®é¢˜ï¼Œ&lt;a href=&quot;https://github.com/square/leakcanary&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;LeakCanary&lt;/a&gt; æ¡†æ¶æ˜¯ Square å…¬å¸å¼€æºçš„å†…å­˜æ³„æ¼åˆ†æå·¥å…·ï¼Œå…¶é›†æˆæ–¹ä¾¿ï¼Œä½¿ç”¨ä¾¿æ·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://yoursite.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="å†…å­˜æ³„æ¼" scheme="http://yoursite.com/tags/%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/"/>
    
      <category term="æºç " scheme="http://yoursite.com/tags/%E6%BA%90%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>Javaè®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºå‹æ¨¡å¼</title>
    <link href="http://yoursite.com/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/Javaè®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºå‹æ¨¡å¼/</id>
    <published>2019-01-20T16:58:21.000Z</published>
    <updated>2019-03-15T15:27:56.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»"><a href="#è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»" class="headerlink" title="è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»"></a>è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»</h2><h3 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h3><p>è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰æ˜¯è½¯ä»¶å¼€å‘äººå‘˜åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸€èˆ¬é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚è¿™äº›è§£å†³æ–¹æ¡ˆæ˜¯ä¼—å¤šè½¯ä»¶å¼€å‘äººå‘˜ç»è¿‡ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´çš„è¯•éªŒå’Œé”™è¯¯æ€»ç»“å‡ºæ¥çš„ã€‚</p><p>1994 å¹´ï¼ŒErich Gammaã€Richard Helmã€Ralph Johnson å’Œ John Vlissides å››äººåˆè‘—å‡ºç‰ˆäº†ä¸€æœ¬ã€ŠDesign Patterns - Elements of Reusable Object-Oriented Softwareï¼ˆè®¾è®¡æ¨¡å¼ - å¯å¤ç”¨çš„é¢å‘å¯¹è±¡è½¯ä»¶å…ƒç´ ï¼‰ã€‹ çš„ä¹¦ï¼Œè¯¥ä¹¦é¦–æ¬¡æåˆ°äº†è½¯ä»¶å¼€å‘ä¸­è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µã€‚<a id="more"></a></p><p>å››ä½ä½œè€…åˆç§° GOFï¼ˆå››äººå¸®ï¼Œå…¨æ‹¼ Gang of Fourï¼‰ã€‚ä»–ä»¬æ‰€æå‡ºçš„è®¾è®¡æ¨¡å¼ä¸»è¦æ˜¯åŸºäºä»¥ä¸‹çš„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ã€‚</p><ul><li>å¯¹æ¥å£ç¼–ç¨‹è€Œä¸æ˜¯å¯¹å®ç°ç¼–ç¨‹ã€‚</li><li>ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ã€‚</li></ul><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><html><br><table class="tg"><tr><th class="tg-0pky">æ¨¡å¼</th><th class="tg-0pky">æè¿°</th><th class="tg-0pky">åŒ…å«</th></tr><tr><td class="tg-0pky">åˆ›å»ºå‹æ¨¡å¼</td><td class="tg-0pky"></td><td class="tg-0pky">å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰<br>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰<br>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰<br>å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰<br>åŸå‹æ¨¡å¼ï¼ˆPrototype Patternï¼‰</td></tr><tr><td class="tg-0pky">ç»“æ„å‹æ¨¡å¼</td><td class="tg-0pky">è¿™äº›è®¾è®¡æ¨¡å¼å…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»„åˆã€‚ç»§æ‰¿çš„æ¦‚å¿µè¢«ç”¨æ¥ç»„åˆæ¥å£å’Œå®šä¹‰ç»„åˆå¯¹è±¡è·å¾—æ–°åŠŸèƒ½çš„æ–¹å¼ã€‚</td><td class="tg-0pky">é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰<br>æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰<br>è¿‡æ»¤å™¨æ¨¡å¼ï¼ˆFilterã€Criteria Patternï¼‰<br>ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰<br>è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰<br>å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰<br>äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰<br>ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰</td></tr><tr><td class="tg-0lax">è¡Œä¸ºå‹æ¨¡å¼</td><td class="tg-0lax">è¿™äº›è®¾è®¡æ¨¡å¼ç‰¹åˆ«å…³æ³¨å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ã€‚</td><td class="tg-0lax">è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰<br>å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰<br>è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰<br>è¿­ä»£å™¨æ¨¡å¼ï¼ˆIterator Patternï¼‰<br>ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰<br>å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMemento Patternï¼‰<br>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰<br>çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰<br>ç©ºå¯¹è±¡æ¨¡å¼ï¼ˆNull Object Patternï¼‰<br>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰<br>æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰<br>è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰</td></tr><br></table><br></html><p>å¯ä»¥ä½¿ç”¨ä¸€å¼ å›¾æ¥å±•ç¤ºè®¾è®¡æ¨¡å¼ä¹‹é—´çš„å…³ç³»ï¼š</p><p><img src="/Javaè®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºå‹æ¨¡å¼/è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å…³ç³».jpg" alt="è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å…³ç³»"></p><h3 id="å…­ä¸ªåŸåˆ™ï¼š"><a href="#å…­ä¸ªåŸåˆ™ï¼š" class="headerlink" title="å…­ä¸ªåŸåˆ™ï¼š"></a>å…­ä¸ªåŸåˆ™ï¼š</h3><ul><li>å¼€é—­åŸåˆ™ï¼ˆOpen Close Principleï¼‰<blockquote><p>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p></blockquote></li></ul><ul><li><p>é‡Œæ°ä»£æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰</p><blockquote><p>åŸºç±»å¯ä»¥å‡ºç°çš„ä»»ä½•åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ã€‚</p></blockquote></li><li><p>ä¾èµ–å€’è½¬åŸåˆ™ï¼ˆDependence Inversion Principleï¼‰</p><blockquote><p>é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“ã€‚</p></blockquote></li><li><p>æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰</p><blockquote><p>é™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ã€‚</p></blockquote></li><li><p>è¿ªç±³ç‰¹æ³•åˆ™ï¼Œåˆç§°æœ€å°‘çŸ¥é“åŸåˆ™ï¼ˆDemeter Principleï¼‰</p><blockquote><p>å®ä½“åº”å½“å°½é‡å°‘åœ°ä¸å…¶ä»–å®ä½“å‘ç”Ÿç›¸äº’ä½œç”¨ï¼Œç³»ç»ŸåŠŸèƒ½æ¨¡å—åº”ç›¸å¯¹ç‹¬ç«‹ã€‚</p></blockquote></li><li><p>åˆæˆå¤ç”¨åŸåˆ™ï¼ˆComposite Reuse Principleï¼‰</p><blockquote><p>å°½é‡ä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿ã€‚</p></blockquote></li></ul><p>ä¸‰å¤§è®¾è®¡æ¨¡å¼å’Œå…­ä¸ªåŸåˆ™æ„æˆäº†è½¯ä»¶è®¾è®¡æ¨¡å¼çš„åŸºæœ¬å†…å®¹ï¼Œä¸‹é¢å°†ä»‹ç»åˆ›å»ºè€…æ¨¡å¼ã€‚</p><h2 id="åˆ›å»ºè€…æ¨¡å¼"><a href="#åˆ›å»ºè€…æ¨¡å¼" class="headerlink" title="åˆ›å»ºè€…æ¨¡å¼"></a>åˆ›å»ºè€…æ¨¡å¼</h2><h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><p>åˆ›å»ºå¯¹è±¡æ—¶ä¸æš´éœ²åˆ›å»ºé€»è¾‘ï¼Œé€šè¿‡ä½¿ç”¨å…±åŒçš„æ¥å£æ¥æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</p><p>å·¥å‚æ¨¡å¼å¯åˆ†ä¸ºç®€å•å·¥å‚ã€å·¥å‚æ–¹æ³•ã€æŠ½è±¡å·¥å‚ã€‚</p><h4 id="ç®€å•å·¥å‚"><a href="#ç®€å•å·¥å‚" class="headerlink" title="ç®€å•å·¥å‚"></a>ç®€å•å·¥å‚</h4><p>å·¥å‚ç±»ï¼ˆSimpleFactoryï¼‰æ‹¥æœ‰ä¸€ä¸ªå·¥å‚æ–¹æ³•ï¼ˆcreateï¼‰ï¼Œæ¥å—äº†ä¸€ä¸ªå‚æ•°ï¼Œé€šè¿‡ä¸åŒçš„å‚æ•°å®ä¾‹åŒ–ä¸åŒçš„äº§å“ç±»ã€‚</p><p><img src="/Javaè®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºå‹æ¨¡å¼/ç®€å•å·¥å‚.jpg" alt="ç®€å•å·¥å‚"></p><p>ç®€å•å·¥å‚ç®€å•ç²—æš´ï¼Œä½†æ˜¯å…¶ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œä¸€æ˜¯å½“äº§å“ç§ç±»ç¹å¤šæ—¶ä»£ç é‡æé«˜ï¼ŒäºŒæ˜¯å¢åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ä¿®æ”¹å·¥å‚å®ç°ï¼Œè¿èƒŒå¼€é—­åŸåˆ™ï¼ˆå¯¹æ‹“å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼‰ã€‚å·¥å‚æ–¹æ³•æ­£å¥½å¯ä»¥è§£å†³ç®€å•å·¥å‚çš„è¿™ä¸¤ä¸ªç¼ºç‚¹ã€‚</p><h4 id="å·¥å‚æ–¹æ³•"><a href="#å·¥å‚æ–¹æ³•" class="headerlink" title="å·¥å‚æ–¹æ³•"></a>å·¥å‚æ–¹æ³•</h4><p>å·¥å‚æ–¹æ³•é’ˆå¯¹æ¯ä¸€ç§äº§å“æä¾›ä¸€ä¸ªå·¥å‚ç±»ï¼Œé€šè¿‡ä¸åŒçš„å·¥å‚å®ä¾‹ï¼Œåˆ›å»ºä¸åŒçš„äº§å“å®ä¾‹ã€‚</p><p><img src="/Javaè®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºå‹æ¨¡å¼/å·¥å‚æ–¹æ³•.jpg" alt="å·¥å‚æ–¹æ³•"></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å·¥å‚æ–¹æ³•ä¸­ï¼Œå¢åŠ äº§å“ç§ç±»å¹¶ä¸éœ€è¦ä¿®æ”¹å·¥å‚ç±»ï¼Œåªéœ€è¦æ·»åŠ ç›¸åº”çš„å·¥å‚å³å¯ï¼Œç¬¦åˆå¼€æ”¾-å°é—­åŸåˆ™ã€‚å…¶ç¼ºç‚¹åœ¨äºï¼Œå¯¹äºæŸäº›å¯ä»¥å½¢æˆäº§å“æ—çš„æƒ…å†µï¼Œå¤„ç†èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¸€é—®é¢˜ä½¿ç”¨æŠ½è±¡å·¥å‚è§£å†³ã€‚</p><h4 id="æŠ½è±¡å·¥å‚"><a href="#æŠ½è±¡å·¥å‚" class="headerlink" title="æŠ½è±¡å·¥å‚"></a>æŠ½è±¡å·¥å‚</h4><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§æç«¯æƒ…å†µçš„æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆå³åªç”Ÿäº§ä¸€ç§äº§å“çš„æŠ½è±¡å·¥å‚æ¨¡å¼ï¼‰ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥çœ‹æˆæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸€ç§æ¨å¹¿ï¼Œå…¶é¢å¯¹äº§å“æ—ã€‚</p><p><img src="/Javaè®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºå‹æ¨¡å¼/æŠ½è±¡å·¥å‚.jpg" alt="æŠ½è±¡å·¥å‚"></p><p>ä»¥ä¸Šä»‹ç»çš„ä¸‰ç§å·¥å‚æ–¹æ³•å„æœ‰ä¼˜ç¼ºç‚¹</p><blockquote><p>ç®€å•å·¥å‚ï¼š ç”¨æ¥ç”Ÿäº§åŒä¸€ç­‰çº§ç»“æ„ä¸­çš„ä»»æ„äº§å“ã€‚ï¼ˆä¸æ”¯æŒæ‹“å±•å¢åŠ äº§å“ï¼‰ <br>å·¥å‚æ–¹æ³•ï¼šç”¨æ¥ç”Ÿäº§åŒä¸€ç­‰çº§ç»“æ„ä¸­çš„å›ºå®šäº§å“ã€‚ï¼ˆæ”¯æŒæ‹“å±•å¢åŠ äº§å“ï¼‰<br>  æŠ½è±¡å·¥å‚ï¼šç”¨æ¥ç”Ÿäº§ä¸åŒäº§å“æ—çš„å…¨éƒ¨äº§å“ã€‚ï¼ˆä¸æ”¯æŒæ‹“å±•å¢åŠ äº§å“ï¼›æ”¯æŒå¢åŠ äº§å“æ—ï¼‰<br>  </p></blockquote><h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><p>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚å…¶å…³é”®åœ¨äºæ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œé¢å‘æ‰€æœ‰å¯¹è±¡æä¾›å…¨å±€å•ä¾‹ã€‚å•ä¾‹æ¨¡å¼çš„ç¼ºé™·åœ¨äºæ²¡æœ‰æŠ½è±¡å±‚ï¼Œæ— æ³•è¿›è¡Œæ‹“å±•ï¼ŒåŒæ—¶å…¶ç±»ç»“æ„å¤æ‚ï¼Œè¿èƒŒäº†å•ä¸€èŒè´£åŸåˆ™ã€‚</p><p>å•ä¾‹æ¨¡å¼å¯åˆ†ä¸ºçº¿ç¨‹å®‰å…¨æ‡’æ±‰å¼ã€çº¿ç¨‹ä¸å®‰å…¨æ‡’æ±‰å¼ã€é¥¿æ±‰å¼ã€åŒé‡æ£€æŸ¥é”å¼ä»¥åŠé™æ€å†…éƒ¨ç±»ç­‰å¤šç§å®ç°æ–¹å¼ã€‚</p><h4 id="æ‡’æ±‰å¼"><a href="#æ‡’æ±‰å¼" class="headerlink" title="æ‡’æ±‰å¼"></a>æ‡’æ±‰å¼</h4><p>æ”¯æŒå»¶è¿Ÿåˆå§‹åŒ–ï¼Œä»£ç å¦‚ä¸‹ï¼Œç”±äºå…¶ä¸æ”¯æŒå¤šçº¿ç¨‹ï¼Œä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´å¹¶ä¸ç®—å•ä¾‹æ¨¡å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;  </span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æ”¯æŒå¤šçº¿ç¨‹ï¼Œå¯ä»¥ç»™<code>getInstance</code>æ–¹æ³•åŠ é”<code>synchronized</code>ï¼Œä½†æ˜¯æ•ˆç‡ä¼šå˜å¾—å¾ˆä½ã€‚</p><h4 id="é¥¿æ±‰å¼"><a href="#é¥¿æ±‰å¼" class="headerlink" title="é¥¿æ±‰å¼"></a>é¥¿æ±‰å¼</h4><p>ä¸ä¼šå»¶è¿Ÿåˆå§‹åŒ–ï¼Œå¤šçº¿ç¨‹å®‰å…¨ï¼Œç”±äºæ²¡æœ‰åŠ é”ï¼Œæ‰€ä»¥æ•ˆç‡æ›´é«˜ã€‚ç¼ºç‚¹æ˜¯ç±»åŠ è½½æ—¶å°±åˆå§‹åŒ–ï¼Œå ç”¨å†…å­˜ï¼ŒåŒæ—¶ä¹Ÿå¾ˆå®¹æ˜“äº§ç”Ÿåƒåœ¾å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŒæ£€å¼"><a href="#åŒæ£€å¼" class="headerlink" title="åŒæ£€å¼"></a>åŒæ£€å¼</h4><p>åŒæ£€å³Double Checked Lockingï¼Œå®‰å…¨ã€æ”¯æŒå»¶è¿Ÿåˆå§‹åŒ–ä¸”åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹èƒ½ä¿æŒé«˜æ€§èƒ½ã€‚<code>getInstance</code> çš„æ€§èƒ½å¯¹åº”ç”¨ç¨‹åºå¾ˆå…³é”®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton singleton;  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;  </span><br><span class="line">                <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;  </span><br><span class="line">                    singleton = <span class="keyword">new</span> Singleton();  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> singleton;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä½¿ç”¨äº†å…³é”®å­—<code>volatile</code>ï¼Œå…³äºè¯¥å…³é”®å­—çš„åˆ†æï¼š<a href="https://www.cnblogs.com/dolphin0520/p/3920373.html" target="_blank" rel="noopener">Javaå¹¶å‘ç¼–ç¨‹ï¼švolatileå…³é”®å­—è§£æ</a></p><blockquote><p>åœ¨ä¸ä½¿ç”¨ volatile æ—¶ï¼Œå‡è®¾ä¸¤ä¸ªçº¿ç¨‹Aã€Bç¬¬ä¸€æ¬¡è°ƒç”¨å•ä¾‹æ–¹æ³•ï¼Œå¦‚æœçº¿ç¨‹Aå…ˆæ‰§è¡Œ instance = new Instance()ï¼Œç”±äºæ„é€ æ–¹æ³•æ˜¯ä¸€ä¸ªéåŸå­æ“ä½œï¼Œç¼–è¯‘åä¼šç”Ÿæˆå¤šæ¡å­—èŠ‚ç æŒ‡ä»¤ï¼Œå› ä¸º Java çš„æŒ‡ä»¤é‡æ’åºï¼Œå¯èƒ½ä¼šå…ˆæ‰§è¡Œ instance çš„èµ‹å€¼æ“ä½œâ€”â€”åœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€ç‰‡å­˜å‚¨å¯¹è±¡çš„åŒºåŸŸï¼Œç„¶åç›´æ¥è¿”å›å†…å­˜çš„å¼•ç”¨ã€‚æ­¤æ—¶è™½ç„¶ instance ä¸ä¸ºç©ºï¼Œä½†å®é™…çš„åˆå§‹åŒ–æ“ä½œå´è¿˜æœªæ‰§è¡Œï¼Œå¦‚æœçº¿ç¨‹Bè¿›å…¥ï¼Œå°±ä¼šçœ‹åˆ°ä¸€ä¸ªä¸ä¸ºç©ºçš„ä½†æ˜¯ä¸å®Œæ•´ï¼ˆæ²¡æœ‰å®Œæˆåˆå§‹åŒ–ï¼‰çš„ instance å¯¹è±¡ã€‚<br>volatile å…³é”®å­—ä¿è¯ä¸åŒçº¿ç¨‹å¯¹å˜é‡è¿›è¡Œæ“ä½œæ—¶çš„å¯è§æ€§ï¼Œç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼Œä»è€Œå®‰å…¨çš„å®ç°å•ä¾‹ã€‚</p></blockquote><h4 id="é™æ€å†…éƒ¨ç±»å¼"><a href="#é™æ€å†…éƒ¨ç±»å¼" class="headerlink" title="é™æ€å†…éƒ¨ç±»å¼"></a>é™æ€å†…éƒ¨ç±»å¼</h4><p>èƒ½è¾¾åˆ°åŒæ£€é”æ–¹å¼ä¸€æ ·çš„åŠŸæ•ˆï¼Œä½†å®ç°æ›´ç®€å•ã€‚è¿™ç§æ–¹å¼åªé€‚ç”¨äºé™æ€åŸŸçš„æƒ…å†µï¼ŒåŒæ£€é”æ–¹å¼å¯åœ¨å®ä¾‹åŸŸéœ€è¦å»¶è¿Ÿåˆå§‹åŒ–æ—¶ä½¿ç”¨ã€‚</p><p>ä¸åŒæ£€å¼æ–¹å¼ä¸€æ ·åˆ©ç”¨<code>ClassLoder</code>æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–<code>instance</code>æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚<br>å…³äº ClassLoaderï¼š<a href="https://blog.csdn.net/briblue/article/details/54973413" target="_blank" rel="noopener">ä¸€çœ‹ä½ å°±æ‡‚ï¼Œè¶…è¯¦ç»†javaä¸­çš„ClassLoaderè¯¦è§£</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();  </span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›¸è¾ƒäºåŒé‡æ£€æŸ¥é”ï¼Œç”±äºé™æ€å†…éƒ¨ç±»çš„ç‰¹æ€§â€”â€”éœ€è¦ä½¿ç”¨æ‰ä¼šè£…è½½åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®é™…ä¸Šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨<code>getInstance</code>ä¹‹å‰ï¼ŒSingletonHolder æ˜¯æ²¡æœ‰è¢«è£…è½½è¿›æ¥çš„ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨äº† getInstance() ä¹‹åï¼Œå†…éƒ¨é™æ€ç±»çš„å®ä¾‹æ‰ä¼šçœŸæ­£è£…è½½ã€‚</p><h4 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h4><p>å®ç°å•ä¾‹æ¨¡å¼çš„æœ€ä½³æ–¹æ³•ã€‚ç®€æ´ã€æ”¯æŒåºåˆ—åŒ–ã€ç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Singleton &#123;  </span><br><span class="line"></span><br><span class="line">    INSTANCE;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whateverMethod</span><span class="params">()</span> </span>&#123;&#125;  </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å»ºé€ è€…æ¨¡å¼"><a href="#å»ºé€ è€…æ¨¡å¼" class="headerlink" title="å»ºé€ è€…æ¨¡å¼"></a>å»ºé€ è€…æ¨¡å¼</h3><p>ä½¿ç”¨å¤šä¸ªç®€å•çš„å¯¹è±¡é€æ­¥æ„å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚ä¸‹é¢çš„ä¾‹å­æ¯”è¾ƒç®€å•ç›´è§‚ï¼Œå®é™…ä¸Šåœ¨å¤æ‚çš„ç³»ç»Ÿä¸­å¯ä»¥åŒ…å«å•ç‹¬çš„ Director ã€Builder ç”šè‡³æŠ½è±¡å±‚ç­‰å…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> height;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> weight;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å¿…è¦å‚æ•°</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> name;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯é€‰å‚æ•°</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> height = <span class="number">170</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> weight = <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">height</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.height = height;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">weight</span><span class="params">(<span class="keyword">int</span> weight)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.weight = weight;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Human <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Human(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Human</span><span class="params">(Builder builder)</span> </span>&#123;</span><br><span class="line">        name = builder.name;</span><br><span class="line">        height = builder.height;</span><br><span class="line">        weight = builder.weight;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Human human = <span class="keyword">new</span> Human.Builder(<span class="string">"Jack"</span>)</span><br><span class="line">                    .height(<span class="number">175</span>)</span><br><span class="line">                    .weight(<span class="number">60</span>)</span><br><span class="line">                    .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸå‹æ¨¡å¼"><a href="#åŸå‹æ¨¡å¼" class="headerlink" title="åŸå‹æ¨¡å¼"></a>åŸå‹æ¨¡å¼</h3><p>å½“ç›´æ¥åˆ›å»ºå¯¹è±¡çš„ä»£ä»·æ¯”è¾ƒå¤§æ—¶ï¼ˆä¾‹å¦‚æ•°æ®åº“å¯¹è±¡æ“ä½œï¼‰ï¼Œå¯ä»¥é‡‡ç”¨è¿™ç§æ¨¡å¼å…‹éš†å‡ºå¤šä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ã€‚</p><p>Javaçš„<code>clone</code>æ–¹æ³•ä¾¿æ˜¯ä½¿ç”¨äº†è¿™ç§æ–¹æ³•ï¼Œå…³äºè¯¥æ–¹æ³•ï¼š<a href="https://www.cnblogs.com/xuanxufeng/p/6558330.html" target="_blank" rel="noopener">javaå¯¹è±¡å…‹éš†ä»¥åŠæ·±æ‹·è´å’Œæµ…æ‹·è´</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> inteface Prototype &#123;</span><br><span class="line">    <span class="function">Prototype <span class="title">clone</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcretePrototype</span> <span class="title">implement</span> <span class="title">Prototype</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> override Prototype <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Prototype prototype = <span class="keyword">new</span> ConcretePrototype();</span><br><span class="line">        <span class="keyword">return</span> prototype;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Prototype p1 = <span class="keyword">new</span> ConcretePrototype();</span><br><span class="line">        Prototype p2 = p1.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»&quot;&gt;&lt;a href=&quot;#è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»&quot; class=&quot;headerlink&quot; title=&quot;è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»&quot;&gt;&lt;/a&gt;è®¾è®¡æ¨¡å¼åŠå…¶åˆ†ç±»&lt;/h2&gt;&lt;h3 id=&quot;è®¾è®¡æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è®¾è®¡æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è®¾è®¡æ¨¡å¼&quot;&gt;&lt;/a&gt;è®¾è®¡æ¨¡å¼&lt;/h3&gt;&lt;p&gt;è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰æ˜¯è½¯ä»¶å¼€å‘äººå‘˜åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸€èˆ¬é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚è¿™äº›è§£å†³æ–¹æ¡ˆæ˜¯ä¼—å¤šè½¯ä»¶å¼€å‘äººå‘˜ç»è¿‡ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´çš„è¯•éªŒå’Œé”™è¯¯æ€»ç»“å‡ºæ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;1994 å¹´ï¼ŒErich Gammaã€Richard Helmã€Ralph Johnson å’Œ John Vlissides å››äººåˆè‘—å‡ºç‰ˆäº†ä¸€æœ¬ã€ŠDesign Patterns - Elements of Reusable Object-Oriented Softwareï¼ˆè®¾è®¡æ¨¡å¼ - å¯å¤ç”¨çš„é¢å‘å¯¹è±¡è½¯ä»¶å…ƒç´ ï¼‰ã€‹ çš„ä¹¦ï¼Œè¯¥ä¹¦é¦–æ¬¡æåˆ°äº†è½¯ä»¶å¼€å‘ä¸­è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Javaè®¾è®¡æ¨¡å¼ï¼šè¡Œä¸ºå‹æ¨¡å¼</title>
    <link href="http://yoursite.com/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%9A%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/Javaè®¾è®¡æ¨¡å¼ï¼šè¡Œä¸ºå‹æ¨¡å¼/</id>
    <published>2019-01-20T16:57:00.000Z</published>
    <updated>2019-03-15T15:27:46.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è´£ä»»é“¾æ¨¡å¼"><a href="#è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="è´£ä»»é“¾æ¨¡å¼"></a>è´£ä»»é“¾æ¨¡å¼</h2><p>è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ï¼Œæ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ã€‚è¯¥æ¨¡å¼åœ¨ Java Webä¸­æœ‰å¾ˆå¤šåº”ç”¨ï¼Œå¦‚ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ï¼ŒStruts2 çš„æ‹¦æˆªå™¨ï¼ŒJSP Servlet çš„ Filterç­‰ç­‰ã€‚<a id="more"></a></p><p>åˆ›å»ºæŠ½è±¡ç±» AbstractLoggerï¼Œå¸¦æœ‰è¯¦ç»†çš„æ—¥å¿—è®°å½•çº§åˆ«ï¼Œåœ¨å…¶åŸºç¡€ä¸Šæ‹“å±•å‡ºä¸‰ä¸ªè®°å½•å™¨ï¼Œå¦‚æœæ¶ˆæ¯çš„çº§åˆ«å±äºè‡ªå·±ï¼Œåˆ™è®°å½•å™¨å°†å…¶æ‰“å°ï¼Œå¦åˆ™æŠŠæ¶ˆæ¯ä¼ ç»™ä¸‹ä¸€ä¸ªè®°å½•å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractLogger</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> INFO = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> DEBUG = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> ERROR = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> level;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è´£ä»»é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    <span class="keyword">protected</span> AbstractLogger nextLogger;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextLogger</span><span class="params">(AbstractLogger nextLogger)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.nextLogger = nextLogger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">logMessage</span><span class="params">(<span class="keyword">int</span> level, String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.level &lt;= level) &#123;</span><br><span class="line">            write(message);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nextLogger != <span class="keyword">null</span>) &#123;</span><br><span class="line">            nextLogger.logMessage(level, message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(String message)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ DebugLogger ä¸­<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DebugLogger</span> <span class="keyword">extends</span> <span class="title">AbstractLogger</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DebugLogger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        level = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DebugLogger: "</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è°ƒç”¨<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> AbstractLogger <span class="title">getChainOfLogger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    AbstractLogger infoLogger = <span class="keyword">new</span> InfoLogger();</span><br><span class="line">    AbstractLogger debugLogger = <span class="keyword">new</span> DebugLogger();</span><br><span class="line">    AbstractLogger errorLogger = <span class="keyword">new</span> ErrorLogger();</span><br><span class="line">    </span><br><span class="line">    infoLogger.setNextLogger(debugLogger);</span><br><span class="line">    debugLogger.setNextLogger(errorLogger);</span><br><span class="line">    <span class="keyword">return</span> infoLogger;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    AbstractLogger logger = getChainOfLogger();</span><br><span class="line"></span><br><span class="line">    logger.logMessage(AbstractLogger.INFO, <span class="string">"an info msg"</span>);</span><br><span class="line">    logger.logMessage(AbstractLogger.DEBUG, <span class="string">"a debug msg"</span>);</span><br><span class="line">    logger.logMessage(AbstractLogger.ERROR, <span class="string">"an error msg"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ§åˆ¶å°è¾“å‡ºç»“æœä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">InfoLogger: an info msg</span><br><span class="line">InfoLogger: a debug msg</span><br><span class="line">DebugLogger: a debug msg</span><br><span class="line">InfoLogger: an error msg</span><br><span class="line">DebugLogger: an error msg</span><br><span class="line">ErrorLogger: an error msg</span><br></pre></td></tr></table></figure></p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h3><p>ä¸€ç§æ•°æ®é©±åŠ¨çš„è®¾è®¡æ¨¡å¼ï¼Œè¯·æ±‚ä»¥å‘½ä»¤çš„å½¢å¼åŒ…è£¹åœ¨å¯¹è±¡ä¸­ï¼Œå¹¶ä¼ ç»™è°ƒç”¨å¯¹è±¡ã€‚è°ƒç”¨å¯¹è±¡å¯»æ‰¾å¯ä»¥å¤„ç†è¯¥å‘½ä»¤çš„åˆé€‚çš„å¯¹è±¡ï¼Œå¹¶å°†å‘½ä»¤ä¼ ç»™å®ƒä»¥æ‰§è¡Œå‘½ä»¤ã€‚è°ƒç”¨å¯¹è±¡å¯»æ‰¾åˆé€‚å¯¹è±¡çš„è¿‡ç¨‹å°±åƒå¼€å…³æ§åˆ¶ç”µå™¨ï¼Œå®ƒå¹¶ä¸éœ€è¦çŸ¥é“ç”µå™¨çš„å…·ä½“æƒ…å†µï¼Œåªéœ€è¦æ ¹æ®å‘½ä»¤ï¼Œæ§åˆ¶ä¸åŒç”µçº¿çš„è¿é€šçŠ¶æ€ã€‚æ¨¡å¼å®ç°çš„ä»£ç è¾ƒç¹çï¼Œå…·ä½“çš„ä¾‹å­ç§»æ­¥ï¼š<a href="http://cache.baiducontent.com/c?m=9f65cb4a8c8507ed19fa950d100b92235c4380146d8b804b2281d25f93130a1c187babf37d714c518a82213a1cfc091ab1a16825761e2bb490c38f40d7ac925f75ce786a6459db0144dc41fc8f1532c050872be8b86d96ad813184d9a5c4de2444bb55120981e7fa291764bc&amp;p=8b2a971c87dd11a05db0e63c49&amp;newp=882a900d959603ee19be9b7c4553d8224216ed6039d0c44324b9d71fd325001c1b69e7bf20271707d7ce786d0ba54f5beefa3476301766dada9fca458ae7c4606cdd657531&amp;user=baidu&amp;fm=sc&amp;query=java%C3%FC%C1%EE%C4%A3%CA%BD&amp;qid=c0e757ac00089354&amp;p1=5" target="_blank" rel="noopener">Javaè®¾è®¡æ¨¡å¼â€“å‘½ä»¤æ¨¡å¼ï¼ˆä»¥ç®¡ç†æ™ºèƒ½å®¶ç”µä¸ºä¾‹ï¼‰</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è´£ä»»é“¾æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è´£ä»»é“¾æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è´£ä»»é“¾æ¨¡å¼&quot;&gt;&lt;/a&gt;è´£ä»»é“¾æ¨¡å¼&lt;/h2&gt;&lt;p&gt;è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ï¼Œæ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ã€‚è¯¥æ¨¡å¼åœ¨ Java Webä¸­æœ‰å¾ˆå¤šåº”ç”¨ï¼Œå¦‚ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ï¼ŒStruts2 çš„æ‹¦æˆªå™¨ï¼ŒJSP Servlet çš„ Filterç­‰ç­‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Javaè®¾è®¡æ¨¡å¼ï¼šç»“æ„å‹æ¨¡å¼</title>
    <link href="http://yoursite.com/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%9A%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/Javaè®¾è®¡æ¨¡å¼ï¼šç»“æ„å‹æ¨¡å¼/</id>
    <published>2019-01-20T16:56:04.000Z</published>
    <updated>2019-03-15T15:27:32.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h2><p>åœ¨ Android å¼€å‘ä¸­ï¼Œç»å¸¸èƒ½è§åˆ°å„ç§å„æ ·çš„ Adapter ç±»ï¼Œå…¶é‡‡ç”¨çš„æ­£æ˜¯é€‚é…å™¨æ¨¡å¼ã€‚è¯¥è®¾è®¡æ¨¡å¼ä½œä¸ºä¸¤ä¸ªä¸å…¼å®¹çš„æ¥å£ä¹‹é—´çš„æ¡¥æ¢ï¼Œå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä»è€Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚<a id="more"></a></p><p>ç”¨ç”µæºæ¥å£ä¸¾ä¾‹ï¼Œç¬”è®°æœ¬ç”µè„‘çš„ç”µæºéœ€è¦æ¥å…¥5Vçš„ç”µå‹ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨220vçš„äº¤æµç”µå‹ï¼Œä¸¤è€…å¹¶ä¸åŒ¹é…ï¼Œåœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œè¯¥ç°è±¡ç§°ä¹‹ä¸ºæ¥å£ä¸å…¼å®¹ï¼Œæ­¤æ—¶å°±éœ€è¦é€‚é…å™¨æ¥è¿›è¡Œæ¥å£è½¬æ¢ã€‚è¿™ä¸ªè½¬æ¢çš„ä¸­é—´å±‚ä¾¿æ˜¯ Adapter å±‚ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦5vçš„ç”µå‹ï¼Œå› æ­¤<code>Volt5V</code>ç§°ä¸º<code>Target</code>ï¼Œè€Œä¸å…¼å®¹çš„220Vç”µå‹ç§°ä¹‹ä¸º<code>Adaptee</code>ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯é€‚é…è®¾è®¡ä¸€ä¸ª<code>Adpater</code>ï¼Œæ–¹æ³•æœ‰ä¸¤ç§ã€‚</p><h3 id="ç±»é€‚é…å™¨æ¨¡å¼"><a href="#ç±»é€‚é…å™¨æ¨¡å¼" class="headerlink" title="ç±»é€‚é…å™¨æ¨¡å¼"></a>ç±»é€‚é…å™¨æ¨¡å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Volt5V</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get5V</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Volt220V</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get220V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">220</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adapter</span> <span class="keyword">extends</span> <span class="title">Volt220V</span> <span class="keyword">implements</span> <span class="title">Volt5V</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get5V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Adapter adapter = <span class="keyword">new</span> Adapter();</span><br><span class="line">    System.out.println(<span class="string">"è·å–éœ€è¦çš„5Vç”µæºï¼š"</span> + adapter.get5V());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¯¹è±¡é€‚é…å™¨æ¨¡å¼"><a href="#å¯¹è±¡é€‚é…å™¨æ¨¡å¼" class="headerlink" title="å¯¹è±¡é€‚é…å™¨æ¨¡å¼"></a>å¯¹è±¡é€‚é…å™¨æ¨¡å¼</h3><p>ä¸ç±»é€‚é…å™¨æ¨¡å¼ä¸€æ ·ï¼Œå¯¹è±¡é€‚é…å™¨æ¨¡å¼æŠŠè¢«é€‚é…çš„ç±»çš„APIè½¬æ¢æˆä¸ºç›®æ ‡ç±»çš„APIï¼Œä¸åŒçš„æ˜¯ï¼Œå¯¹è±¡é€‚é…å™¨æ¨¡å¼çš„è¿æ¥æ–¹å¼ä¸æ˜¯ç»§æ‰¿ï¼Œå…¶ä½¿ç”¨ä»£ç†å…³ç³»è¿æ¥åˆ°Adapteeç±»ã€‚<br>ã€€ã€€<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ObjectAdapter</span> <span class="keyword">implements</span> <span class="title">Volt5V</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Volt220V volt220V;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ObjectAdapter</span><span class="params">(Volt220V adaptee)</span> </span>&#123;</span><br><span class="line">        volt220V = adaptee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get5V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get220V</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> volt220V.get220V();</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…³äº Android ä¸­ ListView ä¸­çš„ Adapterï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://blog.csdn.net/bboyfeiyu/article/details/43950185" target="_blank" rel="noopener">Androidæºç ä¹‹ListViewçš„é€‚é…å™¨æ¨¡å¼</a></p><h2 id="ç»„åˆæ¨¡å¼"><a href="#ç»„åˆæ¨¡å¼" class="headerlink" title="ç»„åˆæ¨¡å¼"></a>ç»„åˆæ¨¡å¼</h2><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„æ¥è¡¨ç°â€éƒ¨åˆ†-æ•´ä½“â€œçš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—å®¢æˆ·ä»¥ä¸€è‡´çš„æ–¹å¼å¤„ç†å•ä¸ªå¯¹è±¡ä»¥åŠå¯¹è±¡çš„ç»„åˆã€‚<br>ç»„åˆæ¨¡å¼å®ç°çš„æœ€å…³é”®çš„åœ°æ–¹æ˜¯â€”â€”ç®€å•å¯¹è±¡å’Œå¤åˆå¯¹è±¡å¿…é¡»å®ç°ç›¸åŒçš„æ¥å£ã€‚è¿™å°±æ˜¯ç»„åˆæ¨¡å¼èƒ½å¤Ÿå°†ç»„åˆå¯¹è±¡å’Œç®€å•å¯¹è±¡è¿›è¡Œä¸€è‡´å¤„ç†çš„åŸå› ã€‚</p><ul><li>ç»„åˆéƒ¨ä»¶ï¼ˆComponentï¼‰ï¼šå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œä¸ºè¦ç»„åˆçš„å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ã€‚</li><li>å¶å­ï¼ˆLeafï¼‰ï¼šåœ¨ç»„åˆä¸­è¡¨ç¤ºå­èŠ‚ç‚¹å¯¹è±¡ï¼Œå¶å­èŠ‚ç‚¹ä¸èƒ½æœ‰å­èŠ‚ç‚¹ã€‚</li><li>åˆæˆéƒ¨ä»¶ï¼ˆCompositeï¼‰ï¼šå®šä¹‰æœ‰æèŠ‚ç‚¹çš„è¡Œä¸ºï¼Œç”¨æ¥å­˜å‚¨éƒ¨ä»¶ï¼Œå®ç°åœ¨Componentæ¥å£ä¸­çš„æœ‰å…³æ“ä½œï¼Œå¦‚å¢åŠ ï¼ˆAddï¼‰å’Œåˆ é™¤ï¼ˆRemoveï¼‰ã€‚</li></ul><p>å¯¹äºé€æ˜ç»„åˆæ¨¡å¼æ¥è¯´ï¼ŒComponent ä¸­å£°æ˜æ‰€æœ‰ç®¡ç†å­å¯¹è±¡çš„æ–¹æ³•ï¼Œå…¶ä¸­åŒ…æ‹¬Addï¼ŒRemoveç­‰ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¶èŠ‚ç‚¹å’ŒæèŠ‚ç‚¹å…·å¤‡å®Œå…¨ä¸€è‡´çš„æ¥å£ï¼Œå¯¹äºå¤–ç•Œæ²¡æœ‰åŒºåˆ«ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡æ„ä»¶ï¼Œå£°æ˜ä¸€ä¸ªæ¥å£ç”¨äºè®¿é—®å’Œç®¡ç†Componentçš„å­éƒ¨ä»¶</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Component</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component component)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component component)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ˜¾ç¤ºå±‚çº§ç»“æ„</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">Display</span><span class="params">(<span class="keyword">int</span> level)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¶å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Leaf</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Leaf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ— æ„ä¹‰çš„å®ç°</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component component)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ— æ„ä¹‰çš„å®ç°</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component component)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Display</span><span class="params">(<span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"-"</span> + level);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æèŠ‚ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Composite</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Composite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Component&gt; children = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line">        children.add(component);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line">        children.remove(component);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Display</span><span class="params">(<span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        children.forEach(</span><br><span class="line">                component -&gt; component.Display(level + <span class="number">2</span>)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™ç§æ–¹å¼æ¥è¯´ï¼Œå¶å­èŠ‚ç‚¹å¹¶ä¸å…·å¤‡ addã€remove ç­‰æ–¹æ³•ï¼Œå¯¹ä»–ä»¬çš„å®ç°æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå¯ä»¥é‡‡ç”¨å®‰å…¨å¼ç»„åˆæ¨¡å¼ï¼Œå°†å¶å­èŠ‚ç‚¹ä¸å…·å¤‡çš„åŠŸèƒ½ä¸‹æ”¾åˆ°æèŠ‚ç‚¹ä¸­å®ç°ã€‚è¯¥åšæ³•çš„å¼Šç«¯æ˜¯å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œå¿…é¡»å¯¹å¶èŠ‚ç‚¹å’ŒæèŠ‚ç‚¹è¿›è¡Œåˆ¤å®šï¼Œä½¿ç”¨ä¸ä¾¿ã€‚</p><h2 id="è£…é¥°å™¨æ¨¡å¼"><a href="#è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="è£…é¥°å™¨æ¨¡å¼"></a>è£…é¥°å™¨æ¨¡å¼</h2><p>å‘ä¸€ä¸ªç°æœ‰çš„å¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼ŒåŒæ—¶åˆä¸æ”¹å˜å…¶ç»“æ„ã€‚<br><br>åˆ›å»ºä¸€ä¸ª Shape æ¥å£å’Œå®ç°äº† Shape æ¥å£çš„å®ä½“ç±»ã€‚ç„¶ååˆ›å»ºä¸€ä¸ªå®ç°äº† Shape æ¥å£çš„æŠ½è±¡è£…é¥°ç±» ShapeDecoratorï¼Œå¹¶æŠŠ Shape å¯¹è±¡ä½œä¸ºå®ƒçš„å®ä¾‹å˜é‡ã€‚<br>RedShapeDecorator æ˜¯å®ç°äº† ShapeDecorator çš„å®ä½“ç±»ï¼Œç”¨æ¥è£…é¥° Shape å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Draw a circle"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ç°äº† Shape æ¥å£çš„æŠ½è±¡è£…é¥°ç±»ã€‚</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ShapeDecorator</span> <span class="keyword">implements</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Shape decoratedShape;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShapeDecorator</span><span class="params">(Shape decoratedShape)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.decoratedShape = decoratedShape;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        decoratedShape.draw();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“çš„è£…é¥°ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RedShapeDecorator</span> <span class="keyword">extends</span> <span class="title">ShapeDecorator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RedShapeDecorator</span><span class="params">(Shape decoratedShape)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(decoratedShape);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        decoratedShape.draw();</span><br><span class="line">        setRedBorder(decoratedShape);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setRedBorder</span><span class="params">(Shape decoratedShape)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Border color: Red"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h2><p>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†é™æ€ä»£ç†çš„è¿‡ç¨‹ï¼Œåˆ›å»ºä¸€ä¸ª Image æ¥å£å’Œå®ç°äº† Image æ¥å£çš„å®ä½“ç±»ã€‚ProxyImage æ˜¯ä¸€ä¸ªä»£ç†ç±»ï¼Œå‡å°‘ RealImage å¯¹è±¡åŠ è½½çš„å†…å­˜å ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Image</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RealImage</span> <span class="keyword">implements</span> <span class="title">Image</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String fileName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RealImage</span><span class="params">(String fileName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fileName = fileName;</span><br><span class="line">        loadFromDisk(fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Displaying "</span> + fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">loadFromDisk</span><span class="params">(String fileName)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Loading "</span> + fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProxyImage</span> <span class="keyword">implements</span> <span class="title">Image</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RealImage realImage;</span><br><span class="line">    <span class="keyword">private</span> String fileName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProxyImage</span><span class="params">(String fileName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fileName = fileName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(realImage == <span class="keyword">null</span>)&#123;</span><br><span class="line">            realImage = <span class="keyword">new</span> RealImage(fileName);</span><br><span class="line">        &#125;</span><br><span class="line">        realImage.display();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™æ€ä»£ç†çš„ç¼ºç‚¹æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œç”±äºä»£ç†ç±»å’Œå§”æ‰˜ç±»å®ç°ç›¸åŒçš„æ¥å£ï¼Œå¯¼è‡´ä»£ç å†—æ‚ã€‚æ¥å£çš„å˜åŒ–å°†å¼•èµ·æ‰€æœ‰å®ç°ç±»å’Œä»£ç†ç±»çš„å˜åŒ–ï¼ŒåŒæ—¶å½“ä»£ç†ç±»éœ€è¦ä¸ºå¤šå¯¹è±¡æœåŠ¡æ—¶ä¹Ÿä¼šæ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œä¸ºæ­¤å¼•å…¥åŠ¨æ€ä»£ç†çš„æ–¹å¼ã€‚<br><br>Javaä¸­çš„åŠ¨æ€ä»£ç†ç±»å¿…é¡»å®ç° reflect åŒ…ä¸­çš„ InvocationHandler æ¥å£ï¼ŒåŒæ—¶ä½¿ç”¨ Proxy ç±»ã€‚å½“é€šè¿‡åŠ¨æ€ä»£ç†å¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ—¶å€™ï¼Œè¯¥æ–¹æ³•çš„è°ƒç”¨å°±ä¼šè¢«è½¬å‘åˆ°å®ç° InvocationHandler æ¥å£ç±»çš„ invoke æ–¹æ³•ã€‚è¿˜æ˜¯ä»¥é™æ€ä»£ç†ä¸­ Image ä¸¾ä¾‹ï¼Œè¿™æ¬¡ä¸å†åˆ›å»ºä¸€ä¸ª ProxyImageï¼Œ è€Œæ˜¯é€šè¿‡ä¸€ä¸ª DisplayHandler å®ç°åŠ¨æ€ä»£ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DisplayHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¦ä»£ç†çš„çœŸå®å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> Object obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DisplayHandler</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obj = obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> proxy ä»£ç†ç±»ä»£ç†çš„çœŸå®ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> method æ‰€è¦è°ƒç”¨æŸä¸ªå¯¹è±¡çœŸå®çš„æ–¹æ³•çš„Methodå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args æŒ‡ä»£ä»£ç†å¯¹è±¡æ–¹æ³•ä¼ é€’çš„å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">//çœŸå®çš„å¯¹è±¡æ‰§è¡Œä¹‹å‰</span></span><br><span class="line">        System.out.println(<span class="string">"Before invoke..."</span>);</span><br><span class="line"></span><br><span class="line">        Object invoke = method.invoke(obj, args);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//çœŸå®çš„å¯¹è±¡æ‰§è¡Œä¹‹å</span></span><br><span class="line">        System.out.println(<span class="string">"After invoke..."</span>);</span><br><span class="line">        <span class="keyword">return</span> invoke;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Image image = <span class="keyword">new</span> RealImage(<span class="string">"hello.jpg"</span>);</span><br><span class="line">    InvocationHandler handler = <span class="keyword">new</span> DisplayHandler(image);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * å‚æ•°ä¸€ï¼šhandler.getClass().getClassLoader()ï¼Œä½¿ç”¨handlerå¯¹è±¡çš„classloaderå¯¹è±¡æ¥åŠ è½½æˆ‘ä»¬çš„ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * å‚æ•°äºŒï¼šimage.getClass().getInterfaces()ï¼Œæä¾›çœŸå®å¯¹è±¡å®ç°çš„æ¥å£ï¼Œä½¿ä»£ç†å¯¹è±¡èƒ½è°ƒç”¨æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * å‚æ•°ä¸‰ï¼šhandlerï¼Œå°†ä»£ç†å¯¹è±¡å…³è”åˆ°ä¸Šé¢çš„InvocationHandlerå¯¹è±¡ä¸Š</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Image proxy = (Image) Proxy.newProxyInstance(</span><br><span class="line">            handler.getClass().getClassLoader(),</span><br><span class="line">            image.getClass().getInterfaces(),</span><br><span class="line">            handler);</span><br><span class="line">    proxy.display();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å°è¾“å‡ºç»“æœä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Loading hello.jpg</span><br><span class="line">Before invoke...</span><br><span class="line">Displaying hello.jpg</span><br><span class="line">After invoke...</span><br></pre></td></tr></table></figure></p><p>ä»£ç†æ¨¡å¼å’Œè£…é¥°æ¨¡å¼éå¸¸ç±»ä¼¼ï¼ŒäºŒè€…æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼šä»£ç†æ¨¡å¼ä¸­ï¼Œä»£ç†ç±»å¯¹è¢«ä»£ç†çš„å¯¹è±¡æœ‰æ§åˆ¶æƒï¼Œå†³å®šå…¶æ‰§è¡Œæˆ–è€…ä¸æ‰§è¡Œã€‚è€Œè£…é¥°æ¨¡å¼ä¸­ï¼Œè£…é¥°ç±»å¯¹ä»£ç†å¯¹è±¡æ²¡æœ‰æ§åˆ¶æƒï¼Œåªèƒ½ä¸ºå…¶å¢åŠ ä¸€å±‚è£…é¥°ï¼Œä»¥åŠ å¼ºè¢«è£…é¥°å¯¹è±¡çš„åŠŸèƒ½ï¼Œä»…æ­¤è€Œå·²ã€‚</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="è¿‡æ»¤å™¨æ¨¡å¼"><a href="#è¿‡æ»¤å™¨æ¨¡å¼" class="headerlink" title="è¿‡æ»¤å™¨æ¨¡å¼"></a>è¿‡æ»¤å™¨æ¨¡å¼</h3><p>ç®€å•çš„è¯´ï¼Œç­›é€‰å™¨æä¾›ä¸€ä¸ªè¾“å…¥å‚æ•°ä¸ºç‰¹å®šç±»å‹é›†åˆçš„ç­›é€‰æ–¹æ³•ï¼Œè¿”å›ç­›é€‰ä¹‹åçš„é›†åˆï¼ŒåŒæ—¶ç­›é€‰å™¨ä¹‹é—´å¯ä»¥ç»„åˆã€‚</p><h3 id="æ¡¥æ¥æ¨¡å¼"><a href="#æ¡¥æ¥æ¨¡å¼" class="headerlink" title="æ¡¥æ¥æ¨¡å¼"></a>æ¡¥æ¥æ¨¡å¼</h3><p>æ¡¥æ¥æ¨¡å¼å³å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»å¼€æ¥ï¼Œä½¿ä»–ä»¬éƒ½å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ç”»ç”»è¿™ä¸€è¡Œä¸ºä¸­ï¼Œç”»ç¬”éœ€è¦é€‰æ‹©ä¸åŒçš„é¢œè‰²ã€ç»˜ç”»å½¢çŠ¶ç­‰ï¼Œä¸ºäº†æ–¹ä¾¿æ‹“å±•ï¼Œä½¿ç”¨æ¡¥æ¥æ¨¡å¼ï¼ŒæŠ½è±¡å‡ºå½¢çŠ¶å’Œé¢œè‰²ä¸¤ä¸ªçˆ¶ç±»ï¼Œç„¶åæ ¹æ®éœ€è¦å¯¹é¢œè‰²å’Œå½¢çŠ¶è¿›è¡Œç»„åˆã€‚å®é™…ä¸Šè¿™æ˜¯â€œé¢å‘æ¥å£ç¼–ç¨‹â€è®¾è®¡æ€æƒ³æœ€ç›´è§‚çš„ä½“ç°ã€‚</p><h3 id="å¤–è§‚æ¨¡å¼"><a href="#å¤–è§‚æ¨¡å¼" class="headerlink" title="å¤–è§‚æ¨¡å¼"></a>å¤–è§‚æ¨¡å¼</h3><p>å¤–è§‚æ¨¡å¼éšè—ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œå¹¶å‘å®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªå¯ä»¥è®¿é—®ç³»ç»Ÿçš„æ¥å£ã€‚</p><p>ç®€å•çš„æ¥è¯´å°±æ˜¯å¯¹å¤–æä¾›ä¸€ä¸ªç®€å•æ¥å£ï¼Œéšè—å®ç°çš„é€»è¾‘ã€‚æ¯”å¦‚è®¡ç®—æœºçš„ç”µæºé”®ï¼Œç”¨æˆ·åªéœ€æŒ‰ç”µæºé”®ï¼Œå°±å¯ä»¥å¯åŠ¨æˆ–è€…å…³é—­è®¡ç®—æœºï¼Œæ— éœ€çŸ¥é“å®ƒæ˜¯æ€ä¹ˆå¯åŠ¨çš„(å¯åŠ¨CPUã€å¯åŠ¨å†…å­˜ã€å¯åŠ¨ç¡¬ç›˜)ï¼Œæ€ä¹ˆå…³é—­çš„(å…³é—­ç¡¬ç›˜ã€å…³é—­å†…å­˜ã€å…³é—­CPU)ã€‚</p><h3 id="äº«å…ƒæ¨¡å¼"><a href="#äº«å…ƒæ¨¡å¼" class="headerlink" title="äº«å…ƒæ¨¡å¼"></a>äº«å…ƒæ¨¡å¼</h3><p>æ‰€è°“äº«å…ƒæ¨¡å¼å°±æ˜¯è¿è¡Œå…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨ã€‚ç³»ç»Ÿä½¿ç”¨å°‘é‡å¯¹è±¡,è€Œä¸”è¿™äº›éƒ½æ¯”è¾ƒç›¸ä¼¼ï¼ŒçŠ¶æ€å˜åŒ–å°ï¼Œå¯ä»¥å®ç°å¯¹è±¡çš„å¤šæ¬¡å¤ç”¨ã€‚é€šè¿‡å…¶ä¸­çš„äº«å…ƒå·¥å‚æ¥å±•ç¤ºè¯¥æ¨¡å¼çš„ç‰¹ç‚¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyweightFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Map&lt;String, Shape&gt; shapes = <span class="keyword">new</span> HashMap&lt;String, Shape&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Shape <span class="title">getShape</span><span class="params">(String key)</span></span>&#123;</span><br><span class="line">        Shape shape = shapes.get(key);</span><br><span class="line">        <span class="keyword">if</span>(shape == <span class="keyword">null</span>)&#123;</span><br><span class="line">            shape = <span class="keyword">new</span> Circle(key);</span><br><span class="line">            shapes.put(key, shape);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> shape;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getSum</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> shapes.size();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>ä»ä»£ç ä¸Šçœ‹ï¼Œç»“æ„å‹æ¨¡å¼ä¸­çš„å¾ˆå¤šæ¨¡å¼å…·æœ‰ç›¸å½“å¤§çš„ç›¸ä¼¼æ€§ï¼Œå…·ä½“åŒºåˆ†çš„è¯ï¼Œè£…é¥°å™¨æ¨¡å¼æ˜¯â€œæ–°å¢è¡Œä¸ºâ€ï¼Œä»£ç†æ¨¡å¼æ˜¯â€œæ§åˆ¶è®¿é—®è¡Œä¸ºâ€ï¼Œé€‚é…å™¨æ¨¡å¼æ˜¯â€è½¬æ¢è¡Œä¸ºâ€ï¼Œå¤–è§‚æ¨¡å¼æ˜¯ä¸€ç§â€ç®€åŒ–è¡Œä¸ºâ€ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;é€‚é…å™¨æ¨¡å¼&quot;&gt;&lt;a href=&quot;#é€‚é…å™¨æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;é€‚é…å™¨æ¨¡å¼&quot;&gt;&lt;/a&gt;é€‚é…å™¨æ¨¡å¼&lt;/h2&gt;&lt;p&gt;åœ¨ Android å¼€å‘ä¸­ï¼Œç»å¸¸èƒ½è§åˆ°å„ç§å„æ ·çš„ Adapter ç±»ï¼Œå…¶é‡‡ç”¨çš„æ­£æ˜¯é€‚é…å™¨æ¨¡å¼ã€‚è¯¥è®¾è®¡æ¨¡å¼ä½œä¸ºä¸¤ä¸ªä¸å…¼å®¹çš„æ¥å£ä¹‹é—´çš„æ¡¥æ¢ï¼Œå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä»è€Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Java" scheme="http://yoursite.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>å·´æ´›å…‹çš„çç ï¼šå·´èµ«ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹</title>
    <link href="http://yoursite.com/%E5%B7%B4%E6%B4%9B%E5%85%8B%E7%9A%84%E7%8F%8D%E7%8F%A0%EF%BC%9A%E5%B7%B4%E8%B5%AB%E3%80%8A%E5%85%AD%E9%A6%96%E6%97%A0%E4%BC%B4%E5%A5%8F%E5%A4%A7%E6%8F%90%E7%90%B4%E7%BB%84%E6%9B%B2%E3%80%8B/"/>
    <id>http://yoursite.com/å·´æ´›å…‹çš„çç ï¼šå·´èµ«ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹/</id>
    <published>2019-01-13T15:09:12.000Z</published>
    <updated>2019-03-15T15:26:20.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p> ç¬¬ä¸€æ¬¡æ¥è§¦â€œå·´æ´›å…‹â€ä¸€è¯ï¼Œæ˜¯åœ¨CCTVéŸ³ä¹å…çš„â€œæ¼«æ­¥ç»å…¸â€ç³»åˆ—ï¼Œä¹Ÿè®¸æ˜¯åˆä¸­çš„ä¸€ä¸ªåˆåï¼Œç”µè§†æœºé‡Œä¼ æ¥ç»´ç“¦å°”ç¬¬ã€Šå››å­£ã€‹ç»„æ›²æ‚ æ‰¬æ¬¢å¿«çš„ä¹å£°ï¼Œæ—‹å¾‹é£˜è¿‡æ—¶å…‰ï¼Œé“­åˆ»åœ¨å¿ƒä¸­ã€‚<a id="more"></a></p><p> â€œæ¼«æ­¥ç»å…¸â€ç³»åˆ—å…³äºå·´æ´›å…‹éŸ³ä¹çš„ä»‹ç»å…±åˆ†å…­æœŸèŠ‚ç›®ï¼Œè™½è¯´ç‰¹åˆ«åœ¨æ„ï¼Œå®é™…ä¸Šä¹Ÿæ²¡æœ‰å®Œæ•´åœ°çœ‹å®Œã€‚ä¸çŸ¥é“ä½•æ—¶èµ·ï¼Œå°±æœ‰äº†ç³»ç»Ÿåœ°äº†è§£è¥¿æ–¹å¤å…¸éŸ³ä¹çš„æƒ³æ³•ï¼Œè¿˜ä¸“é—¨å»çŸ¥ä¹æµè§ˆè¯¸å¦‚â€œå¤å…¸éŸ³ä¹â€æ€ä¹ˆå…¥é—¨ä¹‹ç±»çš„é—®ç­”ï¼Œå¯æƒœæ¯æ¬¡éƒ½æ˜¯è¿ˆå‡ºç¬¬ä¸€æ­¥ï¼Œä¾¿å†æ— ä¸‹æ–‡ã€‚ä¸è¿‡å€’ä¹Ÿä¸åœ¨æ„ï¼Œæ¯•ç«Ÿè¦â€œç³»ç»Ÿåœ°â€å¬å®Œå¤å…¸éŸ³ä¹å²ï¼Œå¯¹ä¸€ä¸ªé—¨å¤–æ±‰æ¥è¯´ï¼Œä¹Ÿç€å®å¯Œæœ‰æŒ‘æˆ˜æ€§ã€‚</p><p> ç”Ÿæ´»ä¸­ä¸“é—¨æ¬£èµå¤å…¸éŸ³ä¹çš„æœºä¼šä¸ç®—å¤šã€‚å¿ƒæƒ…çƒ¦èºã€ç™¾æ— èŠèµ–ä¹‹é™…ï¼Œä¼šéšæ€§åœ°æ‰“å¼€å…³äºå¤å…¸éŸ³ä¹çš„æ­Œå•ï¼Œæˆ´ä¸Šè€³æœºï¼Œæ„Ÿå—å·´èµ«ä»¬é“¶ç å€¾æ–œèˆ¬é¥±æ»¡çš„æƒ…æ„Ÿã€‚è¿‘æ¥å‘ç°ä¸€æœ¬ä¹¦ï¼šã€Šç©¿Tæ¤å¬å¤å…¸éŸ³ä¹ã€‹ï¼Œä½œè€…ç”¨éŸ³ä¹å®¶çš„æ•…äº‹ä¸²è”èµ·è¥¿æ–¹å¤å…¸éŸ³ä¹å²ï¼Œä¸ºæ¬£èµå¤å…¸éŸ³ä¹æä¾›äº†ä¸ä¸€æ ·çš„æ–¹å¼ã€‚</p><p> æœ¬æ–‡æ‘˜å½•äº†ä¹¦ä¸­å…³äºå·´èµ«ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹çš„ç« èŠ‚ï¼Œè®°å½•å…³äºè¿™ä¸€ä¼Ÿå¤§ä¹ç« èƒŒåçš„æ•…äº‹ã€‚ç»„æ›²çš„ç½‘æ˜“äº‘é“¾æ¥ä¸ºï¼š<a href="https://music.163.com/#/playlist?id=596314970" target="_blank" rel="noopener">å·´èµ«ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹æ–¯å¡”å…‹</a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p> 1889å¹´ï¼Œ13å²çš„å¡è¨å°”æ–¯ï¼ˆPablo Casalsï¼‰åˆšå¼€å§‹å­¦å¤§æç´ä¸ä¹…ï¼Œæœ‰ä¸€å¤©ï¼Œä»–å’Œçˆ¶äº²åœ¨è¡—å¤´é—²é€›ï¼Œèµ°åˆ°ä¸€é—´æ˜æš—çš„å¤è‘£åº—é‡Œï¼Œæµè§ˆåº—é‡Œç¨€å¥‡å¤æ€ªçš„æ”¶è—ã€‚å¡è¨å°”æ–¯åœ¨è§’è½é‡Œå‘ç°äº†ä¸€æœ¬ç ´ç ´çš„ä¹è°±ï¼Œå¤§å¼€æœ¬ï¼Œçº¸è´¨åšå®ï¼Œç¿»å¼€æ¥åƒä¸€æœ¬å·¨å¤§çš„ç¥ˆç¥·ä¹¦ã€‚çˆ¶äº²èµ°è¿‡æ¥ï¼Œä»–çœ‹åˆ°ä¸Šé¢æœ‰å·´èµ«ä¸å¤§æç´çš„å­—æ ·ï¼Œæ²¡é”™ï¼Œè¿™å°±æ˜¯é—å¤±å·²ä¹…çš„å·´èµ«ä½œå“ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹ã€‚</p><p>å¦‚ä»Šï¼Œå·´èµ«çš„ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹æ˜¯å¤§æç´å®¶çš„æ—§çº¦åœ£ç»ï¼Œè€Œåœ¨å¡è¨å°”æ–¯å‘ç°å®ƒä¹‹å‰ï¼Œå‡ ä¹æ— äººæ¼”å¥è¿‡ï¼Œäººä»¬åªå¬è¿‡é›¶æ˜Ÿç‰‡æ®µï¼Œå±…ç„¶è¿˜æœ‰äººç…æœ‰ä»‹äº‹ç»™å®ƒé…ä¸Šè¹©è„šçš„é’¢ç´ä¼´å¥ã€‚<br>é‚£å¤©ï¼Œå¡è¨å°”æ–¯åƒå—åˆ°ç¥å¯ä¸€èˆ¬ï¼Œç´§ç´§æŠ±ç€ä¹è°±é£å¥”å›å®¶ï¼Œè¿«ä¸åŠå¾…åœ°å¼€å§‹ç»ƒä¹ ã€‚ä»–è¯´ï¼šâ€œè¿™æ¬¡å‘ç°æ˜¯å¯¹æˆ‘ç”Ÿå‘½çš„å¥‡å¦™å¯ç¤ºã€‚â€å¯¹äºä¸€ä½åˆå­¦å¤§æç´çš„å°‘å¹´ï¼Œå‘ç°è¿™æ ·ä¸€ä¸ªå·¨å¤§çš„å®è—ï¼Œå·²ç»æ„å‘³ç€ä¸€ç§å‘½è¿ï¼Œä»–è¦æŠŠæ­¤ç”Ÿå¥‰çŒ®ç»™å¤§æç´ã€‚</p><p>å›é¡¾20ä¸–çºªï¼Œæ²¡æœ‰å“ªä½å¤§æç´å®¶èµ¢å¾—äº†åƒå¡è¨å°”æ–¯é‚£æ ·çš„æˆå°±ä¸å½±å“åŠ›ï¼šä»–æ—…è¡Œæ¼”å‡ºçš„è¶³è¿¹éå¸ƒä¸–ç•Œå„åœ°ï¼›ä»–å®Œå–„äº†å¤§æç´æ¼”å¥æŠ€å·§ï¼Œæå‡äº†å¤§æç´ä½œä¸ºç‹¬å¥ä¹å™¨çš„åœ°ä½ï¼›ä»–åå¯¹è¥¿ç­ç‰™å†…æˆ˜è€Œæµäº¡å·´é»ï¼Œå› æ­¤è·è¯ºè´å°”å’Œå¹³å¥–æåã€‚åœ¨ä»–çš„ç¥–å›½è¥¿ç­ç‰™ï¼Œè¿˜æœ‰ä¸€æ¡åå«å¡è¨å°”æ–¯çš„å…¬è·¯â€¦â€¦ä»–æ˜¯ä¸€ä½ä¼ å¥‡çš„å¤§æç´å®¶ï¼Œä»–è¯´ä»–ä¸ä»…æ˜¯å¤§æç´å®¶ï¼Œä»–é¦–å…ˆæ˜¯ä¸€ä½éŸ³ä¹å®¶ã€‚20å²çš„æ—¶å€™ï¼Œå¡è¨å°”æ–¯å»å·´é»çš„å¤§å¸ˆé‚£é‡Œå­¦ç´ï¼Œæ‹‰å®Œä¸€æ›²ï¼Œå¤§å¸ˆèµ·èº«æ‹¥æŠ±ä»–è¯´ï¼Œä½ æ³¨å®šæ˜¯ä¸åŒå‡¡å“çš„éŸ³ä¹å®¶ã€‚</p><p>æ¢å¯»è¿™éƒ¨ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹çš„æ•…äº‹ï¼Œå°±æ˜¯å›é¡¾20ä¸–çºªå¤§æç´æ¼”å¥è‰ºæœ¯å²ã€‚å¡è¨å°”æ–¯æŠŠä¸€ç”Ÿç”¨æ¥æ¼”å¥å’Œæ¨å¹¿è¿™éƒ¨ä¹æ›²ï¼Œå¦‚ä»Šä»–çš„åå­—å·²ç»ä¸è¿™éƒ¨æ›²é›†æ°¸è¿œç›¸è¿ï¼Œæ˜¯ä»–çš„æ¯•ç”ŸåŠªåŠ›è®©å®ƒæˆä¸ºå¤§æç´çš„æ ¸å¿ƒæ›²ç›®ã€‚å¦‚ä»Šæ‰€æœ‰å¤§æç´å®¶éƒ½åœ¨ç»ƒä¹ å®ƒï¼ŒæŒ‘æˆ˜å®ƒã€‚å®ƒæ˜¯åœ£ç»ï¼Œäº¦æ˜¯å½’å®¿ã€‚ç«¥å¹´æ—¶ä»£çš„é©¬å‹å‹æŠŠè¿™å¥—å¤§æç´ç»„æ›²å½“ä½œç»ƒä¹ æ›²ï¼Œçˆ¶äº²è¦æ±‚ä»–æ¯å¤©å­¦ä¹ ä¸¤å°èŠ‚ï¼Œäº”å²çš„ä»–ç«Ÿèƒ½å¤Ÿä»å¤´è‡³å°¾æ‹‰å¥ï¼Œå¹¶ä¸”ä»¥å®ƒå¼€äº†ç‹¬å¥ä¼šã€‚ä»–ä¸å¡è¨å°”æ–¯ä¸€æ ·ï¼Œè‰ºæœ¯äººç”Ÿä»å·´èµ«å¼€å§‹ã€‚</p><p>å¦‚ä»Šå·²ç»æ— äººçŸ¥é“å·´èµ«åˆ›ä½œã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹çš„ç¡®åˆ‡å¹´ä»½ï¼Œå­¦è€…ä»¬ä»é£æ ¼ã€ä½“è£ç­‰å› ç´ è€ƒé‡ï¼Œè®¤ä¸ºå®ƒä½œäºå·´èµ«åœ¨ç§‘æ»•æ‹…ä»»å®«å»·ä¹é•¿çš„æ—¶æœŸã€‚å·´èµ«çš„å¤§éƒ¨åˆ†å®¤å†…ä¹éƒ½æ˜¯åœ¨é‚£æ—¶å®Œæˆçš„ï¼Œä¸€åŠæ˜¯å› ä¸ºç§‘æ»•çš„é¢†ä¸»å–œæ¬¢ç©å®¤å†…ä¹ã€‚è¿™éƒ¨ç»„æ›²ä¸€å…±æœ‰6å¥—36é¦–æ›²ç›®ï¼ŒåŒ…å«6ç§èˆæ›²ï¼šåºå¥ã€é˜¿åˆ—æ›¼å¾·èˆæ›²ã€åº“æœ—ç‰¹èˆæ›²ã€è¨æ‹‰ç­å¾·èˆæ›²ã€å‰æ ¼èˆæ›²ã€å°æ­¥èˆæ›²ã€‚ç»“æ„ä¸å½“æ—¶å†™çš„ã€Šæ³•å›½ç»„æ›²ã€‹å’Œã€Šè‹±å›½ç»„æ›²ã€‹ç±»ä¼¼ï¼ŒæŒ‰ç…§å·´æ´›å…‹ç»„æ›²æ–¹å¼æ’åˆ—ã€‚å‰ä¸‰å¥—ç»„æ›²å¤§çº¦å†™äº1702å¹´ï¼Œä¹Ÿå°±æ˜¯ã€Šæ— ä¼´å¥å°æç´å¥é¸£æ›²ã€‹æ—¶æœŸï¼Œåä¸‰å¥—æŠ€å·§è‰°æ·±è¡¨è¾¾æ™¦æ¶©ï¼Œåº”è¯¥å†™äºæ›´æ™šä¸€äº›å¹´ä»½ã€‚ç§‘æ»•é¢†ä¸»æ˜¯ä¸€ä½èµ„æ·±ä¹è¿·ï¼Œä¹Ÿç§°å¾—ä¸Šæ˜¯ä¸€ä½ä¸šä½™éŸ³ä¹å®¶ï¼Œä»–æŒ‘é€‰çš„ä¹æ‰‹éƒ½æ˜¯ä¸€æµçš„ï¼Œå·´èµ«åœ¨é‚£é‡Œå·¥ä½œå¾—éå¸¸æ„‰å¿«ã€‚æ®è¯´å…­é¦–å¤§æç´ç»„æ›²æ˜¯ä¸ºå®«å»·é‡Œçš„ä¸¤ä½å¤å¤§æç´å®¶æå°¼å¸Œå…‹ï¼ˆChristian Linikeï¼‰å’Œé˜¿è´å°”ï¼ˆChristian Ferdinand Abelï¼‰è€Œä½œï¼Œä»–ä»¬å±…ç„¶åœ¨300å¹´å‰å°±èƒ½èƒœä»»å…¶ä¸­çš„å¤æ‚æŠ€å·§ã€‚</p><p>åº”è¯¥å¦‚ä½•æ¼”å¥è¿™éƒ¨ä¹æ›²ï¼Ÿä¹è°±ä¸Šé™¤äº†éŸ³ç¬¦ï¼Œæ²¡æœ‰ä»»ä½•æç¤ºï¼Œæ²¡æœ‰é€Ÿåº¦ï¼Œæ²¡æœ‰å¼ºå¼±è®°å·ï¼Œæ²¡æœ‰åˆ†å¥ï¼Œä¹Ÿæ²¡æœ‰è¡¨æƒ…è®°å·ã€‚å·´èµ«ç»™äº†è‡ªç”±ï¼Œä¹Ÿç»™äº†æŒ‘æˆ˜ã€‚é’å°‘å¹´æ—¶ä»£çš„å¡è¨å°”æ–¯èŠ±12å¹´ç£¨ç‚¼è¿™éƒ¨ä¹æ›²ï¼Œä»–åœ¨ç»ƒä»€ä¹ˆå‘¢ï¼Ÿé¦–å…ˆï¼Œä»–ç»ƒä¹ æ‹‰ç´çš„æŠ€å·§ï¼Œå¯¹ä»–æ¥è¯´æŠ€å·§å·²ç»è·¨è¶Šäº†å…¶æœ¬èº«ï¼Œæˆä¸ºä¸€ç§æ— ç—•çš„è¡¨è¾¾ã€‚å…¶æ¬¡æ˜¯åˆ†å¥ï¼Œå°†å»¶ç»µæ— å°½çš„å·´æ´›å…‹æ›²çº¿æ¡åˆ†ç¼•æï¼Œå±‚å±‚æ¨è¿›ï¼Œé’»ç ”å£°éŸ³çš„é€è§†æ³•ã€‚å·´èµ«æ˜¯å·´æ´›å…‹æ—¶ä»£æœ€åçš„å¯¹ä½æ³•å¤§å¸ˆï¼Œå³ä½¿ç‹¬å¥å£°éƒ¨ä¹Ÿè¢«ä»–åµŒå…¥ä¸¤ä¸‰æ¡éšå½¢æ—‹å¾‹ï¼Œåœ¨ä¹å¥ä¸­è‹¥éšè‹¥ç°ã€‚éŸ³ä¹ä¸€å¥å¥å±•å¼€ï¼Œä¸€å±‚å±‚æ·±å…¥ï¼Œä¸€åº§ç»“æ„ç²¾å·§çš„å·´æ´›å…‹å»ºç­‘è·ƒç„¶çœ¼å‰ï¼Œå‘ˆç°ç¼œå¯†ç«‹ä½“çš„ä¸‰ç»´ç»“æ„ï¼Œæ¯ä¸ªç»†èŠ‚éƒ½æµç•…è€Œä¸°ç›ˆã€‚</p><p>12å¹´ä¹‹åï¼Œ25å²çš„å¡è¨å°”æ–¯å°†å®ƒä»¬å½•åˆ¶æˆäº†å”±ç‰‡ã€‚å¦‚ä»Šå¬æ¥ï¼Œé‚£ä¸€ç‰ˆå½•éŸ³ä¹Ÿæ˜¯ç»å…¸æ¼”ç»ï¼Œä»¤äººèµå¹ï¼Œå£°éƒ¨æ„Ÿé”™è½æœ‰è‡´ï¼Œçº¿æ¡æµç•…æ‚ ç„¶ã€‚éŸ³ä¹æ˜¯æ— å½¢çš„ï¼ŒæŠ€æœ¯ä¹Ÿåº”è¯¥æ˜¯æ— å½¢çš„ï¼Œå¤æ‚çš„æŠ€å·§åœ¨ä»–æ‰‹ä¸­å·²ç»å’ŒéŸ³ä¹ä¸€æ ·æ— å½¢æ— ç—•ï¼ŒæµåŠ¨ä¸æ¯ã€‚è¿™æ ·çš„æ¼”å¥é‡Œé¢æœ‰ä¸€ç§ä¸œæ–¹æ„å¢ƒï¼Œåæ¥é©¬å‹å‹å’Œæ—æ€€æ°‘ç»§ç»­åœ¨è¿™éƒ¨ä¹æ›²ä¸­æ¢ç´¢ä¸œæ–¹éŸµå‘³ä¸ä¸­è¥¿æ–¹çš„ç²¾ç¥è”æ¥ã€‚</p><p>é©¬å‹å‹ä¸å‚ä¸œç‰ä¸‰éƒæ›¾ç»åˆä½œäº†ä¸€éƒ¨çºªå½•ç‰‡ï¼Œå«ä½œã€Šå·´èµ«çµæ„Ÿã€‹ä¹‹â€œå·´èµ«æ— ä¼´å¥å¤§æç´ç»„æ›²ä¹‹äº”ï¼Œè¿½å¯»å¸Œæœ›â€ã€‚å‚ä¸œç‰ä¸‰éƒæ˜¯æ—¥æœ¬å›½å®çº§æ­Œèˆä¼æ¼”å‘˜ï¼Œåœ¨ç‰‡ä¸­ï¼Œé©¬å‹å‹å’Œä»–ä¸€èµ·æ’ç»ƒäº¤æµï¼Œä¸€ä½è¯´è‹±è¯­ï¼Œä¸€ä½è¯´æ—¥è¯­ï¼Œä¸€ä½æ‹‰å¥ï¼Œä¸€ä½èµ·èˆã€‚ä»–ä»¬åœ¨å¤§æç´æ›²ä¸­äº¤è°ˆï¼ŒèƒŒåæ˜¯æ’ç»ƒåœºçš„å·¨å¤§ç»ç’ƒçª—ï¼ŒæŠŠçª—å¤–å¤§ç‰‡æ—¥æœ¬çš„ç»¿æ™¯æ”¶æ½è¿›ç”»é¢ã€‚å‚ä¸œå¬ç€é©¬å‹å‹çš„ç´å£°ï¼Œç‹¬è¯­ã€ä½é¦–ã€å›æ—‹ã€æ²‰æ€ï¼Œçª—å¤–æ˜¯æ·…æ·…æ²¥æ²¥çš„é›¨å£°ï¼Œä»–ä»¥èˆè¹ˆæ¼”ç»èŠ‚å¥ã€æ—‹å¾‹çš„èµ·ä¼ã€éŸ³ä¹çš„èµ°å¥ã€‚ä»–ä»¬æŠŠå·´èµ«çš„ç¬¬äº”ç»„æ›²è¯ é‡Šä¸ºâ€œä»ªå¼â€ã€â€œå“€å¹â€ã€â€œå¦å®šâ€ã€â€œç¥ˆâ€ã€â€œæ¢¦â€å’Œâ€œè°ƒå’Œâ€ï¼Œå¦‚æ­¤æç‚¼å·´èµ«éŸ³ä¹ä¸­çš„æˆå‰§åŠ›é‡ã€‚é©¬å‹å‹åœ¨ç™½çº¸ä¸Šç”¨æ¯›ç¬”å†™ä¸‹â€œä»ªå¼â€ã€‚æ˜¯çš„ï¼Œä»ªå¼ï¼Œå·´èµ«ä¸æ—¥æœ¬è‰ºæœ¯ï¼Œä¸¤è€…ç›¸é€šä¹‹å¤„å°±æ˜¯å…¶ä¸­çš„ä»ªå¼æ„Ÿã€‚æ—¥æœ¬ä¸å·´èµ«æ—¶ä»£éƒ½è®²ç©¶ä»ªå¼æ„Ÿï¼Œä»ªå¼æ˜¯ä¸ºäº†å°Šé‡ï¼Œä¹Ÿæ˜¯ä¸€ç§ç¾å­¦ã€‚ä»–ä»¬çš„è¿™äº›è¯ é‡Šçªç ´äº†ä¸œè¥¿æ–¹æ–‡åŒ–çš„ç•Œé™ï¼Œæ˜¯æ¶ˆé™¤æ°‘æ—æ€§æš—ç¤ºçš„ç¢ç‰‡ï¼Œä¹Ÿæ˜¯è¡”æ¥è¿™åœºä¸œè¥¿åˆä½œçš„æ¡¥æ¢ã€‚è¿™åœºè¡¨æ¼”æœ€ç»ˆè®©æˆ‘ä»¬å‘ç°ï¼Œå·´èµ«çš„éŸ³ä¹æ— å…³ä¸œè¥¿æ–¹è¯­å¢ƒï¼Œå®ƒæ˜¯æ¯ä¸€ä¸ªé¥±æ»¡å¿ƒçµçš„æ­Œå’ï¼ŒéŸ³ä¹æ­£æ˜¯åœ¨çªç ´è¿™ç§ä¸œè¥¿æ–¹å±€é™ä¹‹åæ‰æœ‰å¯èƒ½é è¿‘æ°¸æ’ã€‚</p><p>åœ¨æ—æ€€æ°‘çš„ç°ä»£èˆä½œå“ã€Šæ°´æœˆã€‹é‡Œé¢ï¼Œä¸­å›½çš„å¤ªæå¼èˆå§¿ä¸­ä¼ æ¥äº†å·´èµ«çš„å¤§æç´ç»„æ›²ç¬¬ä¸€é¦–ï¼ŒéŸ³ä¹å……æ»¡å¾‹åŠ¨ï¼Œèˆè¹ˆä¸­å´åŸ‹è—ç€æ·±æ·±çš„å¯‚é™ä¸å­¤ç‹¬ã€‚èˆå°çš„åœ°é¢æ˜¯ä¸€å¤§ç‰‡åå…‰çš„é•œå­ï¼Œèˆè€…ä¸ä¹‹å½¢å½±ç›¸å¯¹ã€‚ä»–ä»¬èƒ½å¤Ÿæ— ç—•åœ°èåˆï¼Œæœ¬è´¨ä¸Šæ˜¯å› ä¸ºâ€œç‹¬â€ï¼Œæ²‰éƒçš„ç‹¬å¥ï¼Œä¸€å¤§ç‰‡ç™½å½±é£˜é›¶ï¼Œç´å£°å¦‚ç‹¬èˆï¼Œå½¼æ­¤åœ¨å­¤ç‹¬ä¸­èˆ’å±•ã€æ²‰é†‰ã€å¿˜æ€€ã€‚</p><p>åœ¨éŸ³ä¹å²ä¸Šï¼Œ20ä¸–çºªæ˜¯æ¼”ç»çš„æ—¶ä»£ï¼Œå”±ç‰‡å‘è¡Œå’Œå…¨çƒå·¡æ¼”ä¿ƒæˆäº†æ¼”å¥å¤©æ‰è¾ˆå‡ºã€‚åæ¥ä¹Ÿæœ‰è¶…è¶Šå¡è¨å°”æ–¯çš„æ¼”ç»ï¼Œæ¯”å¦‚åŒˆç‰™åˆ©è£”å¤§æç´å®¶æ–¯å¡”å…‹ã€‚ä»–çš„æ¼”å¥æŠ€æœ¯ä¸¥è°¨ç²¾ç¡®ï¼Œå…­æ›²æ‹‰åˆ°å°¾æ¯«ä¸æ¾æ‡ˆï¼Œæ‰€æœ‰ç»†èŠ‚éƒ½æ£±è§’åˆ†æ˜ï¼Œå±‚æ¬¡é¥±æ»¡ã€‚æ–¯å¡”å…‹çš„éŸ³ä¹é£æ ¼ä¸ä»–çš„å½¢è±¡éƒ½æ˜¯ä¸¥è°¨å†·å†½çš„ï¼Œä¸å¤ªæµéœ²æƒ…æ„Ÿï¼Œä½†ä»–å¯¹è¿™å¥—ä¹æ›²ä¼¼ä¹æ˜¯æ„Ÿæƒ…æœ€æ·±çš„ï¼Œå‰åå½•äº†äº”éï¼Œä»–è‡ªå·±å¦é™ˆï¼šå‰ä¸‰éä¸»è¦é¡¾åŠç»“æ„å’ŒæŠ€å·§ï¼Œåä¸¤éæ‰æœ‰æ„Ÿæƒ…æµéœ²ã€‚å¦‚æ­¤å¦è¯šçš„æ¼”å¥å®¶ä¸å¤šã€‚åƒæ–¯å¡”å…‹è¿™æ ·çš„æŠ€å·§å¤§å¸ˆéƒ½è¦é¡¾åŠæŠ€å·§ï¼Œå¯è§è¯¥ç¥æ›²çš„æŠ€å·§æœ‰å¤šéš¾ã€‚æ–¯å¡”å…‹æŠ‘åˆ¶æƒ…æ„Ÿçš„æ¼”å¥è®©äººä»¬æ›´å…³æ³¨ä¹éŸ³çš„è¿åŠ¨ï¼Œè®©äººæƒ³èµ·éŸ³ä¹ç¾å­¦å®¶æ±‰æ–¯ç«‹å…‹æ›¾è¯´ï¼šâ€œéŸ³ä¹çš„å†…å®¹å°±æ˜¯ä¹éŸ³çš„è¿åŠ¨å½¢å¼ã€‚â€ä½†åœ¨ç†æ€§èƒŒåï¼Œç´éŸ³ä¸­çš„æ²‰éƒæ·±å…¥è‚ºè…‘ï¼Œç‰¹åˆ«æ˜¯ç¬¬å››å¼¦åœ¨éŸ³åˆ—ä¸­ä½é¸£ä¸æ¯ï¼Œè®©æ‚²å“€è‹¥éšè‹¥ç°ï¼Œæ›´æš—ç¤ºäº†å·´èµ«å¯¹ä½æ³•çš„åšå¤§ç²¾æ·±ã€‚åå¤å¬ä»–çš„æ¼”å¥ï¼Œè§‰å¾—ä»–çš„ä¸¥è°¨åˆ†æ˜ä¸­ä¼¼ä¹æœ‰ä¸€ç§æ— ä»è§£é‡Šçš„ç¥ç§˜æ„Ÿï¼Œè¿™æ ·çš„æ¼”å¥æˆ–è®¸æ‰æ˜¯æ·±å…¥å¾·å›½ç²¾é«“çš„ï¼Œæ›´è´´è¿‘ä¸å€¦æ¢å¯»äººç±»ç»ˆæç§˜å¯†çš„æ—¥è€³æ›¼å¿ƒçµã€‚</p><p>æœ€æ„Ÿäººçš„è¿˜æ˜¯å¤§å¸ˆä»¬æ™šå¹´çš„æ¼”å¥ï¼Œæƒ…æ„Ÿé¥±è¶³ï¼Œå›å½’å¤©çœŸã€‚</p><p>ç½—æ–¯æ‰˜ç½—æ³¢ç»´å¥‡ï¼ˆMstislav Leopoldovich Rostropovichï¼‰ï¼Œå½“ä»£ä¿„ç½—æ–¯æœ€è‘—åçš„å¤§æç´å®¶ã€‚1989å¹´ï¼ŒæŸæ—å¢™è¢«æ¨å€’çš„æ—¶å€™ï¼Œç½—æ–¯æ‰˜ç½—æ³¢ç»´å¥‡æ”¾ä¸‹ä¸€åˆ‡å·¥ä½œï¼ŒèƒŒèµ·å¤§æç´èµ¶èµ´æŸæ—ï¼Œä»æœºåœºç›´æ¥æ‰“è½¦åˆ°æŸæ—å¢™æ‹†é™¤çš„ç°åœºï¼Œå€Ÿäº†æŠŠæ¤…å­ï¼Œåä¸‹å°±å¼€å§‹æ‹‰å¥å·´èµ«çš„ã€Šå…­é¦–æ— ä¼´å¥å¤§æç´ç»„æ›²ã€‹ã€‚ä»–è¯´ï¼šâ€œæˆ‘æ— æ³•å¿˜æ€€æ‰€æœ‰æƒ³è¦ç¿»è¶Šè¿™å µå¢™è€Œä¸§ç”Ÿçš„äººä»¬ï¼Œå½“æˆ‘æ‹‰èµ·è¨æ‹‰ç­å¾·ï¼Œäººç¾¤é‡Œæœ‰ä½å¹´è½»äººå“­äº†ã€‚â€è¿™éƒ¨ä¹æ›²ç½—æ–¯æ‰˜ç½—æ³¢ç»´å¥‡æ‹‰è¿‡æ— æ•°éï¼ŒæŠ€å·§æ— æ‡ˆå¯å‡»ï¼Œä»–çš„å¼ºåŠ¿ä¸æ„å¿—è®©å·´èµ«æ·±å…·é˜³åˆšä¹‹ç¾ã€‚å”¯ç‹¬é‚£ä¸€æ¬¡æ¼”å¥è®©ä»–æ¯•ç”Ÿéš¾å¿˜ã€‚é¢å¯¹å½“æ—¶çš„åœºæ™¯äººä»¬èƒ½å¤Ÿè¯´ä»€ä¹ˆï¼Ÿåªæœ‰å·´èµ«çš„éŸ³ä¹èƒ½å¤ŸæŠšæ…°äººå¿ƒï¼Œæ‚²æ¬£äº¤é›†ï¼Œæ¬¢å–œä¸æ‚²ä¼¤ï¼Œæ¬¢åº†ä¸è¿½å¿µã€‚è¿™ä¹Ÿæ˜¯äººä»¬ç†è§£å·´èµ«çš„æ—¶åˆ»ï¼Œä»–ä¼¼ä¹æ‡‚å¾—ç¦…æ„ï¼Œæ— æ‰€è¯‰è¯´åˆæ— æ‰€ä¸è¯´ã€‚æ¯ä¸€ä¸ªéŸ³ç¬¦éƒ½æ˜¯ç¬é—´ï¼Œéƒ½æ˜¯æ°¸æ’ï¼›éƒ½æ˜¯æ‚²å‰§ï¼Œéƒ½æ˜¯æ•‘èµï¼›éƒ½æ˜¯éŸ³ä¹ï¼Œéƒ½æ˜¯çœŸç†ã€‚</p><p>ç½—æ–¯æ‰˜ç½—æ³¢ç»´å¥‡èŠ±äº†åŠç”Ÿç ”è¯»è¿™éƒ¨ä¹æ›²ï¼Œåˆ°äº†æ™šå¹´ï¼Œä»–åœ¨æ³•å›½å—éƒ¨çš„å°é•‡ä¸Šé€‰äº†ä¸€åº§æ‹¥æœ‰900å¹´å†å²çš„æ•™å ‚ï¼Œåœ¨é‚£é‡Œå®Œæ•´å½•åˆ¶äº†è¿™éƒ¨ä¹æ›²ã€‚å¹´è½»æ—¶å·²å¯¹æ¯ä¸€ä¸ªéŸ³ç¬¦äº†ç„¶äºå¿ƒï¼Œå¦‚ä»Šåœ¨è€æ•™å ‚é‡Œï¼Œåœ¨ç ´æ—§æ‹±å»Šå’Œæ¹®æ²¡çš„çº¿æ¡ä¸­æ„ŸçŸ¥å·´æ´›å…‹éŸµå¾‹ï¼Œæ¯ä¸€ä¸ªéŸ³ç¬¦å¤šä¹ˆç†Ÿæ‚‰ï¼Œåˆåƒæ˜¯ç¬¬ä¸€æ¬¡å¬è§ï¼Œæ‹‰å¥ç€æ·±æ²‰çš„ä½éŸ³ï¼Œå´åˆæ˜¯ä¸€èº«è½»æ¾ã€‚ä»–çš„å¼ºåŠ¿ä¸å±‚æ¬¡æ„Ÿï¼Œä»–å¯¹ç»“æ„å…¨å±€çš„æŠŠæ¡ï¼Œä»–çš„ç´§å‡‘æœ‰åŠ›ï¼Œè®©æ¯ä¸ªéŸ³ç¬¦ç»½æ”¾é‡‘è‰²çš„å…‰èŠ’ï¼Œä¹Ÿè®©ä¹æ›²çœŸæ­£éœ‡æ’¼äººå¿ƒã€‚</p><p>ä¿„ç½—æ–¯å¤§æç´å®¶æ²™å¤«å…°ï¼ˆDanil Shafranï¼‰çš„ç‰ˆæœ¬æœ€åŠ¨äººä¹Ÿæœ€æœ‰æƒ³è±¡åŠ›ã€‚ä»–çš„éŸ³ç¬¦æ— æ¯”è¿è´¯é€šé€ï¼Œå»¶ç»µå¦‚åœŸåœ°ï¼Œä¸æ¯å¦‚æ²³æµã€‚å¯¹äºå·´èµ«è¿™æ ·å´å²–çš„å¤šå£°éƒ¨ç»‡ä½“ï¼Œä¸çŸ¥é“ä»–æ˜¯å¦‚ä½•åšåˆ°å¦‚å±¥å¹³åœ°ï¼Œæ­Œå”±å¾—å¦‚æ­¤é…£ç•…çƒ­æƒ…ã€‚è¿™ä¸€ç‰ˆæœ¬ä¹Ÿæ˜¯æˆ‘å¬è¿‡çš„æœ€å¯Œæœ‰æ­Œå”±æ€§çš„æ¼”å¥ï¼Œè¦çŸ¥é“ï¼Œè¿™éƒ¨ä¹æ›²æœ¬èº«æ˜¯ä¸å¤ªèƒ½æ­Œå”±çš„ã€‚å½“ç„¶æ²™å¤«å…°çš„æ¼”å¥ä¹Ÿæœ€ä¸åƒå·´æ´›å…‹é£æ ¼ï¼Œä»–å‘æŒ¥äº†å…¶ä¸­çš„æµªæ¼«æ°”è´¨ã€‚</p><p>æ³•å›½å¤§æç´å­¦æ´¾ä¹Ÿå¯¹è¿™éƒ¨ä¹æ›²ä½œå‡ºè´¡çŒ®ã€‚è©¹å¾·é¾™ï¼ˆMaurice Gendronï¼‰ã€å¯Œå°¼åŸƒï¼ˆPierre Fournierï¼‰ã€æ‰˜ç‰¹é‡Œè€¶ï¼ˆPaul Tortelierï¼‰å’Œçº³ç“¦æ‹‰ï¼ˆAndre Navarraï¼‰è¢«ç§°ä¸ºæ³•å›½å¤§æç´å››éª‘å£«ã€‚ä»–ä»¬çš„æ¼”å¥æ²¡æœ‰å¾·å¥¥éŸ³ä¹å®¶é‚£ç§å¼ºç¡¬ï¼Œè€Œæ˜¯æ¸©æš–æµç•…ã€å…³æ³¨ç»†èŠ‚çš„ï¼Œå¸¦ç€å¦™æ›¼çš„å·´é»æ²™é¾™æ°”æ¯ã€‚å¯Œå°¼åŸƒçš„ç‰ˆæœ¬æœ€æœ‰å¤å…¸æ°”è´¨ï¼Œä»–çœŸæ˜¯ä¸€ä½å¤©ç”Ÿçš„è´µæ—ï¼Œä¹å¥æ— æ¯”ä¼˜é›…ï¼ŒéŸ³è‰²å¦‚å…‰æ»‘çš„ä¸ç»¸ï¼Œå´ååˆ†è‡ªç„¶ï¼Œå¦‚æ¸©æš–å–„æ„Ÿçš„ç‹¬ç™½ï¼›è©¹å¾·é¾™å†·é™è½»ç›ˆä¸€äº›ï¼Œä¸€æ´¾å…¸é›…çš„å¤å…¸é£èŒƒï¼›æ‰˜ç‰¹é‡Œè€¶æœ‰æ¿€æƒ…ï¼Œç”šè‡³ç¼ç—›æ„Ÿï¼Œå¯ä»¥å¬è§éŸ³ä¹ä¸­å‚¬äººå¥‹èµ·çš„åŠ›é‡ã€‚æ¯ä¸ªäººä¸ªæ€§è¿¥å¼‚ï¼Œä»–ä»¬çš„ä¸ªäººé­…åŠ›ä¸°æ»¡äº†å·´èµ«çš„ä½œå“ï¼Œä¸ä¹‹äº’ç›¸æˆå°±ã€‚</p><p>åªæ˜¯æœæ™®é›·çš„ç‰ˆæœ¬ç•¥æœ‰é€Šè‰²ã€‚è¿™ä¹Ÿæ˜¯æ„æ–™ä¹‹ä¸­ï¼Œå·´èµ«ä¸æ˜¯å¥¹çš„èœ</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt; ç¬¬ä¸€æ¬¡æ¥è§¦â€œå·´æ´›å…‹â€ä¸€è¯ï¼Œæ˜¯åœ¨CCTVéŸ³ä¹å…çš„â€œæ¼«æ­¥ç»å…¸â€ç³»åˆ—ï¼Œä¹Ÿè®¸æ˜¯åˆä¸­çš„ä¸€ä¸ªåˆåï¼Œç”µè§†æœºé‡Œä¼ æ¥ç»´ç“¦å°”ç¬¬ã€Šå››å­£ã€‹ç»„æ›²æ‚ æ‰¬æ¬¢å¿«çš„ä¹å£°ï¼Œæ—‹å¾‹é£˜è¿‡æ—¶å…‰ï¼Œé“­åˆ»åœ¨å¿ƒä¸­ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="è‰ºæœ¯" scheme="http://yoursite.com/categories/%E8%89%BA%E6%9C%AF/"/>
    
    
      <category term="éŸ³ä¹" scheme="http://yoursite.com/tags/%E9%9F%B3%E4%B9%90/"/>
    
      <category term="å·´æ´›å…‹" scheme="http://yoursite.com/tags/%E5%B7%B4%E6%B4%9B%E5%85%8B/"/>
    
      <category term="å·´èµ«" scheme="http://yoursite.com/tags/%E5%B7%B4%E8%B5%AB/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¶ŠGFWè®°</title>
    <link href="http://yoursite.com/%E7%BF%BB%E8%B6%8AGFW%E8%AE%B0/"/>
    <id>http://yoursite.com/ç¿»è¶ŠGFWè®°/</id>
    <published>2019-01-12T15:31:31.000Z</published>
    <updated>2019-03-15T15:25:46.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>GFWæ˜¯ä¸­å›½äº’è”ç½‘ä¸Šç‹¬ç‰¹è€Œä¸å¯å¿½è§†çš„å­˜åœ¨ï¼Œå¾ˆå¤šäººåœ¨ç”Ÿæ´»ä¸­éƒ½ä¸»åŠ¨åœ°æ­å»ºç¿»å¢™å·¥å…·æˆ–è€…ä½¿ç”¨ç¿»å¢™æœåŠ¡ï¼Œä»¥æ­¤è®¿é—®â€œä¸å­˜åœ¨çš„ç½‘ç«™â€ã€‚æœ¬æ–‡å°†è®°å½•<code>GFW</code>æ‰€ä¸ºä½•ç‰©ï¼Œä»¥åŠ<code>ç¿»</code>çš„åŸç†ã€‚<a id="more"></a></p><h2 id="GFW"><a href="#GFW" class="headerlink" title="GFW"></a>GFW</h2><h3 id="æ‰€ä¸ºä½•ç‰©"><a href="#æ‰€ä¸ºä½•ç‰©" class="headerlink" title="æ‰€ä¸ºä½•ç‰©"></a>æ‰€ä¸ºä½•ç‰©</h3><p>GFWï¼šGreat Firewall (of the Peopleâ€™s Republic of China)ï¼Œä¸­å›½å›½å®¶é˜²ç«å¢™ï¼Œç”±äºè°éŸ³the Great Wallï¼Œæ‰€ä»¥ä¹Ÿç§°é•¿åŸé˜²ç«å¢™ï¼Œæ˜¯ä¸­å›½æ”¿åºœåœ¨å…¶äº’è”ç½‘è¾¹ç•Œçš„å®¡æŸ¥ç³»ç»Ÿï¼ˆåŒ…æ‹¬ç›¸å…³è¡Œæ”¿å®¡æŸ¥ç³»ç»Ÿï¼‰ï¼Œå…·ä½“æŒ‡ç›‘æ§å’Œè¿‡æ»¤äº’è”ç½‘å†…å®¹çš„è½¯ç¡¬ä»¶ç³»ç»Ÿï¼Œç”±æœåŠ¡å™¨å’Œè·¯ç”±å™¨ç­‰è®¾å¤‡ã€ç›¸å…³çš„åº”ç”¨ç¨‹åºæ„æˆã€‚ </p><p>å½¢è±¡çš„æè¿°ï¼Œåœ¨æ²¡æœ‰ GFW çš„æ—¶ä»£ï¼Œè®¿é—®äº’è”ç½‘çš„æ–¹å¼å¦‚ä¸‹</p><p><img src="/ç¿»è¶ŠGFWè®°/åŸå§‹è¿æ¥æ–¹å¼.png" alt="åŸå§‹è¿æ¥æ–¹å¼"></p><p>GFW å‡ºç°ä¹‹åï¼Œåˆ™å˜æˆ</p><p><img src="/ç¿»è¶ŠGFWè®°/GFWå­˜åœ¨åçš„è¿æ¥æ–¹å¼.png" alt="GFWå­˜åœ¨åçš„è¿æ¥æ–¹å¼"></p><p>å…¶å†…éƒ¨æ„é€ å¦‚ä¸‹</p><p><img src="/ç¿»è¶ŠGFWè®°/GFWå†…éƒ¨ç»“æ„.jpg" alt="ç¿»è¶ŠGFWè®°/GFWå†…éƒ¨ç»“æ„"></p><p>å®ƒå˜æˆäº†æœ¬åœ°æµè§ˆå™¨å’Œç½‘ç«™æœåŠ¡å™¨ä¹‹é—´çš„ä¸€é“å¢™ï¼Œé˜»æ‹¦äº†è®¿é—®ç‰¹å®šç½‘ç«™çš„è¯·æ±‚ï¼Œå®é™…ä¸Šï¼ŒGFW çš„æ‹¦æˆªæ–¹å¼æ˜¯å¤šæ ·çš„ã€‚</p><p>GFWçš„å…·ä½“åŸç†å¯ä»¥æŸ¥çœ‹æ­¤æ–‡ç« ï¼š<a href="https://cokebar.info/archives/253" target="_blank" rel="noopener">å…¨é¢å­¦ä¹ GFW</a></p><h3 id="å¦‚ä½•å·¥ä½œ"><a href="#å¦‚ä½•å·¥ä½œ" class="headerlink" title="å¦‚ä½•å·¥ä½œ"></a>å¦‚ä½•å·¥ä½œ</h3><h4 id="å…³é”®å­—è¿‡æ»¤é˜»æ–­"><a href="#å…³é”®å­—è¿‡æ»¤é˜»æ–­" class="headerlink" title="å…³é”®å­—è¿‡æ»¤é˜»æ–­"></a>å…³é”®å­—è¿‡æ»¤é˜»æ–­</h4><p>å…³é”®å­—è¿‡æ»¤ç³»ç»Ÿèƒ½å¤Ÿä»å‡ºå£ç½‘å…³æ”¶é›†åˆ†æä¿¡æ¯ï¼Œè¿‡æ»¤ã€å—…æ¢æŒ‡å®šçš„å…³é”®å­—ã€‚ä¸»è¦é’ˆå¯¹ HTTP çš„é»˜è®¤ç«¯å£ï¼š80ç«¯å£ï¼Œå› ä¸º HTTP ä¼ æ’­çš„å†…å®¹æ˜¯æ˜æ–‡çš„å†…å®¹ï¼Œæ²¡æœ‰ç»è¿‡åŠ å¯†ï¼Œè€Œ GFW æ˜¯ä¸€ä¸ª IDS(Intrusion detection system)ã€‚æ™®é€šçš„å…³é”®è¯å¦‚æœå‡ºç°åœ¨ HTTP è¯·æ±‚æŠ¥æ–‡çš„å¤´éƒ¨(å¦‚â€œHost: <a href="http://www.youtube.comâ€)æ—¶ï¼Œåˆ™ä¼šé©¬ä¸Šä¼ªè£…æˆå¯¹æ–¹å‘è¿æ¥ä¸¤ç«¯çš„è®¡ç®—æœºå‘é€" target="_blank" rel="noopener">www.youtube.comâ€)æ—¶ï¼Œåˆ™ä¼šé©¬ä¸Šä¼ªè£…æˆå¯¹æ–¹å‘è¿æ¥ä¸¤ç«¯çš„è®¡ç®—æœºå‘é€</a> RST åŒ…(reset)å¹²æ‰°ä¸¤è€…æ­£å¸¸çš„ TCP è¿æ¥ï¼Œè¿›è€Œä½¿è¯·æ±‚çš„å†…å®¹æ— æ³•ç»§ç»­æŸ¥çœ‹ã€‚<br>å¦‚æœGFWåœ¨æ•°æ®æµä¸­å‘ç°äº†ç‰¹æ®Šçš„å†…æ–‡å…³é”®è¯æ—¶ï¼Œå…¶ä¹Ÿä¼šè¯•å›¾æ‰“æ–­å½“å‰çš„è¿æ¥ï¼Œä»è€Œå‡ºç°ç”¨æˆ·çš„ç½‘é¡µå¼€å¯ä¸€éƒ¨åˆ†åï¼Œçªç„¶åœæ­¢çš„æƒ…å†µã€‚</p><h4 id="IPåœ°å€å°é”"><a href="#IPåœ°å€å°é”" class="headerlink" title="IPåœ°å€å°é”"></a>IPåœ°å€å°é”</h4><p>è·¯ç”±å™¨çš„æ­£å¸¸å·¥ä½œæ–¹å¼æ˜¯ï¼šé‡åˆ°ç¬¦åˆå·²çŸ¥çš„IPè½¬å‘è§„åˆ™çš„æ•°æ®åŒ…ï¼Œåˆ™æŒ‰å·²ç»è§„åˆ™å‘é€ï¼Œé‡åˆ°æœªçŸ¥è§„åˆ™IPçš„æ•°æ®ï¼Œåˆ™è½¬å‘åˆ°ä¸Šä¸€çº§ç½‘å…³ã€‚<br><br>GFW é€šè¿‡è·¯ç”±å™¨ï¼Œåœ¨é€šå¾€å›½å¤–çš„æœ€åä¸€ä¸ªç½‘å…³ä¸ŠåŠ ä¸Šä¸€æ¡ä¼ªé€ çš„è·¯ç”±è§„åˆ™ï¼Œå¯¼è‡´é€šå¾€è¢«å±è”½ç½‘ç«™çš„IPæ•°æ®åŒ…æ— æ³•åˆ°è¾¾ã€‚æ­¤å¤–ï¼ŒGFW å¯¹äºæŸäº›ç½‘ç«™ä¼šé‡‡å–ç‹¬ç«‹IPå°é”æŠ€æœ¯ï¼Œå¦‚æœè¯¥ç½‘ç«™ä½¿ç”¨äº†ç”±è™šæ‹Ÿä¸»æœºæœåŠ¡æä¾›å•†æä¾›çš„å¤šåŸŸåã€å•(åŒ)IPçš„ä¸»æœºæ‰˜ç®¡æœåŠ¡ï¼Œå°±ä¼šé€ æˆæ‰€æœ‰è¯¥æœåŠ¡æä¾›å•†çš„å…¶å®ƒä½¿ç”¨ç›¸åŒIPåœ°å€æœåŠ¡å™¨çš„ç½‘ç«™ç”¨æˆ·é­æ®ƒï¼Œå°±ç®—è¿™äº›ç½‘ç«™çš„å†…å®¹å¯èƒ½å¹¶æ— ä¸å½“ä¹‹å¤„ï¼Œä¹Ÿä¸èƒ½åœ¨ä¸­å›½å¤§é™†æ­£å¸¸è®¿é—®ã€‚</p><h4 id="DNSæ±¡æŸ“ã€åŠ«æŒ"><a href="#DNSæ±¡æŸ“ã€åŠ«æŒ" class="headerlink" title="DNSæ±¡æŸ“ã€åŠ«æŒ"></a>DNSæ±¡æŸ“ã€åŠ«æŒ</h4><p>DNS æ±¡æŸ“æ˜¯æŒ‡ GFW åˆ»æ„åˆ¶é€ å‡ºç‰¹å®šçš„åŸŸåæœåŠ¡å™¨åˆ†ç»„ï¼ŒæŠŠåŸŸåæŒ‡å¾€ä¸æ­£ç¡®çš„IPåœ°å€ã€‚å¯¹äºå«æœ‰å¤šä¸ªIPåœ°å€æˆ–ç»å¸¸å˜æ›´IPåœ°å€é€ƒé¿å°é”çš„åŸŸåï¼ŒGFWé€šå¸¸ä¼šä½¿ç”¨æ­¤æ–¹æ³•è¿›è¡Œå°é”ã€‚2002å¹´è¢«å°é”æœŸé—´ï¼ŒGoogleçš„åŸŸåå°±è¢«åŠ«æŒåˆ°ç™¾åº¦ä¸Šã€‚ <br></p><p>DNSåŠ«æŒå’Œæ±¡æŸ“çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š </p><ul><li>ä¸€ç§æ˜¯é€šè¿‡ç½‘ç»œæœåŠ¡æä¾›å•†(Internet Service Provider)æä¾›çš„ DNS æœåŠ¡å™¨è¿› DNS æ¬ºéª—ï¼Œå½“è®¿é—®æŸä¸ªç½‘ç«™æ—¶ï¼Œéœ€è¦è¦æŠŠåŸŸåè½¬æ¢ä¸ºä¸€ä¸ªIPåœ°å€ï¼ŒDNS æœåŠ¡å™¨è´Ÿè´£å°†åŸŸåè½¬æ¢ä¸ºIPåœ°å€ï¼Œä¸­å›½å¤§é™†çš„ ISP æ¥å—é€šä¿¡ç®¡ç†å±€çš„å±è”½ç½‘ç«™çš„æŒ‡ä»¤ååœ¨ DNS æœåŠ¡å™¨é‡ŒåŠ å…¥æŸäº›ç‰¹å®šåŸŸåçš„è™šå‡è®°å½•ï¼Œå½“ä½¿ç”¨æ­¤ DNS æœåŠ¡å™¨çš„ç½‘ç»œç”¨æˆ·è®¿é—®æ­¤ç‰¹å®šç½‘ç«™æ—¶ï¼ŒDNS æœåŠ¡ä¾¿ç»™å‡ºè™šå‡çš„IPåœ°å€ï¼Œå¯¼è‡´è®¿é—®ç½‘ç«™å¤±è´¥ï¼Œç”šè‡³è¿”å› ISP è¿è¥å•†æä¾›çš„å‡ºé”™é¡µé¢å’Œå¹¿å‘Šé¡µé¢ã€‚ </li><li>å¦ä¸€ç§æ˜¯ GFW åœ¨ DNS æŸ¥è¯¢ä½¿ç”¨çš„ UDP çš„53ç«¯å£ä¸Šæ ¹æ®blacklistè¿›è¡Œè¿‡æ»¤ï¼Œé‡åˆ°é€šå¾€å›½å¤–çš„ä½¿ç”¨UDP 53ç«¯å£è¿›è¡ŒæŸ¥è¯¢çš„ DNS è¯·æ±‚ï¼Œå°±è¿”å›ä¸€ä¸ªè™šå‡çš„IPåœ°å€ã€‚</li></ul><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒIPv4æ—¶ä»£ï¼Œå…¨çƒä¸€å…±æœ‰13ç»„æ ¹åŸŸåæœåŠ¡å™¨ï¼Œä¸­å›½å¤§é™†æ—©æœŸæœ‰Fã€Iä¸¤ä¸ªæ ¹åŸŸ DNS é•œåƒï¼Œä½†å› ä¸ºå¤šæ¬¡ DNS æ±¡æŸ“å›½å¤–ç½‘ç»œï¼Œè¢«æ–­å¼€ä¸å›½é™…äº’è”ç½‘çš„è¿æ¥ï¼Œç›¸å…³äº‹ä»¶æŸ¥çœ‹ç»´åŸºç™¾ç§‘ï¼š<a href="https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%93%E5%AD%98%E6%B1%A1%E6%9F%93#æ±¡æŸ“æ”»å‡»å¤§äº‹è®°" target="_blank" rel="noopener">ä¸­å›½é˜²ç«é•¿åŸ-æ±¡æŸ“æ”»å‡»å¤§äº‹è®°</a>ã€‚ </p><p><strong>é™¤äº†ä»¥ä¸Šå‡ ç§å°é”æ–¹æ³•ï¼ŒGFWè¿˜ä¼šé‡‡ç”¨SSLè¿æ¥é˜»æ–­ã€ç‰¹å®šç«¯å£å°é”ç­‰å·¥ä½œæ–¹å¼ã€‚</strong></p><h2 id="ç¿»è¶Šè®°"><a href="#ç¿»è¶Šè®°" class="headerlink" title="ç¿»è¶Šè®°"></a>ç¿»è¶Šè®°</h2><h3 id="ç¿»"><a href="#ç¿»" class="headerlink" title="ç¿»"></a>ç¿»</h3><h4 id="ä¿®æ”¹Hostsæ–‡ä»¶"><a href="#ä¿®æ”¹Hostsæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹Hostsæ–‡ä»¶"></a>ä¿®æ”¹Hostsæ–‡ä»¶</h4><p>è¶³å¤Ÿç®€å•çš„æ–¹å¼ï¼Œä»¥è§£å†³ GFW çš„ DNS æ±¡æŸ“å’ŒåŠ«æŒçš„é—®é¢˜ã€‚Hosts æ–‡ä»¶æ˜¯ä¸€ä¸ªå‚¨å­˜è®¡ç®—æœºç½‘ç»œä¸­å„èŠ‚ç‚¹ä¿¡æ¯çš„æ–‡ä»¶ï¼Œè´Ÿè´£å°†ä¸»æœºåæ˜ å°„åˆ°ç›¸åº”çš„IPåœ°å€ï¼Œé€šå¸¸ç”¨äºè¡¥å……æˆ–å–ä»£ç½‘ç»œä¸­DNSçš„åŠŸèƒ½ã€‚å’ŒDNSä¸åŒçš„æ˜¯ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥å¯¹ Hosts æ–‡ä»¶è¿›è¡Œæ§åˆ¶ã€‚</p><p>Hosts æ–‡ä»¶çš„åŸæœ¬ç›®çš„æ˜¯æé«˜è§£æçš„æ•ˆç‡ã€‚åœ¨è¿›è¡Œ DNS è¯·æ±‚ä»¥å‰ï¼Œç³»ç»Ÿå…ˆæ£€æŸ¥è‡ªå·±çš„ Hosts æ–‡ä»¶ä¸­æ˜¯å¦æœ‰åœ°å€æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰åˆ™è°ƒç”¨è¯¥IPåœ°å€æ˜ å°„ï¼Œå¦‚æœæ²¡æœ‰å†å‘å·²çŸ¥çš„ DNS æœåŠ¡å™¨æå‡ºåŸŸåè§£æã€‚ç”±äº Hosts çš„è¯·æ±‚çº§åˆ«æ¯”DNSé«˜ï¼Œå½“ Hosts æ–‡ä»¶é‡Œé¢æœ‰å¯¹åº”çš„IPæ—¶ï¼Œå®¢æˆ·ç«¯å°±ä¼šç›´æ¥è®¿é—®é‚£ä¸ªIPï¼Œè€Œä¸å¿…é€šè¿‡ DNSã€‚å„æ“ä½œç³»ç»Ÿçš„ Hosts æ–‡ä»¶å„æœ‰ä¸åŒï¼Œç½‘ç»œä¸Šæœ‰å¾ˆå¤šç›¸å…³èµ„æ–™ï¼Œåœ¨æ­¤ä¸èµ˜è¿°ã€‚</p><p>æ‰€ä»¥ï¼Œå°† Googleã€Twitterã€Facebook ä¹‹ç±»çš„IPæ”¾å…¥ Hosts æ–‡ä»¶ï¼Œå°±å¯ä»¥ä¸å— GFW çš„ DNS  æ±¡æŸ“å¹²æ‰°ã€‚ä½†ç”±äº GFW çš„IPå°é”ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•å¾ˆéš¾æœ‰æ•ˆã€‚</p><h4 id="SSH-Tunnel"><a href="#SSH-Tunnel" class="headerlink" title="SSH Tunnel"></a>SSH Tunnel</h4><p>SSHï¼ˆSecure Shellï¼‰æ˜¯ä¸€ä¸ªæä¾›æ•°æ®é€šä¿¡å®‰å…¨ã€è¿œç¨‹ç™»å½•ã€è¿œç¨‹æŒ‡ä»¤æ‰§è¡Œç­‰åŠŸèƒ½çš„å®‰å…¨ç½‘ç»œåè®®ã€‚æ­å»ºä¸€ä¸ª SSH éš§é“ç¿»å¢™ï¼Œåªéœ€è¦æœ‰ä¸€å°æ”¯æŒ SSH çš„å¢™å¤–æœåŠ¡å™¨ï¼Œä¸”è¯¥æœåŠ¡å™¨èƒ½ SSH è¿æ¥å³å¯ã€‚<br></p><p><img src="/ç¿»è¶ŠGFWè®°/SSHè¿æ¥æ–¹å¼.png" alt="SSHè¿æ¥æ–¹å¼"></p><ol><li>é¦–å…ˆç”¨æˆ·å’Œå¢ƒå¤–æœåŠ¡å™¨åŸºäº SSH å»ºç«‹èµ·ä¸€æ¡åŠ å¯†çš„é€šé“ (1)</li><li>ç”¨æˆ·é€šè¿‡å»ºç«‹èµ·çš„éš§é“è¿›è¡Œä»£ç†ï¼Œé€šè¿‡ SSH  Server å‘çœŸå®çš„æœåŠ¡å‘èµ·è¯·æ±‚ (2-3)</li><li>æœåŠ¡é€šè¿‡ SSH Serverï¼Œå†é€šè¿‡åˆ›å»ºå¥½çš„éš§é“è¿”å›ç»™ç”¨æˆ· (4-5)</li></ol><p>ç”±äº SSH æœ¬èº«åŸºäº RSA åŠ å¯†æŠ€æœ¯ï¼Œæ‰€ä»¥ GFW æ— æ³•ä»æ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­çš„åŠ å¯†æ•°æ®å†…å®¹è¿›è¡Œå…³é”®è¯åˆ†æï¼Œé¿å…äº†è¢«é‡ç½®é“¾æ¥çš„é—®é¢˜ï¼Œä½†ç”±äºåˆ›å»ºéš§é“å’Œæ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼ŒSSH æœ¬èº«çš„ç‰¹å¾å¾ˆæ˜æ˜¾ï¼Œæ‰€ä»¥ GFW ä¸€åº¦é€šè¿‡åˆ†æè¿æ¥çš„ç‰¹å¾è¿›è¡Œå¹²æ‰°ï¼Œå¯¼è‡´ SSH å­˜åœ¨è¢«å®šå‘è¿›è¡Œå¹²æ‰°çš„é—®é¢˜ã€‚</p><h4 id="VPN"><a href="#VPN" class="headerlink" title="VPN"></a>VPN</h4><p>å¯¹äºä¼ä¸šæ¥è¯´ï¼Œä¸ºäº†å…±äº«èµ„æºã€ååŒå·¥ä½œï¼Œéœ€è¦è¿æ¥å„åœ°çš„åˆ†æ”¯æœºæ„ï¼Œä¼ ç»Ÿçš„ä¸“çº¿è”ç½‘æ–¹å¼ä»·æ ¼æ˜‚è´µï¼Œä¸€èˆ¬ä¸­å°ä¼ä¸šéš¾ä»¥è´Ÿæ‹…ã€‚è¿™æ—¶ä½æˆæœ¬çš„VPNæŠ€æœ¯å­•è‚²è€Œç”Ÿã€‚VPNï¼ˆVirtual Private Networkï¼‰å³è™šæ‹Ÿä¸“ç”¨ç½‘ç»œï¼Œåˆ©ç”¨å»‰ä»·æ¥å…¥çš„å…¬å…±ç½‘ç»œï¼ˆä¸»è¦ä½¿ç”¨Inter-netï¼‰æ¥ä¼ è¾“ç§æœ‰æ•°æ®ï¼Œå…·æœ‰æˆæœ¬ä¼˜åŠ¿ï¼Œå› æ­¤è¢«å¾ˆå¤šä¼ä¸šå’Œç”µä¿¡è¿è¥å•†é‡‡ç”¨ã€‚</p><p>VPN æ¯”Shadowsocksæ›´åŠ åº•å±‚ï¼Œå®ƒé€šè¿‡æ“ä½œç³»ç»Ÿçš„æ¥å£ç›´æ¥è™šæ‹Ÿå‡ºä¸€å¼ ç½‘å¡ï¼Œåç»­æ•´ä¸ªæ“ä½œç³»ç»Ÿçš„ç½‘ç»œé€šè®¯éƒ½å°†é€šè¿‡è¿™å¼ è™šæ‹Ÿçš„ç½‘å¡è¿›è¡Œæ”¶å‘â€”â€”ç½‘ç»œä»£ç†çš„å®ç°æ€è·¯å¤§éƒ½å¦‚æ­¤ã€‚</p><p>VPN çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>VPN çš„è®¾ç½®æ˜¯å…¨å±€çš„ï¼Œå³æ‰€æœ‰è”ç½‘ç¨‹åºéƒ½è‡ªåŠ¨ä½¿ç”¨VPNï¼›ä½†SSHéš§é“éœ€è¦ç¨‹åºè®¾å®šï¼Œæ‰ä¼šä½¿ç”¨éš§é“è”ç½‘ã€‚</li><li>å•†ç”¨çš„VPNä¸€èˆ¬éƒ½æ˜¯ä»˜è´¹çš„ï¼Œè€Œè‡ªä¸»æ­å»ºVPN çš„éš¾åº¦è¦å¤§äºSSHéš§é“ï¼Œå› ä¸ºSSHéš§é“åªè¦ä¸€å°å¯ä»¥SSHçš„æœåŠ¡å™¨å³å¯ï¼Œä¸éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé…ç½®ä»»ä½•ä¸œè¥¿ã€‚</li><li>VPN åœ¨IPå±‚å·¥ä½œï¼Œè€ŒShadowsocksåœ¨ TCP/UDP å±‚å·¥ä½œã€‚</li></ul><h4 id="Shadowsocks"><a href="#Shadowsocks" class="headerlink" title="Shadowsocks"></a>Shadowsocks</h4><p>VPNä¹‹ç±»çš„æŠ€æœ¯ï¼Œæœ‰ä¸€ä¸ªè‡´å‘½çš„ç¼ºé™·ï¼šå®ƒä»¬è™½ç„¶é€šè¿‡äº†æ— æ³•ç ´è§£çš„RSAåŠ å¯†ç®—æ³•æ¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä½†æ˜¯åœ¨äº¤æ¢å¯†é’¥ã€å»ºç«‹èµ·éš§é“å‰ä»åœ¨è¿›è¡Œæ˜æ–‡ä¼ è¾“ï¼ŒGFWæ­£æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œåœ¨äº¤æ¢ç§˜é’¥çš„è¿‡ç¨‹ä¸­æš´åŠ›ç ´è§£ï¼Œè¿™æ„å‘³ç€æ¥ä¸‹æ¥çš„åŠ å¯†æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚Shadowsocksæ‰€åšçš„ä¸€ç‚¹ï¼Œå°±æ˜¯æå‰è§„å®šå¥½åŠ å¯†æ–¹å¼ï¼Œè§£å†³ GFW é€šè¿‡åˆ†ææµé‡ç‰¹å¾è¿›è¡Œå¹²æ‰°çš„é—®é¢˜ã€‚</p><p>æŠ€æœ¯åŸç†ä¸Šï¼ŒShadowsocks æ˜¯å°†åŸæ¥ SSH åˆ›å»ºçš„ Socks5 åè®®æ‹†å¼€æˆ Server ç«¯å’Œ Client ç«¯ï¼Œå…¶å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹</p><p><img src="/ç¿»è¶ŠGFWè®°/SSè¿æ¥æ–¹å¼.png" alt="SSè¿æ¥æ–¹å¼"></p><ul><li>1)ã€6) å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚åŸºäº Socks5 åè®®è·Ÿ SS Local ç«¯è¿›è¡Œé€šè®¯ï¼Œç”±äºè¿™ä¸ª SS Local ä¸€èˆ¬æ˜¯æœ¬æœºæˆ–è·¯ç”±å™¨æˆ–å±€åŸŸç½‘çš„å…¶ä»–æœºå™¨ï¼Œä¸ç»è¿‡ GFWï¼Œè§£å†³äº†è¢« GFW é€šè¿‡ç‰¹å¾åˆ†æè¿›è¡Œå¹²æ‰°çš„é—®é¢˜</li><li>2)ã€5) SS Local å’Œ SS Server ä¸¤ç«¯é€šè¿‡å¤šç§å¯é€‰çš„åŠ å¯†æ–¹æ³•è¿›è¡Œé€šè®¯ï¼Œç»è¿‡ GFW çš„æ—¶å€™æ˜¯å¸¸è§„çš„TCPåŒ…ï¼Œæ²¡æœ‰æ˜æ˜¾çš„ç‰¹å¾ç è€Œä¸” GFW ä¹Ÿæ— æ³•å¯¹é€šè®¯æ•°æ®è¿›è¡Œè§£å¯†</li><li>3)ã€4) SS Server å°†æ”¶åˆ°çš„åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†ï¼Œè¿˜åŸåŸæ¥çš„è¯·æ±‚ï¼Œå†å‘é€åˆ°ç”¨æˆ·éœ€è¦è®¿é—®çš„æœåŠ¡ï¼Œè·å–å“åº”åŸè·¯è¿”å›ã€‚</li></ul><p>ç›¸æ¯”ä¼ ç»Ÿçš„ VPN (IKE, IPSec, PPTPâ€¦)ï¼ŒShadowsocks åè®®å…·æœ‰æ›´å¥½çš„çµæ´»æ€§å’Œéšè”½æ€§ï¼Œä¸”æ­å»ºç›¸å¯¹ç®€å•ï¼Œå¯ä»¥æ‹¥æœ‰ç›¸å¯¹ä¼ ç»ŸVPNæ›´å¿«çš„é€Ÿåº¦å’Œæ›´é«˜çš„ç¨³å®šæ€§ï¼›è€Œå¯¹æ¯” V2Ray è¿™ç§ç§‘å­¦ä¸Šç½‘çš„é›†åˆä½“ï¼ŒShadowsocksåœ¨æœåŠ¡ç«¯æ›´åŠ è½»é‡ï¼Œå•ä¸€åè®®å®Œå–„ç¨‹åº¦æ›´é«˜ï¼›åŒæ—¶ï¼ŒShadowsocksåœ¨ç§»åŠ¨ç«¯æœ‰æ›´ä¸°å¯Œçš„å®¢æˆ·ç«¯é€‰æ‹©ï¼Œå…¼å®¹æ€§å’Œçµæ´»æ€§æ›´ä¼˜ã€‚</p><h5 id="Shadowsocks-R"><a href="#Shadowsocks-R" class="headerlink" title="Shadowsocks-R"></a>Shadowsocks-R</h5><p>è™½è¯´Shadowsocksâ€œæŠ¹é™¤äº†æµé‡ç‰¹å¾â€ï¼Œä½†ä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œå…¶å®å®ƒçš„ç‰¹å¾ä¹Ÿå¾ˆæ˜æ˜¾ï¼šTCP/UDPä¸Šå±‚çš„åŒ…å…¨æ˜¯å¯†æ–‡ï¼Œå‡ ä¹å’ŒVPNæ²¡æœ‰åŒºåˆ«ã€‚ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œå‡ºç°äº†Shadowsocks-Rï¼Œå®ƒçš„å…¶ä¸­ä¸€ä¸ªç‰¹æ€§ï¼Œæ˜¯åœ¨åŸ Shadowsocks åè®®çš„æ•°æ®æµå‰é¢åŠ ä¸ŠHTTPå¤´ï¼Œè®©GFWè¯¯è®¤ä¸ºæ˜¯HTTPåè®®ï¼Œä»è€Œå¯¹æ•°æ®æµåº”ç”¨é’ˆå¯¹HTTPçš„è§„åˆ™ã€‚</p><p>ä½œä¸ºSSçš„ä¸€ä¸ªå‘å±•åˆ†æ”¯ï¼Œç”±äºSSRçš„ä½œè€…ä¸€å¼€å§‹æœªå°†å…¶å¼€æºï¼ˆè¿åäº† GPL åè®®ï¼‰ï¼Œæ‰€ä»¥å®é™…ä¸Šä¸¤è€…æ—©æœŸæœ‰ä¸å¯è°ƒå’Œçš„åˆ†æ­§ã€‚SSRæ‹¥æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œæ”¯æŒæ›´å¤šçš„åŠ å¯†æ–¹å¼ï¼Œæ­¤å¤–SSRè¿˜å¯ä»¥åˆ©ç”¨è¿è¥å•†çš„æ¼æ´ï¼Œå¼€å¯å…æµæœåŠ¡ï¼Œä¸è¿‡è¿™æ˜¯å¦ä¸€ä¸ªé—®é¢˜äº†ã€‚</p><h5 id="V2Ray"><a href="#V2Ray" class="headerlink" title="V2Ray"></a>V2Ray</h5><p>V2Ray çš„å®ç°åŸç†è·ŸShadowsocksä¸€è„‰ç›¸æ‰¿ï¼Œå…¶ç‰¹ç‚¹åœ¨äºå¼•å…¥æ–°çš„é€šä¿¡åè®®ï¼Œæ”¹æ­£ Shadowsockså·²æœ‰çš„ç¼ºç‚¹ï¼Œä½¿æµé‡ç‰¹å¾æ›´éš¾è¢« GFW æ£€æµ‹åˆ°ï¼›åŒæ—¶ä½¿ç”¨ UDP ä½œä¸ºä¸‹å±‚åè®®ï¼Œé¿å… TCP å¸¦æ¥çš„çª—å£å’Œ RTO(Retry Timeout)ç­‰å¯¼è‡´ç½‘é€Ÿå˜æ…¢çš„é—®é¢˜ã€‚</p><h3 id="è®°"><a href="#è®°" class="headerlink" title="è®°"></a>è®°</h3><ul><li>1998å¹´ï¼Œå…¬å®‰éƒ¨å¼€å±•â€é‡‘ç›¾å·¥ç¨‹â€å»ºè®¾ã€‚æ¬¡å¹´ï¼Œæ–¹æ»¨å…´è°ƒä»»å›½å®¶è®¡ç®—æœºç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç®¡ç†ä¸­å¿ƒå‰¯æ€»å·¥ç¨‹å¸ˆã€‚</li><li>2002å¹´ï¼ŒGoogleç»å†å¤šæ¬¡å°é”ä¸è§£å°ï¼Œä¸»è¦æ‰‹æ®µä¸ºDNSåŠ«æŒã€TCPä¼šè¯é˜»æ–­ç­‰ã€‚</li><li>2004å¹´ï¼Œç»´åŸºç™¾ç§‘é­é‡ç½‘ç»œå°é”ï¼Œè‡³ä»Šæœªè§£å°ã€‚</li><li>2008å¹´ï¼ŒåŒ—äº¬å¥¥è¿ä¼šæœŸé—´ï¼Œä¸­å›½æ”¿åºœçŸ­æš‚æ”¾å®½GFWçš„å°é”èŒƒå›´ã€‚</li><li>2010å¹´ï¼ŒGoogleå› å†…å®¹å®¡æŸ¥é—®é¢˜ä¸ä¸­å›½æ”¿åºœäº¤æ¶‰æ— æ•ˆåï¼Œé€€å‡ºä¸­å›½ã€‚</li><li>2013å¹´ï¼ŒGFWåˆ©ç”¨åŸŸåæ±¡æŸ“å’Œå…³é”®è¯è¿‡æ»¤ç­‰æ‰‹æ®µå±è”½GitHubï¼Œå‡ å¤©åè¢«è§£å°ã€‚</li><li>2015å¹´ï¼ŒShadowsocksä½œè€… @clowwindyé­é‡å…¬å®‰æœºå…³è°ƒæŸ¥ï¼Œéšååˆ é™¤ä»£ç ï¼Œä¸å†å‚ä¸å¼€å‘ã€‚</li><li>2017å¹´ï¼ŒShadowsocks-Rä½œè€… @BreakWa11è¢«äººè‚‰å’Œäººèº«å¨èƒï¼Œéšååˆ é™¤æ‰€æœ‰é¡¹ç›®ä»£ç ã€‚</li></ul><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>ä»äºŒåå¹´å‰â€œé‡‘ç›¾å·¥ç¨‹â€è‡³ä»Šï¼Œä¸­å›½çš„äº’è”ç½‘ç®¡åˆ¶æœªæ›¾æ¾åŠ¨ï¼Œåœ¨å¯é¢„è§çš„æœªæ¥ï¼Œåº”è¯¥ä¹Ÿä¸ä¼šæœ‰æ‰€æ”¾ç¼“ã€‚GFWç»è¿‡åå‡ å¹´çš„å‘å±•ï¼Œå·²ç»è¶³å¤Ÿæˆç†Ÿï¼ŒåŒæ—¶å¯¹äºç¿»å¢™è¿™ä¸€è¡Œä¸ºï¼Œæ‰§æ”¿å…šçš„æ²»ç†ä¾§é‡ç‚¹ä¹Ÿæœ‰ä»æŠ€æœ¯æ‰‹æ®µè½¬å‘è¡Œæ”¿æ‰‹æ®µçš„è¶‹åŠ¿ï¼Œæ¯å¹´ï¼Œä¸ªäººå› ä¸ºç¿»å¢™æˆ–è€…å‡ºå”®ç¿»å¢™æœåŠ¡è€Œè¢«é€®æ•çš„æ—¶é—´å±¡å±¡è§è¯¸æŠ¥ç«¯ã€‚</p><p>ç¿»å¢™æŠ€æœ¯å’ŒGFWæ¯å¤©éƒ½åœ¨ä¸Šæ¼”é“é«˜ä¸€å°ºé­”é«˜ä¸€ä¸ˆçš„æˆç ï¼Œä¸¤è€…çš„æ–—äº‰æ›´è¿›ä¸€æ­¥ï¼Œå¯èƒ½æ˜¯äººå·¥æ™ºèƒ½åœ¨GFWä¸Šçš„æ·±åº¦éƒ¨ç½²ï¼Œæˆ–è€…IPv6çš„å…¨é¢æ™®åŠã€‚</p><p>æœ¬æ–‡çš„ç»å¤§å¤šæ•°èµ„æ–™å’Œå›¾ç‰‡å‡æ¥è‡ªäº’è”ç½‘ï¼Œé¿å…ç´¯èµ˜ï¼Œä¸å†æ·»åŠ å¼•ç”¨è¯´æ˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;GFWæ˜¯ä¸­å›½äº’è”ç½‘ä¸Šç‹¬ç‰¹è€Œä¸å¯å¿½è§†çš„å­˜åœ¨ï¼Œå¾ˆå¤šäººåœ¨ç”Ÿæ´»ä¸­éƒ½ä¸»åŠ¨åœ°æ­å»ºç¿»å¢™å·¥å…·æˆ–è€…ä½¿ç”¨ç¿»å¢™æœåŠ¡ï¼Œä»¥æ­¤è®¿é—®â€œä¸å­˜åœ¨çš„ç½‘ç«™â€ã€‚æœ¬æ–‡å°†è®°å½•&lt;code&gt;GFW&lt;/code&gt;æ‰€ä¸ºä½•ç‰©ï¼Œä»¥åŠ&lt;code&gt;ç¿»&lt;/code&gt;çš„åŸç†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="äº’è”ç½‘" scheme="http://yoursite.com/categories/%E4%BA%92%E8%81%94%E7%BD%91/"/>
    
    
      <category term="ç¿»å¢™" scheme="http://yoursite.com/tags/%E7%BF%BB%E5%A2%99/"/>
    
      <category term="äº’è”ç½‘" scheme="http://yoursite.com/tags/%E4%BA%92%E8%81%94%E7%BD%91/"/>
    
  </entry>
  
</feed>
